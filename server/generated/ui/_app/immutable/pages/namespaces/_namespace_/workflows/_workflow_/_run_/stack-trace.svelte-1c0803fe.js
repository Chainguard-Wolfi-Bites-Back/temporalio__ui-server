import{S as Q,i as V,s as O,l as S,m as E,n as R,h as $,b as k,f as g,t as h,N as P,w as b,x as v,y as T,B as y,X as W,e as q,_ as X,r as d,u as w,M as _,E as U,a as D,c as I,p as N,v as j}from"../../../../../../chunks/index-9d69cec5.js";import{p as A}from"../../../../../../chunks/stores-d806cb81.js";import{w as F}from"../../../../../../chunks/workflow-run-f8d190b9.js";import{b as B}from"../../../../../../chunks/query-service-4136cff9.js";import{C as z}from"../../../../../../chunks/code-block-5fc689bb.js";import{B as G}from"../../../../../../chunks/button-944065b3.js";import{E as M}from"../../../../../../chunks/empty-state-ec9374e8.js";import{L as H}from"../../../../../../chunks/loading-95abebb2.js";import{L as J}from"../../../../../../chunks/link-c8fde04f.js";import{a as K}from"../../../../../../chunks/auth-user-db7289b0.js";import{P as Y}from"../../../../../../chunks/page-title-c238ffaa.js";import"../../../../../../chunks/index-ad6f072e.js";import"../../../../../../chunks/with-loading-f07bedaf.js";import"../../../../../../chunks/workflow-service-d5b3fd40.js";import"../../../../../../chunks/settings-34c5dae2.js";import"../../../../../../chunks/simplify-attributes-db1e2585.js";import"../../../../../../chunks/format-date-eb94f038.js";import"../../../../../../chunks/is-44021919.js";import"../../../../../../chunks/route-for-api-d16befb1.js";import"../../../../../../chunks/route-for-ad343b08.js";import"../../../../../../chunks/notifications-677e5039.js";import"../../../../../../chunks/is-network-error-5f9e2367.js";import"../../../../../../chunks/persist-store-7662fc0b.js";import"../../../../../../chunks/parse-with-big-int-561ccb8b.js";import"../../../../../../chunks/pollers-service-af03a4b1.js";import"../../../../../../chunks/is-http-4ef54e59.js";import"../../../../../../chunks/get-encoder-endpoint-67862a53.js";import"../../../../../../chunks/data-converter-config-eb31d046.js";import"../../../../../../chunks/atob-9a7280e8.js";import"../../../../../../chunks/icon-c89f2c4c.js";import"../../../../../../chunks/copy-to-clipboard-b3dfa6fa.js";import"../../../../../../chunks/badge-6bbe0435.js";function Z(c){let e,r;return e=new M({props:{title:"No Stack Traces Found",dataCy:"query-stack-trace-empty",$$slots:{default:[re]},$$scope:{ctx:c}}}),{c(){b(e.$$.fragment)},l(t){v(e.$$.fragment,t)},m(t,n){T(e,t,n),r=!0},p(t,n){const s={};n&4096&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){r||(g(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){y(e,t)}}}function x(c){let e,r,t,n={ctx:c,current:null,token:null,hasCatch:!0,pending:le,then:oe,catch:ne,value:10,error:11,blocks:[,,,]};return W(r=c[1],n),{c(){e=q(),n.block.c()},l(s){e=q(),n.block.l(s)},m(s,a){k(s,e,a),n.block.m(s,n.anchor=a),n.mount=()=>e.parentNode,n.anchor=e,t=!0},p(s,a){c=s,n.ctx=c,a&2&&r!==(r=c[1])&&W(r,n)||X(n,c,a)},i(s){t||(g(n.block),t=!0)},o(s){for(let a=0;a<3;a+=1){const o=n.blocks[a];h(o)}t=!1},d(s){s&&$(e),n.block.d(s),n.token=null,n=null}}}function ee(c){var i;let e,r,t,n,s=((i=c[2])==null?void 0:i.taskQueue)+"",a,o,l;return t=new J({props:{href:"https://docs.temporal.io/concepts/what-is-a-query/#stack-trace-query",$$slots:{default:[te]},$$scope:{ctx:c}}}),{c(){e=S("p"),r=d("To enable "),b(t.$$.fragment),n=d(", run a Worker on the "),a=d(s),o=d(" Task Queue.")},l(f){e=E(f,"P",{});var u=R(e);r=w(u,"To enable "),v(t.$$.fragment,u),n=w(u,", run a Worker on the "),a=w(u,s),o=w(u," Task Queue."),u.forEach($)},m(f,u){k(f,e,u),_(e,r),T(t,e,null),_(e,n),_(e,a),_(e,o),l=!0},p(f,u){const m={};u&4096&&(m.$$scope={dirty:u,ctx:f}),t.$set(m)},i(f){l||(g(t.$$.fragment,f),l=!0)},o(f){h(t.$$.fragment,f),l=!1},d(f){f&&$(e),y(t)}}}function te(c){let e;return{c(){e=d("stack traces")},l(r){e=w(r,"stack traces")},m(r,t){k(r,e,t)},d(r){r&&$(e)}}}function re(c){var n,s;let e,r,t=c[2].isRunning&&((s=(n=c[3])==null?void 0:n.pollers)==null?void 0:s.length)===0&&ee(c);return{c(){t&&t.c(),e=q()},l(a){t&&t.l(a),e=q()},m(a,o){t&&t.m(a,o),k(a,e,o),r=!0},p(a,o){var l,i;a[2].isRunning&&((i=(l=a[3])==null?void 0:l.pollers)==null?void 0:i.length)===0&&t.p(a,o)},i(a){r||(g(t),r=!0)},o(a){h(t),r=!1},d(a){t&&t.d(a),a&&$(e)}}}function ne(c){let e,r;return e=new M({props:{title:"An Error Occured",content:"Please make sure you have at least one worker running."}}),{c(){b(e.$$.fragment)},l(t){v(e.$$.fragment,t)},m(t,n){T(e,t,n),r=!0},p:U,i(t){r||(g(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){y(e,t)}}}function oe(c){let e,r,t,n,s,a=c[0].toLocaleTimeString()+"",o,l,i,f,u;return r=new G({props:{icon:"retry",loading:ce,$$slots:{default:[ae]},$$scope:{ctx:c}}}),r.$on("click",c[4]),f=new z({props:{content:c[10],language:"text",dataCy:"query-stack-trace"}}),{c(){e=S("div"),b(r.$$.fragment),t=D(),n=S("p"),s=d("Stack Trace at "),o=d(a),l=D(),i=S("div"),b(f.$$.fragment),this.h()},l(m){e=E(m,"DIV",{class:!0});var p=R(e);v(r.$$.fragment,p),t=I(p),n=E(p,"P",{});var C=R(n);s=w(C,"Stack Trace at "),o=w(C,a),C.forEach($),p.forEach($),l=I(m),i=E(m,"DIV",{class:!0});var L=R(i);v(f.$$.fragment,L),L.forEach($),this.h()},h(){N(e,"class","flex items-center gap-4"),N(i,"class","flex items-start h-full")},m(m,p){k(m,e,p),T(r,e,null),_(e,t),_(e,n),_(n,s),_(n,o),k(m,l,p),k(m,i,p),T(f,i,null),u=!0},p(m,p){const C={};p&4096&&(C.$$scope={dirty:p,ctx:m}),r.$set(C),(!u||p&1)&&a!==(a=m[0].toLocaleTimeString()+"")&&j(o,a);const L={};p&2&&(L.content=m[10]),f.$set(L)},i(m){u||(g(r.$$.fragment,m),g(f.$$.fragment,m),u=!0)},o(m){h(r.$$.fragment,m),h(f.$$.fragment,m),u=!1},d(m){m&&$(e),y(r),m&&$(l),m&&$(i),y(f)}}}function ae(c){let e;return{c(){e=d("Refresh")},l(r){e=w(r,"Refresh")},m(r,t){k(r,e,t)},d(r){r&&$(e)}}}function le(c){let e,r,t,n,s,a;return r=new H({}),{c(){e=S("div"),b(r.$$.fragment),t=D(),n=S("p"),s=d("(This will fail if you have no workers running.)"),this.h()},l(o){e=E(o,"DIV",{class:!0});var l=R(e);v(r.$$.fragment,l),t=I(l),n=E(l,"P",{});var i=R(n);s=w(i,"(This will fail if you have no workers running.)"),i.forEach($),l.forEach($),this.h()},h(){N(e,"class","text-center")},m(o,l){k(o,e,l),T(r,e,null),_(e,t),_(e,n),_(n,s),a=!0},p:U,i(o){a||(g(r.$$.fragment,o),a=!0)},o(o){h(r.$$.fragment,o),a=!1},d(o){o&&$(e),y(r)}}}function se(c){let e,r,t,n;const s=[x,Z],a=[];function o(l,i){var f,u;return l[2].isRunning&&((u=(f=l[3])==null?void 0:f.pollers)==null?void 0:u.length)>0?0:1}return r=o(c),t=a[r]=s[r](c),{c(){e=S("section"),t.c()},l(l){e=E(l,"SECTION",{});var i=R(e);t.l(i),i.forEach($)},m(l,i){k(l,e,i),a[r].m(e,null),n=!0},p(l,[i]){t.p(l,i)},i(l){n||(g(t),n=!0)},o(l){h(t),n=!1},d(l){l&&$(e),a[r].d()}}}let ce=!1;function ie(c,e,r){let t,n,s;P(c,K,p=>r(5,t=p)),P(c,A,p=>r(6,n=p)),P(c,F,p=>r(7,s=p));const{namespace:a}=n.params,{workflow:o,workers:l}=s;let i=new Date;const f=()=>B({workflow:o,namespace:a},n.stuff.settings,t==null?void 0:t.accessToken);let u;const m=()=>{r(1,u=B({workflow:o,namespace:a},n.stuff.settings,t==null?void 0:t.accessToken)),u.then(()=>{r(0,i=new Date)})};return o.isRunning&&r(1,u=f()),[i,u,o,l,m]}class fe extends Q{constructor(e){super(),V(this,e,ie,se,O,{})}}function ue(c){var s,a;let e,r,t,n;return e=new Y({props:{title:`Stack Trace | ${(a=(s=c[0])==null?void 0:s.workflow)==null?void 0:a.id}`,url:c[1].url.href}}),t=new fe({}),{c(){b(e.$$.fragment),r=D(),b(t.$$.fragment)},l(o){v(e.$$.fragment,o),r=I(o),v(t.$$.fragment,o)},m(o,l){T(e,o,l),k(o,r,l),T(t,o,l),n=!0},p(o,[l]){var f,u;const i={};l&1&&(i.title=`Stack Trace | ${(u=(f=o[0])==null?void 0:f.workflow)==null?void 0:u.id}`),l&2&&(i.url=o[1].url.href),e.$set(i)},i(o){n||(g(e.$$.fragment,o),g(t.$$.fragment,o),n=!0)},o(o){h(e.$$.fragment,o),h(t.$$.fragment,o),n=!1},d(o){y(e,o),o&&$(r),y(t,o)}}}function me(c,e,r){let t,n;return P(c,F,s=>r(0,t=s)),P(c,A,s=>r(1,n=s)),[t,n]}class je extends Q{constructor(e){super(),V(this,e,me,ue,O,{})}}export{je as default};
