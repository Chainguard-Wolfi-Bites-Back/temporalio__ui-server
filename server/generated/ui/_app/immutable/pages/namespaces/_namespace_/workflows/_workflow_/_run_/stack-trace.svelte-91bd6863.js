import{S as V,i as O,s as U,w,a as P,l as S,x as v,c as q,m as E,n as R,h as $,y as T,b as k,f as g,t as h,B as y,N as I,X as B,e as D,_ as F,r as d,u as b,M as _,E as W,p as N,v as M}from"../../../../../../chunks/index-8e660855.js";import{p as X}from"../../../../../../chunks/stores-f70708fe.js";import{w as j}from"../../../../../../chunks/workflow-run-1a8fb321.js";import{b as Q}from"../../../../../../chunks/query-service-3db80775.js";import{C as z}from"../../../../../../chunks/code-block-6b487a97.js";import{B as G}from"../../../../../../chunks/button-d5c6a7e6.js";import{E as A}from"../../../../../../chunks/empty-state-e72270b6.js";import{P as H}from"../../../../../../chunks/page-title-20dc0015.js";import{L as J}from"../../../../../../chunks/loading-ab7d5c92.js";import{L as K}from"../../../../../../chunks/link-6327b112.js";import{a as Y}from"../../../../../../chunks/auth-user-fb6cbd02.js";import"../../../../../../chunks/index-71be9f1c.js";import"../../../../../../chunks/with-loading-f07bedaf.js";import"../../../../../../chunks/workflow-service-4579a182.js";import"../../../../../../chunks/settings-7aeda309.js";import"../../../../../../chunks/simplify-attributes-db1e2585.js";import"../../../../../../chunks/format-date-eb94f038.js";import"../../../../../../chunks/is-44021919.js";import"../../../../../../chunks/route-for-api-6c45543d.js";import"../../../../../../chunks/route-for-82ed5238.js";import"../../../../../../chunks/get-public-path-6c4a8950.js";import"../../../../../../chunks/notifications-faca15d4.js";import"../../../../../../chunks/is-network-error-5f9e2367.js";import"../../../../../../chunks/persist-store-91a918c8.js";import"../../../../../../chunks/parse-with-big-int-561ccb8b.js";import"../../../../../../chunks/pollers-service-02351c7a.js";import"../../../../../../chunks/is-http-74718cda.js";import"../../../../../../chunks/get-encoder-endpoint-103413bf.js";import"../../../../../../chunks/data-converter-config-3f6c038c.js";import"../../../../../../chunks/atob-55d1853d.js";import"../../../../../../chunks/icon-e0d7f667.js";import"../../../../../../chunks/copy-to-clipboard-2ccea087.js";import"../../../../../../chunks/badge-b5d60de0.js";function Z(s){let e,r;return e=new A({props:{title:"No Stack Traces Found",dataCy:"query-stack-trace-empty",$$slots:{default:[re]},$$scope:{ctx:s}}}),{c(){w(e.$$.fragment)},l(t){v(e.$$.fragment,t)},m(t,n){T(e,t,n),r=!0},p(t,n){const l={};n&4096&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){r||(g(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){y(e,t)}}}function x(s){let e,r,t,n={ctx:s,current:null,token:null,hasCatch:!0,pending:le,then:oe,catch:ne,value:10,error:11,blocks:[,,,]};return B(r=s[1],n),{c(){e=D(),n.block.c()},l(l){e=D(),n.block.l(l)},m(l,o){k(l,e,o),n.block.m(l,n.anchor=o),n.mount=()=>e.parentNode,n.anchor=e,t=!0},p(l,o){s=l,n.ctx=s,o&2&&r!==(r=s[1])&&B(r,n)||F(n,s,o)},i(l){t||(g(n.block),t=!0)},o(l){for(let o=0;o<3;o+=1){const i=n.blocks[o];h(i)}t=!1},d(l){l&&$(e),n.block.d(l),n.token=null,n=null}}}function ee(s){var p;let e,r,t,n,l=((p=s[3])==null?void 0:p.taskQueue)+"",o,i,u;return t=new K({props:{href:"https://docs.temporal.io/concepts/what-is-a-query/#stack-trace-query",$$slots:{default:[te]},$$scope:{ctx:s}}}),{c(){e=S("p"),r=d("To enable "),w(t.$$.fragment),n=d(", run a Worker on the "),o=d(l),i=d(" Task Queue.")},l(a){e=E(a,"P",{});var c=R(e);r=b(c,"To enable "),v(t.$$.fragment,c),n=b(c,", run a Worker on the "),o=b(c,l),i=b(c," Task Queue."),c.forEach($)},m(a,c){k(a,e,c),_(e,r),T(t,e,null),_(e,n),_(e,o),_(e,i),u=!0},p(a,c){const f={};c&4096&&(f.$$scope={dirty:c,ctx:a}),t.$set(f)},i(a){u||(g(t.$$.fragment,a),u=!0)},o(a){h(t.$$.fragment,a),u=!1},d(a){a&&$(e),y(t)}}}function te(s){let e;return{c(){e=d("stack traces")},l(r){e=b(r,"stack traces")},m(r,t){k(r,e,t)},d(r){r&&$(e)}}}function re(s){var n,l;let e,r,t=s[3].isRunning&&((l=(n=s[4])==null?void 0:n.pollers)==null?void 0:l.length)===0&&ee(s);return{c(){t&&t.c(),e=D()},l(o){t&&t.l(o),e=D()},m(o,i){t&&t.m(o,i),k(o,e,i),r=!0},p(o,i){var u,p;o[3].isRunning&&((p=(u=o[4])==null?void 0:u.pollers)==null?void 0:p.length)===0&&t.p(o,i)},i(o){r||(g(t),r=!0)},o(o){h(t),r=!1},d(o){t&&t.d(o),o&&$(e)}}}function ne(s){let e,r;return e=new A({props:{title:"An Error Occured",content:"Please make sure you have at least one worker running."}}),{c(){w(e.$$.fragment)},l(t){v(e.$$.fragment,t)},m(t,n){T(e,t,n),r=!0},p:W,i(t){r||(g(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){y(e,t)}}}function oe(s){let e,r,t,n,l,o=s[0].toLocaleTimeString()+"",i,u,p,a,c;return r=new G({props:{icon:"retry",loading:ce,$$slots:{default:[ae]},$$scope:{ctx:s}}}),r.$on("click",s[5]),a=new z({props:{content:s[10],language:"text",dataCy:"query-stack-trace"}}),{c(){e=S("div"),w(r.$$.fragment),t=P(),n=S("p"),l=d("Stack Trace at "),i=d(o),u=P(),p=S("div"),w(a.$$.fragment),this.h()},l(f){e=E(f,"DIV",{class:!0});var m=R(e);v(r.$$.fragment,m),t=q(m),n=E(m,"P",{});var C=R(n);l=b(C,"Stack Trace at "),i=b(C,o),C.forEach($),m.forEach($),u=q(f),p=E(f,"DIV",{class:!0});var L=R(p);v(a.$$.fragment,L),L.forEach($),this.h()},h(){N(e,"class","flex items-center gap-4"),N(p,"class","flex items-start h-full")},m(f,m){k(f,e,m),T(r,e,null),_(e,t),_(e,n),_(n,l),_(n,i),k(f,u,m),k(f,p,m),T(a,p,null),c=!0},p(f,m){const C={};m&4096&&(C.$$scope={dirty:m,ctx:f}),r.$set(C),(!c||m&1)&&o!==(o=f[0].toLocaleTimeString()+"")&&M(i,o);const L={};m&2&&(L.content=f[10]),a.$set(L)},i(f){c||(g(r.$$.fragment,f),g(a.$$.fragment,f),c=!0)},o(f){h(r.$$.fragment,f),h(a.$$.fragment,f),c=!1},d(f){f&&$(e),y(r),f&&$(u),f&&$(p),y(a)}}}function ae(s){let e;return{c(){e=d("Refresh")},l(r){e=b(r,"Refresh")},m(r,t){k(r,e,t)},d(r){r&&$(e)}}}function le(s){let e,r,t,n,l,o;return r=new J({}),{c(){e=S("div"),w(r.$$.fragment),t=P(),n=S("p"),l=d("(This will fail if you have no workers running.)"),this.h()},l(i){e=E(i,"DIV",{class:!0});var u=R(e);v(r.$$.fragment,u),t=q(u),n=E(u,"P",{});var p=R(n);l=b(p,"(This will fail if you have no workers running.)"),p.forEach($),u.forEach($),this.h()},h(){N(e,"class","text-center")},m(i,u){k(i,e,u),T(r,e,null),_(e,t),_(e,n),_(n,l),o=!0},p:W,i(i){o||(g(r.$$.fragment,i),o=!0)},o(i){h(r.$$.fragment,i),o=!1},d(i){i&&$(e),y(r)}}}function se(s){let e,r,t,n,l,o;e=new H({props:{title:`Stack Trace | ${s[3].id}`,url:s[2].url.href}});const i=[x,Z],u=[];function p(a,c){var f,m;return a[3].isRunning&&((m=(f=a[4])==null?void 0:f.pollers)==null?void 0:m.length)>0?0:1}return n=p(s),l=u[n]=i[n](s),{c(){w(e.$$.fragment),r=P(),t=S("section"),l.c()},l(a){v(e.$$.fragment,a),r=q(a),t=E(a,"SECTION",{});var c=R(t);l.l(c),c.forEach($)},m(a,c){T(e,a,c),k(a,r,c),k(a,t,c),u[n].m(t,null),o=!0},p(a,[c]){const f={};c&4&&(f.url=a[2].url.href),e.$set(f),l.p(a,c)},i(a){o||(g(e.$$.fragment,a),g(l),o=!0)},o(a){h(e.$$.fragment,a),h(l),o=!1},d(a){y(e,a),a&&$(r),a&&$(t),u[n].d()}}}let ce=!1;function ie(s,e,r){let t,n,l;I(s,Y,m=>r(6,t=m)),I(s,X,m=>r(2,n=m)),I(s,j,m=>r(7,l=m));const{namespace:o}=n.params,{workflow:i,workers:u}=l;let p=new Date;const a=()=>Q({workflow:i,namespace:o},n.stuff.settings,t==null?void 0:t.accessToken);let c;const f=()=>{r(1,c=Q({workflow:i,namespace:o},n.stuff.settings,t==null?void 0:t.accessToken)),c.then(()=>{r(0,p=new Date)})};return i.isRunning&&r(1,c=a()),[p,c,n,i,u,f]}class fe extends V{constructor(e){super(),O(this,e,ie,se,U,{})}}function ue(s){let e,r;return e=new fe({}),{c(){w(e.$$.fragment)},l(t){v(e.$$.fragment,t)},m(t,n){T(e,t,n),r=!0},p:W,i(t){r||(g(e.$$.fragment,t),r=!0)},o(t){h(e.$$.fragment,t),r=!1},d(t){y(e,t)}}}class je extends V{constructor(e){super(),O(this,e,null,ue,U,{})}}export{je as default};
