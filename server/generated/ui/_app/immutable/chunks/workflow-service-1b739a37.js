import{a6 as S}from"./index-8e660855.js";import{s as C}from"./settings-7aeda309.js";import{s as D}from"./simplify-attributes-34cbbe81.js";import{r as h,a as A,b as q}from"./route-for-api-80fe65aa.js";import{i as K,b as P,t as I,c as Q}from"./format-date-2e95557a.js";const R=(t=C)=>!S(t).disableWriteActions,F=(t=[])=>t.map(o=>{const n=D(o,!0),i=o.activityId;return{...n,id:i}}),W=t=>{var k,x,g,y,E,T;const o=t.workflowExecutionInfo.type.name,n=t.workflowExecutionInfo.execution.workflowId,i=t.workflowExecutionInfo.execution.runId,s=String(t.workflowExecutionInfo.startTime),l=String(t.workflowExecutionInfo.closeTime),c=t.workflowExecutionInfo.status,r=t.workflowExecutionInfo.status==="Running",w=t.workflowExecutionInfo.historyLength,d=`/workflows/${n}/${i}`,m=(x=(k=t==null?void 0:t.executionConfig)==null?void 0:k.taskQueue)==null?void 0:x.name,f=(g=t==null?void 0:t.workflowExecutionInfo)==null?void 0:g.parentNamespaceId,e=(y=t==null?void 0:t.workflowExecutionInfo)==null?void 0:y.parentExecution,u=t.workflowExecutionInfo.stateTransitionCount,a=(E=t.executionConfig)==null?void 0:E.defaultWorkflowTaskTimeout,b=F(t.pendingActivities),$=(T=t==null?void 0:t.pendingChildren)!=null?T:[];return{name:o,id:n,runId:i,startTime:s,endTime:l,status:c,historyEvents:w,url:d,taskQueue:m,pendingActivities:b,pendingChildren:$,parentNamespaceId:f,parent:e,stateTransitionCount:u,isRunning:r,defaultWorkflowTaskTimeout:a,get canBeTerminated(){return r&&R()}}},N=t=>(t.executions||[]).map(o=>W({workflowExecutionInfo:o})),B={workflowId:"WorkflowId",workflowType:"WorkflowType",timeRange:"StartTime",executionStatus:"ExecutionStatus",closeTime:"CloseTime"},j=["workflowId","workflowType","timeRange","executionStatus","closeTime"],L=t=>!(t===null||t===void 0||t===""||typeof t=="string"&&t==="undefined"),O=t=>{if(typeof t!="string")return!1;for(const o of j)if(o===t)return!0;return!1},U=(t,o,n)=>{const i=B[t];return o==="All"?"":K(o)||P(o)?n?`${i} > "${I(o)}"`:`${i} BETWEEN "${I(o)}" AND "${Q()}"`:`${i}="${o}"`},_=(t,o)=>Object.entries(t).map(([n,i])=>{if(O(n)&&L(i))return U(n,i,o)}).filter(Boolean),z=(t,o=!1)=>_(t,o).join(" and "),V=async(t,o,n=fetch,i=!1)=>{var f;const s=decodeURIComponent(o.query||z(o,i)),l=i?"workflows.archived":"workflows";let c="";const r=e=>{var u,a;q(e),c=(a=(u=e==null?void 0:e.body)==null?void 0:u.message)!=null?a:`Error fetching workflows: ${e.status}: ${e.statusText}`},w=await h(l,{namespace:t}),{executions:d,nextPageToken:m}=(f=await A(w,{params:{query:s},onError:r,handleError:r,request:n}))!=null?f:{executions:[],nextPageToken:""};return{workflows:N({executions:d}),nextPageToken:String(m),error:c}},Y=async(t,o,n=fetch)=>V(t,o,n,!0);async function Z(t,o=fetch){const n=await h("workflow",t);return A(n,{request:o}).then(W)}export{V as a,Y as b,Z as f,z as t};
