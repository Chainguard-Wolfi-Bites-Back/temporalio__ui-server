import{d as h,e as d,t as F}from"./route-for-62d7d3b1.js";import{E as P}from"./index-0094b5a5.js";import{w as b}from"./index-d0d31c39.js";import{n as O}from"./notifications-09a021c6.js";import{i as W}from"./is-network-error-5f9e2367.js";import{i as z}from"./is-function-45497f08.js";import{p as L}from"./get-public-path-6c4a8950.js";const N=b(null),S=(c,n=O,i=N,o=d)=>{if(T(c)&&o){window.location.assign(h(c==null?void 0:c.message));return}if(y(c)&&o){window.location.assign(h(c==null?void 0:c.message));return}if(W(c))throw n.add("error",`${c.statusCode} ${c.statusText}`),i.set(c),c;typeof c=="string"&&n.add("error",c),c instanceof Error&&n.add("error",c.message)},p=(c,n=d)=>{var o;const i=`${c==null?void 0:c.status} ${(o=c==null?void 0:c.body)==null?void 0:o.message}`;if(T(c)&&n){window.location.assign(h(i));return}if(y(c)&&n){window.location.assign(h(i));return}},T=c=>(c==null?void 0:c.statusCode)===401||(c==null?void 0:c.status)===401,y=c=>(c==null?void 0:c.statusCode)===403||(c==null?void 0:c.status)===403,a=c=>(c==null?void 0:c.message)!==void 0&&typeof(c==null?void 0:c.message)=="string",_=async(c,n={},i=10)=>{var I;const{params:o={},request:w=fetch,token:u,shouldRetry:g=!1,notifyOnError:E=!0,handleError:v=S,onRetry:A=P,onError:k,retryInterval:C=5e3,isBrowser:$=d}=n;let{options:l}=n;const U=u?{next_page_token:u}:{},q=new URLSearchParams({...o,...U}),R=F(c,q);try{l=B(l,$),globalThis!=null&&globalThis.AccessToken&&(l.headers=await H(l==null?void 0:l.headers,globalThis.AccessToken,$));const s=await w(R,l),f=await s.json(),{status:t,statusText:x}=s;if(!s.ok)if(k&&z(k))k({status:t,statusText:x,body:f});else throw{statusCode:s.status,statusText:s.statusText,response:s,message:(I=f==null?void 0:f.message)!=null?I:s.statusText};return f}catch(s){if(E){if(v(s),g&&i>0)return new Promise(f=>{const t=i-1;A(t),setTimeout(()=>{f(_(c,n,t))},C)})}else throw s}},B=(c,n=d)=>{const i={credentials:"include",...c};return i.headers=K(c==null?void 0:c.headers,n),i},H=async(c,n,i=d)=>{if(c||(c={}),!i)return c;try{const o=await n();o&&(c.Authorization=`Bearer ${o}`)}catch(o){console.error(o)}return c},K=(c,n=d)=>{if(c||(c={}),!n)return c;const i="_csrf=",o="X-CSRF-TOKEN";try{let u=document.cookie.split(";").find(g=>g.includes(i));u&&!c[o]&&(u=u.trim().slice(i.length),c[o]=u)}catch(w){console.error(w)}return c};function X(c=d){const n="",i=!n.startsWith("http");let o="";return i?o=c?window.location.origin+n:"":o=n,o.endsWith("/")&&(o=o.slice(0,-1)),o}const D=(c,n)=>c.replace("%namespace%",n),G=c=>{var i;let n="";return((i=globalThis==null?void 0:globalThis.AppConfig)==null?void 0:i.apiUrl)&&c?n=D(globalThis.AppConfig.apiUrl,c):n=X(),n.endsWith("/")&&(n=n.slice(0,-1)),n=`${n}${L}`,n},J=(c,n)=>(c.startsWith("/")&&(c=c.slice(1)),`${G(n)}/api/v1/${c}`),M=c=>Object.keys(c!=null?c:{}).reduce((n,i)=>(n[i]=encodeURIComponent(encodeURIComponent(c[i])),n),{namespace:"",workflowId:"",scheduleId:"",runId:"",queue:""});function r(c,n,i=!0){i&&(n=M(n));const o={cluster:"/cluster","events.ascending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/events`,"events.descending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/events/reverse`,namespaces:"/namespaces",query:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/query`,"schedule.delete":`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`,schedule:`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`,schedules:`/namespaces/${n==null?void 0:n.namespace}/schedules`,"search-attributes":"/search-attributes",settings:"/settings","task-queue":`/namespaces/${n==null?void 0:n.namespace}/task-queues/${n==null?void 0:n.queue}`,user:"/me","workflow.terminate":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/terminate`,workflow:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}`,"workflows.archived":`/namespaces/${n==null?void 0:n.namespace}/workflows/archived`,workflows:`/namespaces/${n==null?void 0:n.namespace}/workflows`};return J(o[c],n==null?void 0:n.namespace)}export{r as a,p as b,X as g,S as h,a as i,N as n,_ as r};
