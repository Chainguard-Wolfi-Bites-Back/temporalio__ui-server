import{d as h,e as d,t as F}from"./route-for-4a4bbbc1.js";import{E as P}from"./index-9ea626a2.js";import{w as O}from"./index-ed4e6b3e.js";import{n as b}from"./notifications-92f665fe.js";import{i as W}from"./is-network-error-5f9e2367.js";import{i as z}from"./is-function-45497f08.js";import{p as L}from"./get-public-path-6c4a8950.js";const N=O(null),S=(o,n=b,c=N,i=d)=>{if(T(o)&&i){window.location.assign(h());return}if(y(o)&&i){window.location.assign(h());return}if(W(o))throw n.add("error",`${o.statusCode} ${o.statusText}`),c.set(o),o;typeof o=="string"&&n.add("error",o),o instanceof Error&&n.add("error",o.message)},p=(o,n=d)=>{if(T(o)&&n){window.location.assign(h());return}if(y(o)&&n){window.location.assign(h());return}},T=o=>(o==null?void 0:o.statusCode)===401||(o==null?void 0:o.status)===401,y=o=>(o==null?void 0:o.statusCode)===403||(o==null?void 0:o.status)===403,a=o=>(o==null?void 0:o.message)!==void 0&&typeof(o==null?void 0:o.message)=="string",_=async(o,n={},c=10)=>{var I;const{params:i={},request:w=fetch,token:u,shouldRetry:k=!1,notifyOnError:E=!0,handleError:v=S,onRetry:A=P,onError:g,retryInterval:C=5e3,isBrowser:$=d}=n;let{options:l}=n;const U=u?{next_page_token:u}:{},q=new URLSearchParams({...i,...U}),R=F(o,q);try{l=B(l,$),globalThis!=null&&globalThis.AccessToken&&(l.headers=await H(l==null?void 0:l.headers,globalThis.AccessToken,$));const s=await w(R,l),f=await s.json(),{status:t,statusText:x}=s;if(!s.ok)if(g&&z(g))g({status:t,statusText:x,body:f});else throw{statusCode:s.status,statusText:s.statusText,response:s,message:(I=f==null?void 0:f.message)!=null?I:s.statusText};return f}catch(s){if(E){if(v(s),k&&c>0)return new Promise(f=>{const t=c-1;A(t),setTimeout(()=>{f(_(o,n,t))},C)})}else throw s}},B=(o,n=d)=>{const c={credentials:"include",...o};return c.headers=K(o==null?void 0:o.headers,n),c},H=async(o,n,c=d)=>{if(o||(o={}),!c)return o;try{const i=await n();i&&(o.Authorization=`Bearer ${i}`)}catch(i){console.error(i)}return o},K=(o,n=d)=>{if(o||(o={}),!n)return o;const c="_csrf=",i="X-CSRF-TOKEN";try{let u=document.cookie.split(";").find(k=>k.includes(c));u&&!o[i]&&(u=u.trim().slice(c.length),o[i]=u)}catch(w){console.error(w)}return o};function X(o=d){const n="",c=!n.startsWith("http");let i="";return c?i=o?window.location.origin+n:"":i=n,i.endsWith("/")&&(i=i.slice(0,-1)),i}const D=(o,n)=>o.replace("%namespace%",n),G=o=>{var c;let n="";return((c=globalThis==null?void 0:globalThis.AppConfig)==null?void 0:c.apiUrl)&&o?n=D(globalThis.AppConfig.apiUrl,o):n=X(),n.endsWith("/")&&(n=n.slice(0,-1)),n=`${n}${L}`,n},J=(o,n)=>(o.startsWith("/")&&(o=o.slice(1)),`${G(n)}/api/v1/${o}`),M=o=>Object.keys(o!=null?o:{}).reduce((n,c)=>(n[c]=encodeURIComponent(encodeURIComponent(o[c])),n),{namespace:"",workflowId:"",scheduleId:"",runId:"",queue:""});function r(o,n,c=!0){c&&(n=M(n));const i={cluster:"/cluster","events.ascending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/events`,"events.descending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/events/reverse`,namespaces:"/namespaces",query:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/query`,"schedule.delete":`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`,schedule:`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`,schedules:`/namespaces/${n==null?void 0:n.namespace}/schedules`,"search-attributes":"/search-attributes",settings:"/settings","task-queue":`/namespaces/${n==null?void 0:n.namespace}/task-queues/${n==null?void 0:n.queue}`,user:"/me","workflow.terminate":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/terminate`,workflow:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}`,"workflows.archived":`/namespaces/${n==null?void 0:n.namespace}/workflows/archived`,workflows:`/namespaces/${n==null?void 0:n.namespace}/workflows`};return J(i[o],n==null?void 0:n.namespace)}export{r as a,p as b,X as g,S as h,a as i,N as n,_ as r};
