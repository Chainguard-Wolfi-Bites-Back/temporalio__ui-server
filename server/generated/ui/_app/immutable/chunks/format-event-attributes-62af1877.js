import{f as d}from"./format-date-4f0e1470.js";import{a as w,b as h}from"./index-bbacc01c.js";import{c}from"./format-camel-case-704a0419.js";const p={key:"",value:""},E=new Set(["activityId","attempt","binaryChecksum","identity","parentInitiatedEventId","requestId","scheduledEventId","startedEventId","lastHeartbeatTime","scheduledTime","expirationTime"]),C=t=>E.has(t),l=(t,e)=>!(e===null||e===void 0||e===""||e==="0s"||t==="type"),x=t=>!(t===null||t===void 0||t===""||Array.isArray(t)&&!t.length),V=t=>typeof t=="string"?t:(t==null?void 0:t.payloads)??(t==null?void 0:t.indexedFields)??(t==null?void 0:t.points)??t,I=["baseRunId","continuedExecutionRunId","firstExecutionRunId","newExecutionRunId","newRunId","originalExecutionRunId"],$=t=>{for(const e of I)if(t===e)return!0;return!1},T=["taskQueueName"],B=t=>{for(const e of T)if(t===e)return!0;return!1},S=["workflowExecutionWorkflowId","workflowExecutionRunId"],M=(t,e)=>{const r=Boolean((e==null?void 0:e.workflowExecutionWorkflowId)&&(e==null?void 0:e.workflowExecutionRunId));for(const n of S)if(t===n&&r)return!0;return!1},f=(t,e)=>{if(typeof e=="object"){const[r]=Object.keys(e);return{key:t+c(r),value:e[r]}}else return{key:t,value:e.toString()}},D=["failure","input","activityType","parentInitiatedEventId","workflowExecution","workflowType","taskQueue"],R=({attributes:t})=>{for(const[e,r]of Object.entries(t))if(l(e,r))return f(e,r)},m=t=>{var r,n,o,i;const e=R(t);if(h(t)){const s=(i=(o=(n=(r=t.markerRecordedEventAttributes)==null?void 0:r.details)==null?void 0:n.data)==null?void 0:o.payloads)==null?void 0:i[0],a=(s==null?void 0:s.ActivityType)??(s==null?void 0:s.activity_type);if(a)return f("ActivityType",a)}for(const[s,a]of Object.entries(t.attributes))for(const k of D)if(s===k&&l(s,a))return f(s,a);return e},b=({lastEvent:t})=>m(t),U=t=>t?w(t)?b(t):m(t):p,j=new Set(["header"]),L=new Set(["taskQueue","retryPolicy","parentWorkflowExecution","workflowExecution"]),Q=new Set(["maximumAttempts"]),y="Unlimited",A="No Expiration",q=(t,e)=>t===0?A:e,z=(t,e)=>t?t-e:y,H=t=>t||y,G=(t,e)=>t==="maximumAttempts"&&!e?y:e,O=(t,e)=>{if(L.has(e)&&typeof t[e]=="object"){for(const[r,n]of Object.entries(t[e]))x(n)&&(Q.has(r)?t[`${e}${c(r)}`]=G(r,n):t[`${e}${c(r)}`]=n);delete t[e]}},_=(t,{compact:e}={compact:!1})=>{const r={};e&&(r.eventTime=d(t.eventTime));for(const[n,o]of Object.entries(t.attributes)){const i=l(n,o);!j.has(n)&&i&&(r[n]=o),O(r,n)}return r},u=["summary","parent","activity","taskQueue","schedule","retryPolicy","workflow","searchAttributes"],v={activity:{label:"Activity"},parent:{label:"Parent"},retryPolicy:{label:"Retry Policy"},schedule:{label:"Schedule"},searchAttributes:{label:"Search Attributes"},summary:{label:"Summary"},taskQueue:{label:"Task Queue"},workflow:{label:"Workflow"}},P=(t,e)=>{var r,n;t.category==="activity"&&((r=e==null?void 0:e.activity)!=null&&r.length)&&(e.summary=[...e.activity,...e.summary],e.activity=[]),t.category==="activity"&&((n=e==null?void 0:e.workflow)!=null&&n.length)&&(e.summary=[...e.summary,...e.workflow],e.workflow=[])},W=t=>{const e=new Set(["summary","searchAttributes"]);for(const[r,n]of Object.entries(t))n.length===1&&!e.has(r)&&(t.summary=[...t.summary,...n],t[r]=[])},J=(t,e)=>{const r={};u.forEach(n=>{n==="summary"?r[n]=Object.keys(e):r[n]=[]});for(const n in e){const o=u.find(i=>n.includes(i));o&&(r[o]=[n,...r[o]],r.summary=r.summary.filter(i=>i!==n))}return P(t,r),W(r),r};export{z as a,M as b,B as c,C as d,v as e,q as f,V as g,_ as h,J as i,U as j,H as k,$ as s};
