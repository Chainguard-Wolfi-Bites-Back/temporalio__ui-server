import{r as o,a as u,i as y}from"./route-for-api-c2cf7683.js";import{b as d}from"./decode-payload-6be25ef1.js";const f=t=>{const r=t.indexOf("["),n=t.indexOf("]");return t.slice(r+1,n).split(" ").filter(e=>e!=="__stack_trace").map(e=>e.endsWith(",")?e.slice(0,e.length-1):e)},l=async(t,r)=>(r=await r,{namespace:t,workflowId:r.id,runId:r.runId});async function s({workflow:t,namespace:r,queryType:n},e=fetch,a){t=await t;const i=await l(r,t),c=await o("query",i);return await u(c,{options:{method:"POST",body:JSON.stringify({execution:{workflowId:t.id,runId:t.runId},query:{queryType:n}})},request:e,onError:a,notifyOnError:!1})}async function h(t,r=fetch){return new Promise((n,e)=>{s({...t,queryType:"@@temporal-internal__list"},r,a=>{y(a.body)&&a.body.message.includes("@@temporal-internal__list")?n(f(a.body.message)):e(a)})})}async function p(t,r=fetch){return s(t,r).then(n=>{const{queryResult:e}=n!=null?n:{queryResult:{payloads:[]}};let a=e.payloads;try{return a[0]&&(a=d(e.payloads[0].data)),JSON.parse(a)}catch{return typeof a!="string"?JSON.stringify(a):a}})}async function O(t,r=fetch){return p({...t,queryType:"__stack_trace"},r)}export{p as a,O as b,h as g};
