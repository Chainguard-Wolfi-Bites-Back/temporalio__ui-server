import{f as w}from"./format-date-e74858c6.js";import{f as h,i as p}from"./index-f415d6e5.js";import{c as a}from"./format-camel-case-13aef7c6.js";const E={key:"",value:""},x=new Set(["activityId","attempt","binaryChecksum","identity","parentInitiatedEventId","requestId","scheduledEventId","startedEventId","lastHeartbeatTime","scheduledTime","expirationTime"]),V=t=>x.has(t),l=(t,e)=>!(e===null||e===void 0||e===""||e==="0s"||t==="type"),I=t=>!(t===null||t===void 0||t===""||Array.isArray(t)&&!t.length),$=t=>{var e,r,n;return typeof t=="string"?t:(n=(r=(e=t==null?void 0:t.payloads)!=null?e:t==null?void 0:t.indexedFields)!=null?r:t==null?void 0:t.points)!=null?n:t},T=["baseRunId","continuedExecutionRunId","firstExecutionRunId","newExecutionRunId","newRunId","originalExecutionRunId"],B=t=>{for(const e of T)if(t===e)return!0;return!1},S=["taskQueueName"],M=t=>{for(const e of S)if(t===e)return!0;return!1},j=["workflowExecutionWorkflowId","workflowExecutionRunId"],U=(t,e)=>{const r=Boolean((e==null?void 0:e.workflowExecutionWorkflowId)&&(e==null?void 0:e.workflowExecutionRunId));for(const n of j)if(t===n&&r)return!0;return!1},f=(t,e)=>{if(typeof e=="object"){const[r]=Object.keys(e);return{key:t+a(r),value:e[r]}}else return{key:t,value:e.toString()}},D=["failure","input","activityType","parentInitiatedEventId","workflowExecution","workflowType","taskQueue"],R=({attributes:t})=>{for(const[e,r]of Object.entries(t))if(l(e,r))return f(e,r)},k=t=>{var r,n,o,i,u;const e=R(t);if(p(t)){const s=(i=(o=(n=(r=t.markerRecordedEventAttributes)==null?void 0:r.details)==null?void 0:n.data)==null?void 0:o.payloads)==null?void 0:i[0],c=(u=s==null?void 0:s.ActivityType)!=null?u:s==null?void 0:s.activity_type;if(c)return f("ActivityType",c)}for(const[s,c]of Object.entries(t.attributes))for(const d of D)if(s===d&&l(s,c))return f(s,c);return e},b=({lastEvent:t})=>k(t),q=t=>t?h(t)?b(t):k(t):E,L=new Set(["header"]),O=new Set(["taskQueue","retryPolicy","parentWorkflowExecution","workflowExecution"]),Q=new Set(["maximumAttempts"]),y="Unlimited",A="No Expiration",z=(t,e)=>t===0?A:e,H=(t,e)=>t===0?y:t-e,_=t=>t===0?y:t,G=(t,e)=>t==="maximumAttempts"&&e===0?y:e,P=(t,e)=>{if(O.has(e)&&typeof t[e]=="object"){for(const[r,n]of Object.entries(t[e]))I(n)&&(Q.has(r)?t[`${e}${a(r)}`]=G(r,n):t[`${e}${a(r)}`]=n);delete t[e]}},v=(t,{compact:e}={compact:!1})=>{const r={};e&&(r.eventTime=w(t.eventTime));for(const[n,o]of Object.entries(t.attributes)){const i=l(n,o);!L.has(n)&&i&&(r[n]=o),P(r,n)}return r},m=["summary","parent","activity","taskQueue","schedule","retryPolicy","workflow","searchAttributes"],J={activity:{label:"Activity"},parent:{label:"Parent"},retryPolicy:{label:"Retry Policy"},schedule:{label:"Schedule"},searchAttributes:{label:"Search Attributes"},summary:{label:"Summary"},taskQueue:{label:"Task Queue"},workflow:{label:"Workflow"}},W=(t,e)=>{var r,n;t.category==="activity"&&((r=e==null?void 0:e.activity)==null?void 0:r.length)&&(e.summary=[...e.activity,...e.summary],e.activity=[]),t.category==="activity"&&((n=e==null?void 0:e.workflow)==null?void 0:n.length)&&(e.summary=[...e.summary,...e.workflow],e.workflow=[])},K=t=>{const e=new Set(["summary","searchAttributes"]);for(const[r,n]of Object.entries(t))n.length===1&&!e.has(r)&&(t.summary=[...t.summary,...n],t[r]=[])},X=(t,e)=>{const r={};m.forEach(n=>{n==="summary"?r[n]=Object.keys(e):r[n]=[]});for(const n of Object.keys(e)){const o=m.find(i=>n.includes(i));o&&(r[o]=[n,...r[o]],r.summary=r.summary.filter(i=>i!==n))}return W(t,r),K(r),r};export{U as a,M as b,V as c,J as d,X as e,v as f,$ as g,q as h,z as i,H as j,_ as k,B as s};
