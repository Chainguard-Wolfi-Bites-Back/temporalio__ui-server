import{c as E,p as C}from"./is-http-f051b645.js";import{g as T,a as v,c as W,b as y,d as x}from"./get-codec-860ba82a.js";import{f as h}from"./format-date-8d85ffcd.js";import{g as A,f as g}from"./index-25c64365.js";import{s as S}from"./simplify-attributes-e9cbffa0.js";const b={ActivityTaskCanceled:"activity",ActivityTaskCancelRequested:"activity",ActivityTaskCompleted:"activity",ActivityTaskFailed:"activity",ActivityTaskScheduled:"activity",ActivityTaskStarted:"activity",ActivityTaskTimedOut:"activity",ChildWorkflowExecutionCanceled:"child-workflow",ChildWorkflowExecutionCompleted:"child-workflow",ChildWorkflowExecutionFailed:"child-workflow",ChildWorkflowExecutionStarted:"child-workflow",ChildWorkflowExecutionTerminated:"child-workflow",ChildWorkflowExecutionTimedOut:"child-workflow",StartChildWorkflowExecutionFailed:"child-workflow",StartChildWorkflowExecutionInitiated:"child-workflow",MarkerRecorded:"marker",SignalExternalWorkflowExecutionFailed:"signal",SignalExternalWorkflowExecutionInitiated:"signal",WorkflowExecutionSignaled:"signal",TimerCanceled:"timer",TimerFired:"timer",TimerStarted:"timer",WorkflowExecutionCanceled:"workflow",WorkflowExecutionCancelRequested:"workflow",WorkflowExecutionCompleted:"workflow",WorkflowExecutionContinuedAsNew:"workflow",WorkflowExecutionFailed:"workflow",WorkflowExecutionStarted:"workflow",WorkflowExecutionTerminated:"workflow",WorkflowExecutionTimedOut:"workflow",WorkflowTaskCompleted:"workflow",WorkflowTaskFailed:"workflow",WorkflowTaskScheduled:"workflow",WorkflowTaskStarted:"workflow",WorkflowTaskTimedOut:"workflow",ExternalWorkflowExecutionCancelRequested:"workflow",ExternalWorkflowExecutionSignaled:"workflow",RequestCancelExternalWorkflowExecutionFailed:"workflow",RequestCancelExternalWorkflowExecutionInitiated:"workflow",UpsertWorkflowSearchAttributes:"command"},k=[{label:"All",option:void 0},{label:"Activity",option:"activity",color:"#8B5CF6"},{label:"Child Workflow",option:"child-workflow",color:"#F59E0B"},{label:"Command",option:"command",color:"#10B981"},{label:"Marker",option:"marker",color:"#EC4899"},{label:"Signal",option:"signal",color:"#DD6B20"},{label:"Timer",option:"timer",color:"#1D4ED8"},{label:"Workflow",option:"workflow",color:"#10B981"}],F=[void 0,"activity","signal","timer"],z=k.filter(({option:o})=>F.includes(o)),R=["activity","child-workflow","command","marker","signal","timer"];k.filter(({option:o})=>R.includes(o));const q=o=>b[o],O=["Unspecified","Scheduled","Open","New","Started","Initiated","Running","Completed","Fired","CancelRequested","TimedOut","Signaled","Canceled","Failed","Terminated"],B=o=>{if(o.includes("RequestCancel"))return"CancelRequested";for(const t of O)if(o.includes(t))return t};async function D({historyEvent:o,namespace:t,settings:e,accessToken:n},{convertWithCodec:l=W,convertWithWebsocket:i=y,decodeAttributes:a=x,encoderEndpoint:c=E,codecPassAccessToken:s=C}={}){const{key:d,attributes:r}=g(o),w=T(e,c),f=v(e,s),u={...e,codec:{...e==null?void 0:e.codec,endpoint:w,passAccessToken:f}},m=w?await l({attributes:r,namespace:t,settings:u,accessToken:n}):await i(r),p=a(m);return{type:d,...p}}const I=async({historyEvent:o,namespace:t,settings:e,accessToken:n})=>{const l=String(o.eventId),i=o.eventType,a=h(String(o.eventTime)),c=B(i),s=q(i),d=await D({historyEvent:o,namespace:t,settings:e,accessToken:n}).then(r=>S(r));return{...o,attributes:d,eventType:i,classification:c,category:s,id:l,name:i,timestamp:a}},G=async({response:o,namespace:t,settings:e,accessToken:n})=>{const l=await Promise.all(o.map(a=>I({historyEvent:a,namespace:t,settings:e,accessToken:n}))),i=A(l);return{events:l,eventGroups:i}};export{k as a,z as c,G as t};
