import{w as p}from"./index-71be9f1c.js";const u=t=>typeof t=="function";function d(t,s=null,f=!1){var l,n,a;let r=u(s)?s():s,o;try{(l=window==null?void 0:window.localStorage)!=null&&l.getItem(t)&&(r=JSON.parse((a=(n=window==null?void 0:window.localStorage)==null?void 0:n.getItem(t))!=null?a:""))}catch{r=null}const{subscribe:g,set:i}=p(r);return f&&(o=new BroadcastChannel(`persist-store-${t}`),o==null||o.addEventListener("message",e=>{i(e.data)})),{subscribe:g,set:e=>{var c,w;o&&o.postMessage(e),e===null?(c=window==null?void 0:window.localStorage)==null||c.removeItem(t):(w=window==null?void 0:window.localStorage)==null||w.setItem(t,JSON.stringify(e)),i(e)}}}export{u as i,d as p};
