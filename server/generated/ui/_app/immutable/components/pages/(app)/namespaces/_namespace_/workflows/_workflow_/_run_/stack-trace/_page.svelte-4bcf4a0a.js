import{S as U,i as z,s as A,k as y,l as S,m as C,h as $,b as d,f as _,t as k,J as P,w as b,x as v,y as E,z as T,V,e as W,Y,q as h,r as w,K as g,B as F,a as q,c as D,n as I,u as j}from"../../../../../../../../../chunks/index-6bdaee4d.js";import{p as J}from"../../../../../../../../../chunks/stores-de421f88.js";import{w as G,W as H,b as B}from"../../../../../../../../../chunks/workflow-signal-enabled-c82345bb.js";import{b as N}from"../../../../../../../../../chunks/query-service-2055fcbd.js";import{C as M}from"../../../../../../../../../chunks/code-block-c0ad915e.js";import{B as X}from"../../../../../../../../../chunks/button-152cbc02.js";import{E as K}from"../../../../../../../../../chunks/empty-state-4bc5e943.js";import{L as Z}from"../../../../../../../../../chunks/loading-e952233b.js";import{L as x}from"../../../../../../../../../chunks/link-51c9d8f4.js";import{a as ee}from"../../../../../../../../../chunks/auth-user-73004d2e.js";import{P as te}from"../../../../../../../../../chunks/page-title-87d93540.js";import{e as Q,f as O}from"../../../../../../../../../chunks/workflow-terminate-enabled-c7b58712.js";function re(l){let e,r;return e=new K({props:{title:"No Stack Traces Found",dataCy:"query-stack-trace-empty",$$slots:{default:[le]},$$scope:{ctx:l}}}),{c(){b(e.$$.fragment)},l(t){v(e.$$.fragment,t)},m(t,n){E(e,t,n),r=!0},p(t,n){const a={};n&4096&&(a.$$scope={dirty:n,ctx:t}),e.$set(a)},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function ne(l){let e,r,t,n={ctx:l,current:null,token:null,hasCatch:!0,pending:ie,then:ce,catch:se,value:10,error:11,blocks:[,,,]};return V(r=l[1],n),{c(){e=W(),n.block.c()},l(a){e=W(),n.block.l(a)},m(a,o){d(a,e,o),n.block.m(a,n.anchor=o),n.mount=()=>e.parentNode,n.anchor=e,t=!0},p(a,o){l=a,n.ctx=l,o&2&&r!==(r=l[1])&&V(r,n)||Y(n,l,o)},i(a){t||(_(n.block),t=!0)},o(a){for(let o=0;o<3;o+=1){const c=n.blocks[o];k(c)}t=!1},d(a){a&&$(e),n.block.d(a),n.token=null,n=null}}}function ae(l){var f;let e,r,t,n,a=((f=l[2])==null?void 0:f.taskQueue)+"",o,c,s;return t=new x({props:{href:"https://docs.temporal.io/workflows#stack-trace-query",$$slots:{default:[oe]},$$scope:{ctx:l}}}),{c(){e=y("p"),r=h("To enable "),b(t.$$.fragment),n=h(", run a Worker on the "),o=h(a),c=h(" Task Queue.")},l(m){e=S(m,"P",{});var p=C(e);r=w(p,"To enable "),v(t.$$.fragment,p),n=w(p,", run a Worker on the "),o=w(p,a),c=w(p," Task Queue."),p.forEach($)},m(m,p){d(m,e,p),g(e,r),E(t,e,null),g(e,n),g(e,o),g(e,c),s=!0},p(m,p){const u={};p&4096&&(u.$$scope={dirty:p,ctx:m}),t.$set(u)},i(m){s||(_(t.$$.fragment,m),s=!0)},o(m){k(t.$$.fragment,m),s=!1},d(m){m&&$(e),T(t)}}}function oe(l){let e;return{c(){e=h("stack traces")},l(r){e=w(r,"stack traces")},m(r,t){d(r,e,t)},d(r){r&&$(e)}}}function le(l){var n,a;let e,r,t=l[2].isRunning&&((a=(n=l[3])==null?void 0:n.pollers)==null?void 0:a.length)===0&&ae(l);return{c(){t&&t.c(),e=W()},l(o){t&&t.l(o),e=W()},m(o,c){t&&t.m(o,c),d(o,e,c),r=!0},p(o,c){var s,f;o[2].isRunning&&((f=(s=o[3])==null?void 0:s.pollers)==null?void 0:f.length)===0&&t.p(o,c)},i(o){r||(_(t),r=!0)},o(o){k(t),r=!1},d(o){t&&t.d(o),o&&$(e)}}}function se(l){let e,r;return e=new K({props:{title:"An Error Occured",content:"Please make sure you have at least one worker running."}}),{c(){b(e.$$.fragment)},l(t){v(e.$$.fragment,t)},m(t,n){E(e,t,n),r=!0},p:F,i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function ce(l){let e,r,t,n,a,o=l[0].toLocaleTimeString()+"",c,s,f,m,p;return r=new X({props:{icon:"retry",loading:me,$$slots:{default:[fe]},$$scope:{ctx:l}}}),r.$on("click",l[4]),m=new M({props:{content:l[10],language:"text",dataCy:"query-stack-trace"}}),{c(){e=y("div"),b(r.$$.fragment),t=q(),n=y("p"),a=h("Stack Trace at "),c=h(o),s=q(),f=y("div"),b(m.$$.fragment),this.h()},l(u){e=S(u,"DIV",{class:!0});var i=C(e);v(r.$$.fragment,i),t=D(i),n=S(i,"P",{});var R=C(n);a=w(R,"Stack Trace at "),c=w(R,o),R.forEach($),i.forEach($),s=D(u),f=S(u,"DIV",{class:!0});var L=C(f);v(m.$$.fragment,L),L.forEach($),this.h()},h(){I(e,"class","flex items-center gap-4"),I(f,"class","flex items-start h-full")},m(u,i){d(u,e,i),E(r,e,null),g(e,t),g(e,n),g(n,a),g(n,c),d(u,s,i),d(u,f,i),E(m,f,null),p=!0},p(u,i){const R={};i&4096&&(R.$$scope={dirty:i,ctx:u}),r.$set(R),(!p||i&1)&&o!==(o=u[0].toLocaleTimeString()+"")&&j(c,o);const L={};i&2&&(L.content=u[10]),m.$set(L)},i(u){p||(_(r.$$.fragment,u),_(m.$$.fragment,u),p=!0)},o(u){k(r.$$.fragment,u),k(m.$$.fragment,u),p=!1},d(u){u&&$(e),T(r),u&&$(s),u&&$(f),T(m)}}}function fe(l){let e;return{c(){e=h("Refresh")},l(r){e=w(r,"Refresh")},m(r,t){d(r,e,t)},d(r){r&&$(e)}}}function ie(l){let e,r,t,n,a,o;return r=new Z({}),{c(){e=y("div"),b(r.$$.fragment),t=q(),n=y("p"),a=h("(This will fail if you have no workers running.)"),this.h()},l(c){e=S(c,"DIV",{class:!0});var s=C(e);v(r.$$.fragment,s),t=D(s),n=S(s,"P",{});var f=C(n);a=w(f,"(This will fail if you have no workers running.)"),f.forEach($),s.forEach($),this.h()},h(){I(e,"class","text-center")},m(c,s){d(c,e,s),E(r,e,null),g(e,t),g(e,n),g(n,a),o=!0},p:F,i(c){o||(_(r.$$.fragment,c),o=!0)},o(c){k(r.$$.fragment,c),o=!1},d(c){c&&$(e),T(r)}}}function ue(l){let e,r,t,n;const a=[ne,re],o=[];function c(s,f){var m,p;return s[2].isRunning&&((p=(m=s[3])==null?void 0:m.pollers)==null?void 0:p.length)>0?0:1}return r=c(l),t=o[r]=a[r](l),{c(){e=y("section"),t.c()},l(s){e=S(s,"SECTION",{});var f=C(e);t.l(f),f.forEach($)},m(s,f){d(s,e,f),o[r].m(e,null),n=!0},p(s,[f]){t.p(s,f)},i(s){n||(_(t),n=!0)},o(s){k(t),n=!1},d(s){s&&$(e),o[r].d()}}}let me=!1;function pe(l,e,r){let t,n,a;P(l,ee,i=>r(5,t=i)),P(l,J,i=>r(6,n=i)),P(l,G,i=>r(7,a=i));const{namespace:o}=n.params,{workflow:c,workers:s}=a;let f=new Date;const m=()=>{var i;return N({workflow:c,namespace:o},(i=n.data)===null||i===void 0?void 0:i.settings,t==null?void 0:t.accessToken)};let p;const u=()=>{var i;r(1,p=N({workflow:c,namespace:o},(i=n.data)===null||i===void 0?void 0:i.settings,t==null?void 0:t.accessToken)),p.then(()=>{r(0,f=new Date)})};return c.isRunning&&r(1,p=m()),[f,p,c,s,u]}class $e extends U{constructor(e){super(),z(this,e,pe,ue,A,{})}}function _e(l){let e,r;return e=new $e({}),{c(){b(e.$$.fragment)},l(t){v(e.$$.fragment,t)},m(t,n){E(e,t,n),r=!0},i(t){r||(_(e.$$.fragment,t),r=!0)},o(t){k(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function ke(l){let e,r,t,n;return e=new te({props:{title:`Stack Trace | ${l[1]}`,url:l[0].url.href}}),t=new H({props:{cancelEnabled:Q(l[0].data.settings),signalEnabled:B(l[0].data.settings),terminateEnabled:O(l[0].data.settings),$$slots:{default:[_e]},$$scope:{ctx:l}}}),{c(){b(e.$$.fragment),r=q(),b(t.$$.fragment)},l(a){v(e.$$.fragment,a),r=D(a),v(t.$$.fragment,a)},m(a,o){E(e,a,o),d(a,r,o),E(t,a,o),n=!0},p(a,[o]){const c={};o&1&&(c.url=a[0].url.href),e.$set(c);const s={};o&1&&(s.cancelEnabled=Q(a[0].data.settings)),o&1&&(s.signalEnabled=B(a[0].data.settings)),o&1&&(s.terminateEnabled=O(a[0].data.settings)),o&4&&(s.$$scope={dirty:o,ctx:a}),t.$set(s)},i(a){n||(_(e.$$.fragment,a),_(t.$$.fragment,a),n=!0)},o(a){k(e.$$.fragment,a),k(t.$$.fragment,a),n=!1},d(a){T(e,a),a&&$(r),T(t,a)}}}function ge(l,e,r){let t;P(l,J,a=>r(0,t=a));const n=t.params.workflow;return[t,n]}class Pe extends U{constructor(e){super(),z(this,e,ge,ke,A,{})}}export{Pe as default};
