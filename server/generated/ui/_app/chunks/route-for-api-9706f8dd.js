var L=Object.defineProperty;var I=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable;var E=(t,r,s)=>r in t?L(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,i=(t,r)=>{for(var s in r||(r={}))R.call(r,s)&&E(t,s,r[s]);if(I)for(var s of I(r))g.call(r,s)&&E(t,s,r[s]);return t};import{g as S}from"./navigation-3f1ea447.js";import{w as y}from"./index-eae5a65e.js";import{n as f}from"./notifications-2d1c3827.js";import{i as m}from"./is-network-error-ac7c8caf.js";import{b as A}from"./route-for-d606e623.js";const O=!0,q=y(null),v=t=>{if(C(t)&&O){S(A());return}if(U(t)){f.add("error",`${t.statusCode} ${t.statusText}`);return}if(m(t))throw f.add("error",`${t.statusCode} ${t.statusText}`),q.set(t),t;typeof t=="string"&&f.add("error",t),t instanceof Error&&f.add("error",t.message)},C=t=>m(t)?t.statusCode===401:!1,U=t=>m(t)?t.statusCode===403:!1,x=t=>typeof t=="function",b=(t,r)=>{const s=r instanceof URLSearchParams;return r&&!s&&(r=new URLSearchParams(r)),r?`${t}?${r}`:t},G=t=>t.message!==void 0&&typeof t.message=="string",F=async(t,r={},s=10)=>{const{params:n={},request:e=fetch,token:a,shouldRetry:k=!1,notifyOnError:p=!0,onError:w,retryInterval:T=5e3}=r;let{options:l}=r;const _=a?{next_page_token:a}:{},$=new URLSearchParams(i(i({},n),_)),P=b(t,$);try{l=N(l);const o=await e(P,l),u=await o.json(),{status:h,statusText:V}=o;if(!o.ok)if(w&&x(w))w({status:h,statusText:V,body:u});else throw{statusCode:o.status,statusText:o.statusText,response:o};return u}catch(o){if(p){if(v(o),k&&s>0)return new Promise(u=>{setTimeout(()=>{u(F(t,r,s-1))},T)})}else throw o}},N=t=>{const r=i({credentials:"include"},t);return r.headers=K(t==null?void 0:t.headers),r},K=t=>{t||(t={});const r="_csrf=",s="X-CSRF-TOKEN";try{let e=document.cookie.split(";").find(a=>a.includes(r));e&&!t[s]&&(e=e.trim().slice(r.length),t[s]=e)}catch(n){console.error(n)}return t};let c="";c.endsWith("/")&&(c=c.slice(0,-1));const D=t=>t.split("/").map(r=>encodeURIComponent(r)).join("/"),j=t=>(t.startsWith("/")&&(t=t.slice(1)),`${c}/api/v1/${D(t)}`);function J(t,r){const s=Object.keys(r!=null?r:{}).reduce((e,a)=>(e[a]=encodeURIComponent(r[a]),e),{namespace:"",workflowId:"",runId:"",queue:""}),n={cluster:"/cluster",settings:"/settings",user:"/me",namespaces:"/namespaces","task-queue":`/namespaces/${s==null?void 0:s.namespace}/task-queues/${s==null?void 0:s.queue}`,workflows:`/namespaces/${s==null?void 0:s.namespace}/workflows`,"workflows.archived":`/namespaces/${s==null?void 0:s.namespace}/workflows/archived`,workflow:`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}`,"workflow.terminate":`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}/terminate`,events:`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}/events`,query:`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}/query`};return j(n[t])}export{J as a,O as b,G as c,v as h,x as i,q as n,F as r};
