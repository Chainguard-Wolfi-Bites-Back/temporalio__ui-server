var b=Object.defineProperty;var _=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var $=(n,o,c)=>o in n?b(n,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):n[o]=c,t=(n,o)=>{for(var c in o||(o={}))x.call(o,c)&&$(n,c,o[c]);if(_)for(var c of _(o))F.call(o,c)&&$(n,c,o[c]);return n};import{w as U}from"./index-f257cd43.js";import{n as k}from"./notifications-5f9c30fb.js";import{i as E}from"./is-network-error-ac7c8caf.js";import{c as g,t as N}from"./route-for-e4b4dbdd.js";const h=!0,K=U(null),B=n=>{if(D(n)&&h){window.location.assign(g());return}if(M(n)&&h){window.location.assign(g());return}if(E(n))throw k.add("error",`${n.statusCode} ${n.statusText}`),K.set(n),n;typeof n=="string"&&k.add("error",n),n instanceof Error&&k.add("error",n.message)},D=n=>E(n)?n.statusCode===401:!1,M=n=>E(n)?n.statusCode===403:!1,j=n=>typeof n=="function",r=n=>n.message!==void 0&&typeof n.message=="string",z=async(n,o={},c=10)=>{var T;const{params:f={},request:l=fetch,token:w,shouldRetry:y=!1,notifyOnError:v=!0,onError:I,retryInterval:L=5e3}=o;let{options:i}=o;const R=w?{next_page_token:w}:{},O=new URLSearchParams(t(t({},f),R)),S=N(n,O);try{i=W(i),globalThis!=null&&globalThis.AccessToken&&(i.headers=await H(i==null?void 0:i.headers,globalThis.AccessToken));const s=await l(S,i),u=await s.json(),{status:q,statusText:C}=s;if(!s.ok)if(I&&j(I))I({status:q,statusText:C,body:u});else throw{statusCode:s.status,statusText:s.statusText,response:s,message:(T=u==null?void 0:u.message)!=null?T:s.statusText};return u}catch(s){if(v){if(B(s),y&&c>0)return new Promise(u=>{setTimeout(()=>{u(z(n,o,c-1))},L)})}else throw s}},W=n=>{const o=t({credentials:"include"},n);return o.headers=X(n==null?void 0:n.headers),o},H=async(n,o)=>{n||(n={});try{const c=await o();c&&(n.Authorization=`Bearer ${c}`)}catch(c){console.error(c)}return n},X=n=>{n||(n={});const o="_csrf=",c="X-CSRF-TOKEN";try{let l=document.cookie.split(";").find(w=>w.includes(o));l&&!n[c]&&(l=l.trim().slice(o.length),n[c]=l)}catch(f){console.error(f)}return n};var P,V,A;let d=(A=(V=(P=globalThis==null?void 0:globalThis.AppConfig)==null?void 0:P.baseUrl)!=null?V:"")!=null?A:{}.VITE_API;d.endsWith("/")&&(d=d.slice(0,-1));const G=n=>(n.startsWith("/")&&(n=n.slice(1)),`${d}/api/v1/${n}`),J=n=>Object.keys(n!=null?n:{}).reduce((o,c)=>(o[c]=encodeURIComponent(encodeURIComponent(n[c])),o),{namespace:"",workflowId:"",runId:"",queue:""});function p(n,o,c=!0){c&&(o=J(o));const f={cluster:"/cluster",settings:"/settings",user:"/me",namespaces:"/namespaces","task-queue":`/namespaces/${o==null?void 0:o.namespace}/task-queues/${o==null?void 0:o.queue}`,workflows:`/namespaces/${o==null?void 0:o.namespace}/workflows`,"workflows.archived":`/namespaces/${o==null?void 0:o.namespace}/workflows/archived`,workflow:`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}`,"workflow.terminate":`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}/terminate`,"events.ascending":`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}/events`,"events.descending":`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}/events/reverse`,query:`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}/query`};return G(f[n])}export{p as a,h as b,r as c,B as h,j as i,K as n,z as r};
