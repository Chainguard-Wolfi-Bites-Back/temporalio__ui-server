var L=Object.defineProperty;var I=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable;var E=(t,r,s)=>r in t?L(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,i=(t,r)=>{for(var s in r||(r={}))R.call(r,s)&&E(t,s,r[s]);if(I)for(var s of I(r))g.call(r,s)&&E(t,s,r[s]);return t};import{g as S}from"./navigation-3f1ea447.js";import{w as v}from"./index-d28ebc24.js";import{n as f}from"./notifications-736aa513.js";import{i as m}from"./is-network-error-ac7c8caf.js";import{c as y}from"./route-for-46a9c4b7.js";const A=!0,O=v(null),q=t=>{if(C(t)&&A){S(y());return}if(U(t)){f.add("error",`${t.statusCode} ${t.statusText}`);return}if(m(t))throw f.add("error",`${t.statusCode} ${t.statusText}`),O.set(t),t;typeof t=="string"&&f.add("error",t),t instanceof Error&&f.add("error",t.message)},C=t=>m(t)?t.statusCode===401:!1,U=t=>m(t)?t.statusCode===403:!1,x=t=>typeof t=="function",F=(t,r)=>{const s=r instanceof URLSearchParams;return r&&!s&&(r=new URLSearchParams(r)),r?`${t}?${r}`:t},G=t=>t.message!==void 0&&typeof t.message=="string",b=async(t,r={},s=10)=>{const{params:n={},request:e=fetch,token:o,shouldRetry:k=!1,notifyOnError:p=!0,onError:w,retryInterval:$=5e3}=r;let{options:l}=r;const T=o?{next_page_token:o}:{},_=new URLSearchParams(i(i({},n),T)),P=F(t,_);try{l=N(l);const a=await e(P,l),u=await a.json(),{status:h,statusText:V}=a;if(!a.ok)if(w&&x(w))w({status:h,statusText:V,body:u});else throw{statusCode:a.status,statusText:a.statusText,response:a};return u}catch(a){if(p){if(q(a),k&&s>0)return new Promise(u=>{setTimeout(()=>{u(b(t,r,s-1))},$)})}else throw a}},N=t=>{const r=i({credentials:"include"},t);return r.headers=K(t==null?void 0:t.headers),r},K=t=>{t||(t={});const r="_csrf=",s="X-CSRF-TOKEN";try{let e=document.cookie.split(";").find(o=>o.includes(r));e&&!t[s]&&(e=e.trim().slice(r.length),t[s]=e)}catch(n){console.error(n)}return t};let c="";c.endsWith("/")&&(c=c.slice(0,-1));const D=t=>t.split("/").map(r=>encodeURIComponent(r)).join("/"),j=t=>(t.startsWith("/")&&(t=t.slice(1)),`${c}/api/v1/${D(t)}`);function J(t,r){const s=Object.keys(r!=null?r:{}).reduce((e,o)=>(e[o]=encodeURIComponent(r[o]),e),{namespace:"",workflowId:"",runId:"",queue:""}),n={cluster:"/cluster",settings:"/settings",user:"/me",namespaces:"/namespaces","task-queue":`/namespaces/${s==null?void 0:s.namespace}/task-queues/${s==null?void 0:s.queue}`,workflows:`/namespaces/${s==null?void 0:s.namespace}/workflows`,"workflows.archived":`/namespaces/${s==null?void 0:s.namespace}/workflows/archived`,workflow:`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}`,"workflow.terminate":`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}/terminate`,events:`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}/events`,"events.reverse":`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}/events/reverse`,query:`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}/query`};return j(n[t])}export{J as a,A as b,G as c,q as h,x as i,O as n,b as r};
