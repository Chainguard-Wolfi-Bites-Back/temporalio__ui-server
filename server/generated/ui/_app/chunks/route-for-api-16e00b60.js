var v=Object.defineProperty;var m=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var p=(t,r,s)=>r in t?v(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,i=(t,r)=>{for(var s in r||(r={}))L.call(r,s)&&p(t,s,r[s]);if(m)for(var s of m(r))R.call(r,s)&&p(t,s,r[s]);return t};import{w as S}from"./index-4613cb79.js";import{n as f}from"./notifications-4a537727.js";import{r as g}from"./route-for-f75b1f87.js";const y=!0,A=S(null);function I(t){const r=t;return(r==null?void 0:r.statusCode)!==void 0&&(r==null?void 0:r.statusText)!==void 0&&(r==null?void 0:r.response)!==void 0}const O=t=>{if(C(t)&&y){window.location.assign(g());return}if(q(t)){f.add("error",`${t.statusCode} ${t.statusText}`);return}if(I(t))throw f.add("error",`${t.statusCode} ${t.statusText}`),A.set(t),t;typeof t=="string"&&f.add("error",t),t instanceof Error&&f.add("error",t.message)},C=t=>I(t)?t.statusCode===401:!1,q=t=>I(t)?t.statusCode===403:!1,x=t=>typeof t=="function",U=(t,r)=>{const s=r instanceof URLSearchParams;return r&&!s&&(r=new URLSearchParams(r)),r?`${t}?${r}`:t},z=t=>t.message!==void 0&&typeof t.message=="string",F=async(t,r={},s=10)=>{const{params:n={},request:e=fetch,token:o,shouldRetry:E=!1,notifyOnError:T=!0,onError:l,retryInterval:$=5e3}=r;let{options:w}=r;const k=o?{next_page_token:o}:{},_=new URLSearchParams(i(i({},n),k)),P=U(t,_);try{w=b(w);const a=await e(P,w),u=await a.json(),{status:h,statusText:V}=a;if(!a.ok)if(l&&x(l))l({status:h,statusText:V,body:u});else throw{statusCode:a.status,statusText:a.statusText,response:a};return u}catch(a){if(T){if(O(a),E&&s>0)return new Promise(u=>{setTimeout(()=>{u(F(t,r,s-1))},$)})}else throw a}},b=t=>{const r=i({credentials:"include"},t);return r.headers=N(t==null?void 0:t.headers),r},N=t=>{t||(t={});const r="_csrf=",s="X-CSRF-TOKEN";try{let e=document.cookie.split(";").find(o=>o.includes(r));e&&!t[s]&&(e=e.trim().slice(r.length),t[s]=e)}catch(n){console.error(n)}return t};let c="";c.endsWith("/")&&(c=c.slice(0,-1));const K=t=>t.split("/").map(r=>encodeURIComponent(r)).join("/"),D=t=>(t.startsWith("/")&&(t=t.slice(1)),`${c}/api/v1/${K(t)}`);function H(t,r){const s=Object.keys(r!=null?r:{}).reduce((e,o)=>(e[o]=encodeURIComponent(r[o]),e),{namespace:"",workflowId:"",runId:"",queue:""}),n={cluster:"/cluster",settings:"/settings",user:"/me",namespaces:"/namespaces","task-queue":`/namespaces/${s==null?void 0:s.namespace}/task-queues/${s==null?void 0:s.queue}`,workflows:`/namespaces/${s==null?void 0:s.namespace}/workflows`,"workflows.archived":`/namespaces/${s==null?void 0:s.namespace}/workflows/archived`,workflow:`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}`,"workflow.terminate":`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}/terminate`,events:`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}/events`,"events.reverse":`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}/events/reverse`,query:`/namespaces/${s==null?void 0:s.namespace}/workflows/${s==null?void 0:s.workflowId}/runs/${s==null?void 0:s.runId}/query`};return D(n[t])}export{H as a,y as b,x as c,z as d,O as h,I as i,A as n,F as r};
