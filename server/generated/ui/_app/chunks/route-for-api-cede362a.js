var y=Object.defineProperty;var T=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var _=(n,o,s)=>o in n?y(n,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[o]=s,l=(n,o)=>{for(var s in o||(o={}))A.call(o,s)&&_(n,s,o[s]);if(T)for(var s of T(o))O.call(o,s)&&_(n,s,o[s]);return n};import{g as v}from"./navigation-093db9e2.js";import{D as q}from"./vendor-f1345faf.js";import{n as w}from"./notifications-c541b06b.js";import{i as k}from"./is-network-error-ac7c8caf.js";import{b as x}from"./route-for-c9edcdb4.js";const C=!0,U=q(null),F=n=>{if(b(n)&&C){v(x());return}if(N(n)){w.add("error",`${n.statusCode} ${n.statusText}`);return}if(k(n))throw w.add("error",`${n.statusCode} ${n.statusText}`),U.set(n),n;typeof n=="string"&&w.add("error",n),n instanceof Error&&w.add("error",n.message)},b=n=>k(n)?n.statusCode===401:!1,N=n=>k(n)?n.statusCode===403:!1,e=n=>typeof n=="function",D=(n,o)=>{const s=o instanceof URLSearchParams;return o&&!s&&(o=new URLSearchParams(o)),o?`${n}?${o}`:n},Y=n=>n.message!==void 0&&typeof n.message=="string",K=async(n,o={},s=10)=>{const{params:t={},request:i=fetch,token:u,shouldRetry:$=!1,notifyOnError:P=!0,onError:E,retryInterval:h=5e3}=o;let{options:I}=o;const V=u?{next_page_token:u}:{},L=new URLSearchParams(l(l({},t),V)),g=D(n,L);try{I=M(I);const c=await i(g,I),f=await c.json(),{status:R,statusText:S}=c;if(!c.ok)if(E&&e(E))E({status:R,statusText:S,body:f});else throw{statusCode:c.status,statusText:c.statusText,response:c};return f}catch(c){if(P){if(F(c),$&&s>0)return new Promise(f=>{setTimeout(()=>{f(K(n,o,s-1))},h)})}else throw c}},M=n=>{const o=l({credentials:"include"},n);return o.headers=j(n==null?void 0:n.headers),o},j=n=>{n||(n={});const o="_csrf=",s="X-CSRF-TOKEN";try{let i=document.cookie.split(";").find(u=>u.includes(o));i&&!n[s]&&(i=i.trim().slice(o.length),n[s]=i)}catch(t){console.error(t)}return n};let d="";d.endsWith("/")&&(d=d.slice(0,-1));const B=n=>n.split("/").map(o=>encodeURIComponent(o)).join("/"),W=n=>(n.startsWith("/")&&(n=n.slice(1)),`${d}/api/v1/${B(n)}`);function Z(n,o){const s={cluster:"/cluster",settings:"/settings",user:"/me",namespaces:"/namespaces","task-queue":`/namespaces/${o==null?void 0:o.namespace}/task-queues/${o==null?void 0:o.queue}`,workflows:`/namespaces/${o==null?void 0:o.namespace}/workflows`,"workflows.archived":`/namespaces/${o==null?void 0:o.namespace}/workflows/archived`,workflow:`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}`,"workflow.terminate":`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}/terminate`,events:`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}/events`,query:`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}/query`};return W(s[n])}export{Z as a,C as b,Y as c,F as h,e as i,U as n,K as r};
