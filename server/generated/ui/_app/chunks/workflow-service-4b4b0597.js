var P=Object.defineProperty,Q=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var E=(t,o,n)=>o in t?P(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,h=(t,o)=>{for(var n in o||(o={}))D.call(o,n)&&E(t,n,o[n]);if(T)for(var n of T(o))N.call(o,n)&&E(t,n,o[n]);return t},A=(t,o)=>Q(t,R(o));import{s as j}from"./simplify-attributes-018c5a8d.js";import{r as $,a as S}from"./route-for-api-2beb0b66.js";import{b as F,e as B,h as W,j as L}from"./to-duration-6d22e6d2.js";const O=(t=[])=>t.map(o=>{const n=j(o,!0),i=o.activityId;return A(h({},n),{id:i})}),C=t=>{var m,d,x,g,y,I;const o=t.workflowExecutionInfo.type.name,n=t.workflowExecutionInfo.execution.workflowId,i=t.workflowExecutionInfo.execution.runId,a=String(t.workflowExecutionInfo.startTime),s=String(t.workflowExecutionInfo.closeTime),r=t.workflowExecutionInfo.status,w=t.workflowExecutionInfo.status==="Running",l=t.workflowExecutionInfo.historyLength,k=`/workflows/${n}/${i}`,f=(d=(m=t==null?void 0:t.executionConfig)==null?void 0:m.taskQueue)==null?void 0:d.name,e=(x=t==null?void 0:t.workflowExecutionInfo)==null?void 0:x.parentNamespaceId,c=(g=t==null?void 0:t.workflowExecutionInfo)==null?void 0:g.parentExecution,u=t.workflowExecutionInfo.stateTransitionCount,b=(y=t.executionConfig)==null?void 0:y.defaultWorkflowTaskTimeout,q=O(t.pendingActivities),K=(I=t==null?void 0:t.pendingChildren)!=null?I:[];return{name:o,id:n,runId:i,startTime:a,endTime:s,status:r,historyEvents:l,url:k,taskQueue:f,pendingActivities:q,pendingChildren:K,parentNamespaceId:e,parent:c,stateTransitionCount:u,isRunning:w,defaultWorkflowTaskTimeout:b}},U=t=>(t.executions||[]).map(o=>C({workflowExecutionInfo:o})),V={workflowId:"WorkflowId",workflowType:"WorkflowType",timeRange:"StartTime",executionStatus:"ExecutionStatus",closeTime:"CloseTime"},z=["workflowId","workflowType","timeRange","executionStatus","closeTime"],G=t=>!(t===null||t===void 0||t===""||typeof t=="string"&&t==="undefined"),H=t=>{if(typeof t!="string")return!1;for(const o of z)if(o===t)return!0;return!1},J=(t,o,n)=>{const i=V[t];return o==="All"?"":F(o)||B(o)?n?`${i} > "${W(o)}"`:`${i} BETWEEN "${W(o)}" AND "${L()}"`:`${i}="${o}"`},M=(t,o)=>Object.entries(t).map(([n,i])=>{if(H(n)&&G(i))return J(n,i,o)}).filter(Boolean),X=(t,o=!1)=>M(t,o).join(" and "),Y=async(t,o,n=fetch,i=!1)=>{var f;const a=decodeURIComponent(o.query||X(o,i)),s=i?"workflows.archived":"workflows";let r="";const w=e=>{var c,u;return r=(u=(c=e==null?void 0:e.body)==null?void 0:c.message)!=null?u:`Error fetching workflows: ${e.status}: ${e.statusText}`},{executions:l,nextPageToken:k}=(f=await $(S(s,{namespace:t}),{params:{query:a},onError:w,request:n}))!=null?f:{executions:[],nextPageToken:""};return{workflows:U({executions:l}),nextPageToken:String(k),error:r}},tt=async(t,o,n=fetch)=>Y(t,o,n,!0);async function ot(t,o=fetch){return $(S("workflow",t),{request:o}).then(C)}export{Y as a,tt as b,ot as f,X as t};
