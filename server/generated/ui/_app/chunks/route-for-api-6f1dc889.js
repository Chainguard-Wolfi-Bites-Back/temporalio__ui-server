var x=Object.defineProperty;var $=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var t=(o,n,c)=>n in o?x(o,n,{enumerable:!0,configurable:!0,writable:!0,value:c}):o[n]=c,d=(o,n)=>{for(var c in n||(n={}))E.call(n,c)&&t(o,c,n[c]);if($)for(var c of $(n))F.call(n,c)&&t(o,c,n[c]);return o};import{d as I,e as P,t as R}from"./route-for-0fcfcb54.js";import{w as O}from"./index-de429506.js";import{n as L}from"./notifications-ed5cd8a8.js";import{i as k}from"./is-network-error-ac7c8caf.js";import{i as N}from"./is-function-b969a126.js";import{g as S}from"./get-api-origin-7e36d6d7.js";const _=O(null),z=(o,n=L,c=_,u=P)=>{if(B(o)&&u){window.location.assign(I());return}if(W(o)&&u){window.location.assign(I());return}if(k(o))throw n.add("error",`${o.statusCode} ${o.statusText}`),c.set(o),o;typeof o=="string"&&n.add("error",o),o instanceof Error&&n.add("error",o.message)},B=o=>k(o)?o.statusCode===401:!1,W=o=>k(o)?o.statusCode===403:!1,r=o=>o.message!==void 0&&typeof o.message=="string",j=async(o,n={},c=10)=>{var g;const{params:u={},request:f=fetch,token:w,shouldRetry:T=!1,notifyOnError:y=!0,onError:h,retryInterval:b=5e3}=n;let{options:s}=n;const v=w?{next_page_token:w}:{},A=new URLSearchParams(d(d({},u),v)),C=R(o,A);try{s=H(s),globalThis!=null&&globalThis.AccessToken&&(s.headers=await K(s==null?void 0:s.headers,globalThis.AccessToken));const i=await f(C,s),l=await i.json(),{status:q,statusText:U}=i;if(!i.ok)if(h&&N(h))h({status:q,statusText:U,body:l});else throw{statusCode:i.status,statusText:i.statusText,response:i,message:(g=l==null?void 0:l.message)!=null?g:i.statusText};return l}catch(i){if(y){if(z(i),T&&c>0)return new Promise(l=>{setTimeout(()=>{l(j(o,n,c-1))},b)})}else throw i}},H=o=>{const n=d({credentials:"include"},o);return n.headers=X(o==null?void 0:o.headers),n},K=async(o,n)=>{o||(o={});try{const c=await n();c&&(o.Authorization=`Bearer ${c}`)}catch(c){console.error(c)}return o},X=o=>{o||(o={});const n="_csrf=",c="X-CSRF-TOKEN";try{let f=document.cookie.split(";").find(w=>w.includes(n));f&&!o[c]&&(f=f.trim().slice(n.length),o[c]=f)}catch(u){console.error(u)}return o},D=(o,n)=>o.replace("%namespace%",n),G=o=>{var c;let n="";return((c=globalThis==null?void 0:globalThis.AppConfig)==null?void 0:c.apiUrl)&&o?n=D(globalThis.AppConfig.apiUrl,o):n=S(),n.endsWith("/")&&(n=n.slice(0,-1)),n},J=(o,n)=>(o.startsWith("/")&&(o=o.slice(1)),`${G(n)}/api/v1/${o}`),M=o=>Object.keys(o!=null?o:{}).reduce((n,c)=>(n[c]=encodeURIComponent(encodeURIComponent(o[c])),n),{namespace:"",workflowId:"",scheduleId:"",runId:"",queue:""});function a(o,n,c=!0){c&&(n=M(n));const u={cluster:"/cluster",settings:"/settings",user:"/me",namespaces:"/namespaces","task-queue":`/namespaces/${n==null?void 0:n.namespace}/task-queues/${n==null?void 0:n.queue}`,"search-attributes":"/search-attributes",workflows:`/namespaces/${n==null?void 0:n.namespace}/workflows`,"workflows.archived":`/namespaces/${n==null?void 0:n.namespace}/workflows/archived`,workflow:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}`,"workflow.terminate":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/terminate`,"events.ascending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/events`,"events.descending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/events/reverse`,query:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/query`,schedules:`/namespaces/${n==null?void 0:n.namespace}/schedules`,schedule:`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`,"schedule.delete":`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`};return J(u[o],n==null?void 0:n.namespace)}export{a,z as h,r as i,_ as n,j as r};
