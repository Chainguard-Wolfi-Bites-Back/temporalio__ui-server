var O=Object.defineProperty;var h=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var $=(o,n,c)=>n in o?O(o,n,{enumerable:!0,configurable:!0,writable:!0,value:c}):o[n]=c,d=(o,n)=>{for(var c in n||(n={}))S.call(n,c)&&$(o,c,n[c]);if(h)for(var c of h(n))C.call(n,c)&&$(o,c,n[c]);return o};import{b as t,e as g,t as U}from"./route-for-ef692dd7.js";import{w as b}from"./index-3bf0e4ad.js";import{n as k}from"./notifications-f1b2b7a1.js";import{i as E}from"./is-network-error-ac7c8caf.js";import{i as q}from"./is-function-b969a126.js";const x=b(null),F=o=>{if(N(o)&&t){window.location.assign(g());return}if(K(o)&&t){window.location.assign(g());return}if(E(o))throw k.add("error",`${o.statusCode} ${o.statusText}`),x.set(o),o;typeof o=="string"&&k.add("error",o),o instanceof Error&&k.add("error",o.message)},N=o=>E(o)?o.statusCode===401:!1,K=o=>E(o)?o.statusCode===403:!1,m=o=>o.message!==void 0&&typeof o.message=="string",B=async(o,n={},c=10)=>{var T;const{params:l={},request:f=fetch,token:w,shouldRetry:_=!1,notifyOnError:A=!0,onError:I,retryInterval:P=5e3}=n;let{options:s}=n;const V=w?{next_page_token:w}:{},v=new URLSearchParams(d(d({},l),V)),y=U(o,v);try{s=D(s),globalThis!=null&&globalThis.AccessToken&&(s.headers=await M(s==null?void 0:s.headers,globalThis.AccessToken));const i=await f(y,s),u=await i.json(),{status:L,statusText:R}=i;if(!i.ok)if(I&&q(I))I({status:L,statusText:R,body:u});else throw{statusCode:i.status,statusText:i.statusText,response:i,message:(T=u==null?void 0:u.message)!=null?T:i.statusText};return u}catch(i){if(A){if(F(i),_&&c>0)return new Promise(u=>{setTimeout(()=>{u(B(o,n,c-1))},P)})}else throw i}},D=o=>{const n=d({credentials:"include"},o);return n.headers=j(o==null?void 0:o.headers),n},M=async(o,n)=>{o||(o={});try{const c=await n();c&&(o.Authorization=`Bearer ${c}`)}catch(c){console.error(c)}return o},j=o=>{o||(o={});const n="_csrf=",c="X-CSRF-TOKEN";try{let f=document.cookie.split(";").find(w=>w.includes(n));f&&!o[c]&&(f=f.trim().slice(n.length),o[c]=f)}catch(l){console.error(l)}return o},z=(o,n)=>o.replace("%namespace%",n),W=o=>{var c;let n="";return((c=globalThis==null?void 0:globalThis.AppConfig)==null?void 0:c.apiUrl)&&o?n=z(globalThis.AppConfig.apiUrl,o):n="",n.endsWith("/")&&(n=n.slice(0,-1)),n},H=(o,n)=>(o.startsWith("/")&&(o=o.slice(1)),`${W(n)}/api/v1/${o}`),X=o=>Object.keys(o!=null?o:{}).reduce((n,c)=>(n[c]=encodeURIComponent(encodeURIComponent(o[c])),n),{namespace:"",workflowId:"",scheduleId:"",runId:"",queue:""});function p(o,n,c=!0){c&&(n=X(n));const l={cluster:"/cluster",settings:"/settings",user:"/me",namespaces:"/namespaces","task-queue":`/namespaces/${n==null?void 0:n.namespace}/task-queues/${n==null?void 0:n.queue}`,workflows:`/namespaces/${n==null?void 0:n.namespace}/workflows`,"workflows.archived":`/namespaces/${n==null?void 0:n.namespace}/workflows/archived`,workflow:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}`,"workflow.terminate":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/terminate`,"events.ascending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/events`,"events.descending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/events/reverse`,query:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/query`,schedules:`/namespaces/${n==null?void 0:n.namespace}/schedules`,schedule:`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`,"schedule.delete":`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`};return H(l[o],n==null?void 0:n.namespace)}export{p as a,F as h,m as i,x as n,B as r};
