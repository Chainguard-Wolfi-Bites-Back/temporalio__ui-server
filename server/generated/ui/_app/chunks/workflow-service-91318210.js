var F=Object.defineProperty,K=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var h=(t,o,n)=>o in t?F(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,A=(t,o)=>{for(var n in o||(o={}))Q.call(o,n)&&h(t,n,o[n]);if(I)for(var n of I(o))R.call(o,n)&&h(t,n,o[n]);return t},W=(t,o)=>K(t,P(o));import{X as N}from"./index-68c8bf39.js";import{s as j}from"./settings-e5e19f0d.js";import{s as B}from"./simplify-attributes-018c5a8d.js";import{r as b,a as S,h as L}from"./route-for-api-74aac662.js";import{b as O,e as U,h as $,j as _}from"./to-duration-6d22e6d2.js";const z=(t=j)=>!N(t).disableWriteActions,V=(t=[])=>t.map(o=>{const n=B(o,!0),e=o.activityId;return W(A({},n),{id:e})}),C=t=>{var m,x,g,y,E,T;const o=t.workflowExecutionInfo.type.name,n=t.workflowExecutionInfo.execution.workflowId,e=t.workflowExecutionInfo.execution.runId,a=String(t.workflowExecutionInfo.startTime),l=String(t.workflowExecutionInfo.closeTime),r=t.workflowExecutionInfo.status,f=t.workflowExecutionInfo.status==="Running",w=t.workflowExecutionInfo.historyLength,d=`/workflows/${n}/${e}`,k=(x=(m=t==null?void 0:t.executionConfig)==null?void 0:m.taskQueue)==null?void 0:x.name,c=(g=t==null?void 0:t.workflowExecutionInfo)==null?void 0:g.parentNamespaceId,i=(y=t==null?void 0:t.workflowExecutionInfo)==null?void 0:y.parentExecution,u=t.workflowExecutionInfo.stateTransitionCount,s=(E=t.executionConfig)==null?void 0:E.defaultWorkflowTaskTimeout,D=V(t.pendingActivities),q=(T=t==null?void 0:t.pendingChildren)!=null?T:[];return{name:o,id:n,runId:e,startTime:a,endTime:l,status:r,historyEvents:w,url:d,taskQueue:k,pendingActivities:D,pendingChildren:q,parentNamespaceId:c,parent:i,stateTransitionCount:u,isRunning:f,defaultWorkflowTaskTimeout:s,get canBeTerminated(){return f&&z()}}},X=t=>(t.executions||[]).map(o=>C({workflowExecutionInfo:o})),G={workflowId:"WorkflowId",workflowType:"WorkflowType",timeRange:"StartTime",executionStatus:"ExecutionStatus",closeTime:"CloseTime"},H=["workflowId","workflowType","timeRange","executionStatus","closeTime"],J=t=>!(t===null||t===void 0||t===""||typeof t=="string"&&t==="undefined"),M=t=>{if(typeof t!="string")return!1;for(const o of H)if(o===t)return!0;return!1},Y=(t,o,n)=>{const e=G[t];return o==="All"?"":O(o)||U(o)?n?`${e} > "${$(o)}"`:`${e} BETWEEN "${$(o)}" AND "${_()}"`:`${e}="${o}"`},Z=(t,o)=>Object.entries(t).map(([n,e])=>{if(M(n)&&J(e))return Y(n,e,o)}).filter(Boolean),p=(t,o=!1)=>Z(t,o).join(" and "),v=async(t,o,n=fetch,e=!1)=>{var c;const a=decodeURIComponent(o.query||p(o,e)),l=e?"workflows.archived":"workflows";let r="";const f=i=>{var u,s;L(i),r=(s=(u=i==null?void 0:i.body)==null?void 0:u.message)!=null?s:`Error fetching workflows: ${i.status}: ${i.statusText}`},w=i=>{r="Failed to fetch workflows"},{executions:d,nextPageToken:k}=(c=await b(S(l,{namespace:t}),{params:{query:a},onError:f,handleError:w,request:n}))!=null?c:{executions:[],nextPageToken:""};return{workflows:X({executions:d}),nextPageToken:String(k),error:r}},ft=async(t,o,n=fetch)=>v(t,o,n,!0);async function ct(t,o=fetch){return b(S("workflow",t),{request:o}).then(C)}export{v as a,ft as b,ct as f,p as t};
