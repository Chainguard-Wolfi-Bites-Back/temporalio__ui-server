import{S as _,i as $,s as y,e as h,k as g,w as S,c as b,m as w,x as E,b as p,g as u,y as x,N as C,q as F,o as I,d as f,B as N,t as k,h as B}from"./index-f021a159.js";import{c as J}from"./route-for-d606e623.js";import{g as O}from"./navigation-3f1ea447.js";import{B as T}from"./button-e39678dd.js";import{t as q}from"./index-04d70d1c.js";import{n as v}from"./notifications-0558c095.js";import{i as G,a as j}from"./import-events-77fdb763.js";import{g as A}from"./index.es-3049caa8.js";function H(l){let e;return{c(){e=k("Import")},l(n){e=B(n,"Import")},m(n,o){u(n,e,o)},d(n){n&&f(e)}}}function P(l){let e,n,o,s,a,i;return o=new T({props:{icon:A,$$slots:{default:[H]},$$scope:{ctx:l}}}),o.$on("click",l[1]),{c(){e=h("input"),n=g(),S(o.$$.fragment),this.h()},l(t){e=b(t,"INPUT",{class:!0,type:!0,accept:!0}),n=w(t),E(o.$$.fragment,t),this.h()},h(){p(e,"class","import-input block border border-gray-200 rounded-md p-2"),p(e,"type","file"),p(e,"accept",".json")},m(t,r){u(t,e,r),u(t,n,r),x(o,t,r),s=!0,a||(i=C(e,"change",l[0]),a=!0)},p(t,[r]){const c={};r&8&&(c.$$scope={dirty:r,ctx:t}),o.$set(c)},i(t){s||(F(o.$$.fragment,t),s=!0)},o(t){I(o.$$.fragment,t),s=!1},d(t){t&&f(e),t&&f(n),N(o,t),a=!1,i()}}}function R(l){let e;return[async s=>{var a;const i=s.target,t=(a=i==null?void 0:i.files)===null||a===void 0?void 0:a[0],r=new FileReader;t&&(r.readAsText(t),r.onload=()=>{var c,m;try{const d=(m=(c=r==null?void 0:r.result)===null||c===void 0?void 0:c.toString())!==null&&m!==void 0?m:"";e=JSON.parse(d)}catch{v.add("error","Could not parse JSON")}})},async()=>{var s;try{const{events:a,eventGroups:i}=await q((s=e==null?void 0:e.events)!==null&&s!==void 0?s:e);G.set(a),j.set(i);const t=J({importType:"events",view:"summary"});O(t)}catch{v.add("error","Could not create event history from JSON")}}]}class W extends _{constructor(e){super(),$(this,e,R,P,y,{})}}export{W as E};
