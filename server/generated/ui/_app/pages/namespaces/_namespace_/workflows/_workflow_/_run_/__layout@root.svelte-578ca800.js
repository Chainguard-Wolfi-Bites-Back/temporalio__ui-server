var Le=Object.defineProperty;var Te=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var Ae=(s,e,r)=>e in s?Le(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r,pe=(s,e)=>{for(var r in e||(e={}))Oe.call(e,r)&&Ae(s,r,e[r]);if(Te)for(var r of Te(e))Ue.call(e,r)&&Ae(s,r,e[r]);return s};import{S as X,i as Y,s as Z,I as de,e as h,c as $,a as v,d as c,g as A,J as we,K as _e,L as he,q as d,a4 as Je,a5 as Qe,o as w,a6 as Ke,w as y,k as P,x as I,m as C,y as E,B as T,l as Se,n as qe,p as He,t as F,h as V,b as p,M as m,E as ae,ab as We,T as ze,R as Ne,N as ee,C as Pe,V as Ce,j as se}from"../../../../../../chunks/index-604742bf.js";import{p as Me}from"../../../../../../chunks/stores-810822a9.js";import{l as Ge,w as Xe}from"../../../../../../chunks/workflow-run-bcdc6517.js";import{f as Re}from"../../../../../../chunks/index-69aa65a3.js";import{I as Ye}from"../../../../../../chunks/index-0574ae1f.js";import{e as Ze}from"../../../../../../chunks/event-view-963ec0ce.js";import{w as xe}from"../../../../../../chunks/workflows-4d4c08bf.js";import{t as et}from"../../../../../../chunks/workflow-service-0772831a.js";import{e as Fe,f as tt,g as nt,h as rt,i as at,j as Ve}from"../../../../../../chunks/route-for-1f2060cd.js";import{W as st}from"../../../../../../chunks/workflow-status-0cab7465.js";import{r as ot,a as lt,h as ft}from"../../../../../../chunks/route-for-api-42a67309.js";import{n as it}from"../../../../../../chunks/notifications-cfed8e58.js";import{B as Be}from"../../../../../../chunks/button-8619b7a4.js";import{M as ut}from"../../../../../../chunks/modal-c39b98de.js";import{f as ct}from"../../../../../../chunks/events-service-0a8b10d0.js";import"../../../../../../chunks/index-c9e619a8.js";import"../../../../../../chunks/with-loading-22689bcc.js";import"../../../../../../chunks/persist-store-26f405dd.js";import"../../../../../../chunks/simplify-attributes-64d6cf1a.js";import"../../../../../../chunks/format-date-919f4714.js";import"../../../../../../chunks/to-duration-271d3946.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";import"../../../../../../chunks/index-e3391e94.js";import"../../../../../../chunks/is-http-24b20bf9.js";import"../../../../../../chunks/data-converter-config-6fc5efe1.js";import"../../../../../../chunks/atob-eb4fc9a1.js";import"../../../../../../chunks/get-event-categorization-8a63628f.js";function mt(s){let e,r,t,a;const n=s[1].default,o=de(n,s,s[0],null);return{c(){e=h("div"),o&&o.c()},l(l){e=$(l,"DIV",{});var f=v(e);o&&o.l(f),f.forEach(c)},m(l,f){A(l,e,f),o&&o.m(e,null),a=!0},p(l,[f]){o&&o.p&&(!a||f&1)&&we(o,n,l,l[0],a?he(n,l[0],f,null):_e(l[0]),null)},i(l){a||(d(o,l),Je(()=>{t&&t.end(1),r=Qe(e,Re,{y:-50,duration:250,delay:250}),r.start()}),a=!0)},o(l){w(o,l),r&&r.invalidate(),t=Ke(e,Re,{y:-50,duration:250}),a=!1},d(l){l&&c(e),o&&o.d(l),l&&t&&t.end()}}}function pt(s,e,r){let{$$slots:t={},$$scope:a}=e;return s.$$set=n=>{"$$scope"in n&&r(0,a=n.$$scope)},[a,t]}class dt extends X{constructor(e){super(),Y(this,e,pt,mt,Z,{})}}async function wt({workflow:s,namespace:e,reason:r}){return await ot(lt("workflow.terminate",{namespace:e,workflowId:s.id,runId:s.runId}),{options:{method:"POST",body:JSON.stringify({reason:r})},shouldRetry:!1})}function je(s){let e,r,t,a;return e=new Be({props:{destroy:!0,$$slots:{default:[_t]},$$scope:{ctx:s}}}),e.$on("click",s[3]),t=new ut({props:{open:s[2],confirmText:"Terminate",$$slots:{content:[$t],title:[ht]},$$scope:{ctx:s}}}),t.$on("cancelModal",s[4]),t.$on("confirmModal",s[6]),{c(){y(e.$$.fragment),r=P(),y(t.$$.fragment)},l(n){I(e.$$.fragment,n),r=C(n),I(t.$$.fragment,n)},m(n,o){E(e,n,o),A(n,r,o),E(t,n,o),a=!0},p(n,o){const l={};o&1024&&(l.$$scope={dirty:o,ctx:n}),e.$set(l);const f={};o&4&&(f.open=n[2]),o&1026&&(f.$$scope={dirty:o,ctx:n}),t.$set(f)},i(n){a||(d(e.$$.fragment,n),d(t.$$.fragment,n),a=!0)},o(n){w(e.$$.fragment,n),w(t.$$.fragment,n),a=!1},d(n){T(e,n),n&&c(r),T(t,n)}}}function _t(s){let e;return{c(){e=F("Terminate")},l(r){e=V(r,"Terminate")},m(r,t){A(r,e,t)},d(r){r&&c(e)}}}function ht(s){let e,r;return{c(){e=h("h3"),r=F("Terminate Workflow"),this.h()},l(t){e=$(t,"H3",{slot:!0});var a=v(e);r=V(a,"Terminate Workflow"),a.forEach(c),this.h()},h(){p(e,"slot","title")},m(t,a){A(t,e,a),m(e,r)},p:ae,d(t){t&&c(e)}}}function $t(s){let e,r,t,a,n,o,l;return{c(){e=h("div"),r=h("p"),t=F(`Are you sure you want to terminate this workflow? This action cannot be
        undone.`),a=P(),n=h("input"),this.h()},l(f){e=$(f,"DIV",{slot:!0});var u=v(e);r=$(u,"P",{});var g=v(r);t=V(g,`Are you sure you want to terminate this workflow? This action cannot be
        undone.`),g.forEach(c),a=C(u),n=$(u,"INPUT",{class:!0,placeholder:!0}),u.forEach(c),this.h()},h(){p(n,"class","mt-4 block w-full rounded-md border border-gray-200 p-2"),p(n,"placeholder","Enter a reason"),p(e,"slot","content")},m(f,u){A(f,e,u),m(e,r),m(r,t),m(e,a),m(e,n),We(n,s[1]),o||(l=ze(n,"input",s[8]),o=!0)},p(f,u){u&2&&n.value!==f[1]&&We(n,f[1])},d(f){f&&c(e),o=!1,l()}}}function gt(s){let e=s[5](s[0]),r,t,a=e&&je(s);return{c(){a&&a.c(),r=Se()},l(n){a&&a.l(n),r=Se()},m(n,o){a&&a.m(n,o),A(n,r,o),t=!0},p(n,[o]){o&1&&(e=n[5](n[0])),e?a?(a.p(n,o),o&1&&d(a,1)):(a=je(n),a.c(),d(a,1),a.m(r.parentNode,r)):a&&(qe(),w(a,1,1,()=>{a=null}),He())},i(n){t||(d(a),t=!0)},o(n){w(a),t=!1},d(n){a&&a.d(n),n&&c(r)}}}function kt(s,e,r){let{workflow:t}=e,{namespace:a}=e,n="",o=!1;const l=()=>r(2,o=!0),f=()=>r(2,o=!1),u=k=>String(k.status)==="Running",g=()=>{r(2,o=!1),r(1,n=""),it.add("success","Workflow Terminated"),window.location.reload()},S=()=>{wt({workflow:t,namespace:a,reason:n}).then(g).catch(ft)};function _(){n=this.value,r(1,n)}return s.$$set=k=>{"workflow"in k&&r(0,t=k.workflow),"namespace"in k&&r(7,a=k.namespace)},[t,n,o,l,f,u,S,a,_]}class bt extends X{constructor(e){super(),Y(this,e,kt,gt,Z,{workflow:0,namespace:7})}}function vt(s){let e,r;return{c(){e=h("span"),r=F("Download"),this.h()},l(t){e=$(t,"SPAN",{class:!0});var a=v(e);r=V(a,"Download"),a.forEach(c),this.h()},h(){p(e,"class","hidden md:inline")},m(t,a){A(t,e,a),m(e,r)},p:ae,d(t){t&&c(e)}}}function yt(s){let e,r;return e=new Be({props:{secondary:!0,icon:"download",$$slots:{default:[vt]},$$scope:{ctx:s}}}),e.$on("click",s[0]),{c(){y(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,a){E(e,t,a),r=!0},p(t,[a]){const n={};a&16&&(n.$$scope={dirty:a,ctx:t}),e.$set(n)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){w(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function It(s,e,r){let{namespace:t}=e,{workflowId:a}=e,{runId:n}=e;const o=async()=>{const l=await ct({namespace:t,workflowId:a,runId:n}),f=JSON.stringify({events:l},null,2);u(f,`${n}/events.json`,"text/plain");function u(g,S,_){const k=document.createElement("a"),O=new Blob([g],{type:_});k.href=URL.createObjectURL(O),k.download=S,k.click()}};return s.$$set=l=>{"namespace"in l&&r(1,t=l.namespace),"workflowId"in l&&r(2,a=l.workflowId),"runId"in l&&r(3,n=l.runId)},[o,t,a,n]}class Et extends X{constructor(e){super(),Y(this,e,It,yt,Z,{namespace:1,workflowId:2,runId:3})}}function Tt(s){let e;return{c(){e=F(s[1])},l(r){e=V(r,s[1])},m(r,t){A(r,e,t)},p(r,t){t&2&&se(e,r[1])},d(r){r&&c(e)}}}function At(s){let e,r,t,a;return{c(){e=F(s[1]),r=P(),t=h("span"),a=F(s[2]),this.h()},l(n){e=V(n,s[1]),r=C(n),t=$(n,"SPAN",{class:!0});var o=v(t);a=V(o,s[2]),o.forEach(c),this.h()},h(){p(t,"class","rounded-sm bg-blue-100 px-2 text-blue-700")},m(n,o){A(n,e,o),A(n,r,o),A(n,t,o),m(t,a)},p(n,o){o&2&&se(e,n[1]),o&4&&se(a,n[2])},d(n){n&&c(e),n&&c(r),n&&c(t)}}}function St(s){let e,r;function t(o,l){return o[2]||o[2]===0?At:Tt}let a=t(s),n=a(s);return{c(){e=h("a"),n.c(),this.h()},l(o){e=$(o,"A",{class:!0,href:!0,"data-cy":!0});var l=v(e);n.l(l),l.forEach(c),this.h()},h(){p(e,"class","block whitespace-nowrap text-sm md:text-base svelte-sf1jtj"),p(e,"href",s[0]),p(e,"data-cy",r=s[4].dataCy),Ne(e,"active",s[3])},m(o,l){A(o,e,l),n.m(e,null)},p(o,[l]){a===(a=t(o))&&n?n.p(o,l):(n.d(1),n=a(o),n&&(n.c(),n.m(e,null))),l&1&&p(e,"href",o[0]),l&16&&r!==(r=o[4].dataCy)&&p(e,"data-cy",r),l&8&&Ne(e,"active",o[3])},i:ae,o:ae,d(o){o&&c(e),n.d()}}}function Wt(s,e,r){let t,a;ee(s,Me,f=>r(5,a=f));let{href:n}=e,{label:o}=e,{amount:l=null}=e;return s.$$set=f=>{r(4,e=Pe(Pe({},e),Ce(f))),"href"in f&&r(0,n=f.href),"label"in f&&r(1,o=f.label),"amount"in f&&r(2,l=f.amount)},s.$$.update=()=>{s.$$.dirty&33&&r(3,t=a.url.pathname.includes(n))},e=Ce(e),[n,o,l,t,e,a]}class ne extends X{constructor(e){super(),Y(this,e,Wt,St,Z,{href:0,label:1,amount:2})}}function Nt(s){var $e,ge,ke,be,ve;let e,r,t,a,n,o,l,f,u,g,S,_,k,O=s[1].id+"",re,oe,j,D,le,q,fe,W,H,ie,M,ue,B,ce,U,me,J,x;return n=new Ye({props:{scale:.8,name:"caretLeft",class:"inline"}}),S=new st({props:{status:($e=s[1])==null?void 0:$e.status}}),D=new Et({props:{namespace:s[0],workflowId:s[1].id,runId:s[1].runId}}),q=new bt({props:{workflow:s[1],namespace:s[0]}}),H=new ne({props:{label:"History",href:Fe(pe({view:s[3]},s[4])),amount:(ge=s[1])==null?void 0:ge.historyEvents,dataCy:"history-tab"}}),M=new ne({props:{label:"Workers",href:tt(s[4]),amount:(be=(ke=s[2])==null?void 0:ke.pollers)==null?void 0:be.length,dataCy:"workers-tab"}}),B=new ne({props:{label:"Pending Activities",href:nt(s[4]),amount:(ve=s[1].pendingActivities)==null?void 0:ve.length,dataCy:"pending-activities-tab"}}),U=new ne({props:{label:"Stack Trace",href:rt(s[4]),dataCy:"stack-trace-tab"}}),J=new ne({props:{label:"Queries",href:at(s[4]),dataCy:"queries-tab"}}),{c(){e=h("header"),r=h("main"),t=h("div"),a=h("a"),y(n.$$.fragment),o=F("Back to Workflows"),f=P(),u=h("div"),g=h("h1"),y(S.$$.fragment),_=P(),k=h("span"),re=F(O),oe=P(),j=h("div"),y(D.$$.fragment),le=P(),y(q.$$.fragment),fe=P(),W=h("nav"),y(H.$$.fragment),ie=P(),y(M.$$.fragment),ue=P(),y(B.$$.fragment),ce=P(),y(U.$$.fragment),me=P(),y(J.$$.fragment),this.h()},l(i){e=$(i,"HEADER",{class:!0});var b=v(e);r=$(b,"MAIN",{class:!0});var R=v(r);t=$(R,"DIV",{class:!0});var Q=v(t);a=$(Q,"A",{href:!0,"data-cy":!0,class:!0});var K=v(a);I(n.$$.fragment,K),o=V(K,"Back to Workflows"),K.forEach(c),Q.forEach(c),f=C(R),u=$(R,"DIV",{class:!0});var L=v(u);g=$(L,"H1",{class:!0});var z=v(g);I(S.$$.fragment,z),_=C(z),k=$(z,"SPAN",{class:!0});var te=v(k);re=V(te,O),te.forEach(c),z.forEach(c),oe=C(L),j=$(L,"DIV",{class:!0});var G=v(j);I(D.$$.fragment,G),le=C(G),I(q.$$.fragment,G),G.forEach(c),L.forEach(c),fe=C(R),W=$(R,"NAV",{class:!0});var N=v(W);I(H.$$.fragment,N),ie=C(N),I(M.$$.fragment,N),ue=C(N),I(B.$$.fragment,N),ce=C(N),I(U.$$.fragment,N),me=C(N),I(J.$$.fragment,N),N.forEach(c),R.forEach(c),b.forEach(c),this.h()},h(){p(a,"href",l=`/namespaces/${s[0]}/workflows?query=${Ve(s[6])}&search=${s[5]}`),p(a,"data-cy","back-to-workflows"),p(a,"class","back-to-workflows svelte-st9g8m"),p(t,"class","-mt-3 -ml-2 block"),p(k,"class","select-all font-medium"),p(g,"class","relative flex items-center gap-4 text-2xl"),p(j,"class","ml-8 flex items-center justify-end gap-4"),p(u,"class","mb-8 flex items-center justify-between"),p(W,"class","flex flex-wrap gap-6"),p(r,"class","relative flex flex-col gap-1"),p(e,"class","flex flex-col gap-4")},m(i,b){A(i,e,b),m(e,r),m(r,t),m(t,a),E(n,a,null),m(a,o),m(r,f),m(r,u),m(u,g),E(S,g,null),m(g,_),m(g,k),m(k,re),m(u,oe),m(u,j),E(D,j,null),m(j,le),E(q,j,null),m(r,fe),m(r,W),E(H,W,null),m(W,ie),E(M,W,null),m(W,ue),E(B,W,null),m(W,ce),E(U,W,null),m(W,me),E(J,W,null),x=!0},p(i,[b]){var G,N,ye,Ie,Ee;(!x||b&1&&l!==(l=`/namespaces/${i[0]}/workflows?query=${Ve(i[6])}&search=${i[5]}`))&&p(a,"href",l);const R={};b&2&&(R.status=(G=i[1])==null?void 0:G.status),S.$set(R),(!x||b&2)&&O!==(O=i[1].id+"")&&se(re,O);const Q={};b&1&&(Q.namespace=i[0]),b&2&&(Q.workflowId=i[1].id),b&2&&(Q.runId=i[1].runId),D.$set(Q);const K={};b&2&&(K.workflow=i[1]),b&1&&(K.namespace=i[0]),q.$set(K);const L={};b&8&&(L.href=Fe(pe({view:i[3]},i[4]))),b&2&&(L.amount=(N=i[1])==null?void 0:N.historyEvents),H.$set(L);const z={};b&4&&(z.amount=(Ie=(ye=i[2])==null?void 0:ye.pollers)==null?void 0:Ie.length),M.$set(z);const te={};b&2&&(te.amount=(Ee=i[1].pendingActivities)==null?void 0:Ee.length),B.$set(te)},i(i){x||(d(n.$$.fragment,i),d(S.$$.fragment,i),d(D.$$.fragment,i),d(q.$$.fragment,i),d(H.$$.fragment,i),d(M.$$.fragment,i),d(B.$$.fragment,i),d(U.$$.fragment,i),d(J.$$.fragment,i),x=!0)},o(i){w(n.$$.fragment,i),w(S.$$.fragment,i),w(D.$$.fragment,i),w(q.$$.fragment,i),w(H.$$.fragment,i),w(M.$$.fragment,i),w(B.$$.fragment,i),w(U.$$.fragment,i),w(J.$$.fragment,i),x=!1},d(i){i&&c(e),T(n),T(S),T(D),T(q),T(H),T(M),T(B),T(U),T(J)}}}function Pt(s,e,r){let t,a;ee(s,xe,_=>r(7,t=_)),ee(s,Ze,_=>r(3,a=_));let{namespace:n}=e,{workflow:o}=e,{workers:l}=e;const f={namespace:n,workflow:o.id,run:o.runId},{parameters:u,searchType:g}=t,S=et(u);return s.$$set=_=>{"namespace"in _&&r(0,n=_.namespace),"workflow"in _&&r(1,o=_.workflow),"workers"in _&&r(2,l=_.workers)},[n,o,l,a,f,g,S]}class Ct extends X{constructor(e){super(),Y(this,e,Pt,Nt,Z,{namespace:0,workflow:1,workers:2})}}function De(s){let e,r,t;e=new Ct({props:{namespace:s[2],workflow:s[1].workflow,workers:s[1].workers}});const a=s[3].default,n=de(a,s,s[4],null);return{c(){y(e.$$.fragment),r=P(),n&&n.c()},l(o){I(e.$$.fragment,o),r=C(o),n&&n.l(o)},m(o,l){E(e,o,l),A(o,r,l),n&&n.m(o,l),t=!0},p(o,l){const f={};l&2&&(f.workflow=o[1].workflow),l&2&&(f.workers=o[1].workers),e.$set(f),n&&n.p&&(!t||l&16)&&we(n,a,o,o[4],t?he(a,o[4],l,null):_e(o[4]),null)},i(o){t||(d(e.$$.fragment,o),d(n,o),t=!0)},o(o){w(e.$$.fragment,o),w(n,o),t=!1},d(o){T(e,o),o&&c(r),n&&n.d(o)}}}function Rt(s){let e,r,t=!s[0]&&De(s);return{c(){e=h("main"),t&&t.c(),this.h()},l(a){e=$(a,"MAIN",{class:!0});var n=v(e);t&&t.l(n),n.forEach(c),this.h()},h(){p(e,"class","flex h-full flex-col gap-6")},m(a,n){A(a,e,n),t&&t.m(e,null),r=!0},p(a,n){a[0]?t&&(qe(),w(t,1,1,()=>{t=null}),He()):t?(t.p(a,n),n&1&&d(t,1)):(t=De(a),t.c(),d(t,1),t.m(e,null))},i(a){r||(d(t),r=!0)},o(a){w(t),r=!1},d(a){a&&c(e),t&&t.d()}}}function Ft(s){let e,r;return e=new dt({props:{$$slots:{default:[Rt]},$$scope:{ctx:s}}}),{c(){y(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,a){E(e,t,a),r=!0},p(t,[a]){const n={};a&19&&(n.$$scope={dirty:a,ctx:t}),e.$set(n)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){w(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function Vt(s,e,r){let t,a,n;ee(s,Me,u=>r(5,t=u)),ee(s,Ge,u=>r(0,a=u)),ee(s,Xe,u=>r(1,n=u));let{$$slots:o={},$$scope:l}=e;const{namespace:f}=t.params;return s.$$set=u=>{"$$scope"in u&&r(4,l=u.$$scope)},[a,n,f,o,l]}class jt extends X{constructor(e){super(),Y(this,e,Vt,Ft,Z,{})}}function Dt(s){let e;const r=s[0].default,t=de(r,s,s[1],null);return{c(){t&&t.c()},l(a){t&&t.l(a)},m(a,n){t&&t.m(a,n),e=!0},p(a,n){t&&t.p&&(!e||n&2)&&we(t,r,a,a[1],e?he(r,a[1],n,null):_e(a[1]),null)},i(a){e||(d(t,a),e=!0)},o(a){w(t,a),e=!1},d(a){t&&t.d(a)}}}function qt(s){let e,r;return e=new jt({props:{$$slots:{default:[Dt]},$$scope:{ctx:s}}}),{c(){y(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,a){E(e,t,a),r=!0},p(t,[a]){const n={};a&2&&(n.$$scope={dirty:a,ctx:t}),e.$set(n)},i(t){r||(d(e.$$.fragment,t),r=!0)},o(t){w(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function Ht(s,e,r){let{$$slots:t={},$$scope:a}=e;return s.$$set=n=>{"$$scope"in n&&r(1,a=n.$$scope)},[t,a]}class wn extends X{constructor(e){super(),Y(this,e,Ht,qt,Z,{})}}export{wn as default};
