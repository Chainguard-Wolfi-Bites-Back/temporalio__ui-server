var Be=Object.defineProperty;var Te=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var Ae=(o,e,r)=>e in o?Be(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r,pe=(o,e)=>{for(var r in e||(e={}))Oe.call(e,r)&&Ae(o,r,e[r]);if(Te)for(var r of Te(e))Ue.call(e,r)&&Ae(o,r,e[r]);return o};import{S as Y,i as Z,s as x,I as de,e as g,c as $,a as v,d as m,g as A,J as we,K as _e,L as he,q as w,a3 as Je,a4 as Qe,o as _,a5 as ze,w as y,k as P,x as E,m as j,y as I,B as T,l as Se,n as qe,p as He,t as R,h as D,b as d,M as p,E as ne,aa as We,T as Ke,R as Ne,N as X,C as Pe,V as je,j as oe,am as Ge,a8 as Xe}from"../../../../../../chunks/index-a913e400.js";import{p as Le}from"../../../../../../chunks/stores-34c141af.js";import{l as Ye,w as Ze}from"../../../../../../chunks/workflow-run-adb8109a.js";import{t as Ce}from"../../../../../../chunks/events-c2052fde.js";import{f as Re}from"../../../../../../chunks/index-3e3c0d77.js";import{I as xe}from"../../../../../../chunks/index-4d222e66.js";import{e as et}from"../../../../../../chunks/event-view-6715ec5f.js";import{w as tt}from"../../../../../../chunks/workflows-6ca62795.js";import{t as rt}from"../../../../../../chunks/workflow-service-0b078d47.js";import{g as De,h as nt,i as at,j as ot,k as st,l as Fe}from"../../../../../../chunks/route-for-0fcfcb54.js";import{W as lt}from"../../../../../../chunks/workflow-status-f5cdf54b.js";import{r as ft,a as it,h as ut}from"../../../../../../chunks/route-for-api-6f1dc889.js";import{n as ct}from"../../../../../../chunks/notifications-ed5cd8a8.js";import{B as Me}from"../../../../../../chunks/button-e3d7b1cd.js";import{M as mt}from"../../../../../../chunks/modal-34d46654.js";import{f as pt}from"../../../../../../chunks/events-service-4ceb5e60.js";import{L as dt}from"../../../../../../chunks/loading-573a3dcd.js";import"../../../../../../chunks/index-de429506.js";import"../../../../../../chunks/with-loading-22689bcc.js";import"../../../../../../chunks/pollers-service-cc2befa2.js";import"../../../../../../chunks/index-d27505fa.js";import"../../../../../../chunks/has-b7e06397.js";import"../../../../../../chunks/is-419a79e8.js";import"../../../../../../chunks/persist-store-1373753b.js";import"../../../../../../chunks/is-function-b969a126.js";import"../../../../../../chunks/settings-5a9aaf0a.js";import"../../../../../../chunks/version-check-b520d17f.js";import"../../../../../../chunks/simplify-attributes-018c5a8d.js";import"../../../../../../chunks/format-date-ecf4453c.js";import"../../../../../../chunks/to-duration-6d22e6d2.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";import"../../../../../../chunks/get-api-origin-7e36d6d7.js";import"../../../../../../chunks/badge-5aadb1e2.js";import"../../../../../../chunks/index-9bd1f67e.js";import"../../../../../../chunks/is-http-c467dd4a.js";import"../../../../../../chunks/data-converter-config-7122577a.js";import"../../../../../../chunks/atob-009c70e1.js";import"../../../../../../chunks/get-event-categorization-754b07cc.js";function wt(o){let e,r,t,a;const n=o[1].default,s=de(n,o,o[0],null);return{c(){e=g("div"),s&&s.c()},l(l){e=$(l,"DIV",{});var f=v(e);s&&s.l(f),f.forEach(m)},m(l,f){A(l,e,f),s&&s.m(e,null),a=!0},p(l,[f]){s&&s.p&&(!a||f&1)&&we(s,n,l,l[0],a?he(n,l[0],f,null):_e(l[0]),null)},i(l){a||(w(s,l),Je(()=>{t&&t.end(1),r=Qe(e,Re,{y:-50,duration:150,delay:50}),r.start()}),a=!0)},o(l){_(s,l),r&&r.invalidate(),t=ze(e,Re,{y:-50,duration:150}),a=!1},d(l){l&&m(e),s&&s.d(l),l&&t&&t.end()}}}function _t(o,e,r){let{$$slots:t={},$$scope:a}=e;return o.$$set=n=>{"$$scope"in n&&r(0,a=n.$$scope)},[a,t]}class ht extends Y{constructor(e){super(),Z(this,e,_t,wt,x,{})}}async function gt({workflow:o,namespace:e,reason:r}){return await ft(it("workflow.terminate",{namespace:e,workflowId:o.id,runId:o.runId}),{options:{method:"POST",body:JSON.stringify({reason:r})},shouldRetry:!1})}function Ve(o){let e,r,t,a;return e=new Me({props:{variant:"destructive",$$slots:{default:[$t]},$$scope:{ctx:o}}}),e.$on("click",o[3]),t=new mt({props:{open:o[2],confirmText:"Terminate",confirmType:"destructive",$$slots:{content:[bt],title:[kt]},$$scope:{ctx:o}}}),t.$on("cancelModal",o[4]),t.$on("confirmModal",o[6]),{c(){y(e.$$.fragment),r=P(),y(t.$$.fragment)},l(n){E(e.$$.fragment,n),r=j(n),E(t.$$.fragment,n)},m(n,s){I(e,n,s),A(n,r,s),I(t,n,s),a=!0},p(n,s){const l={};s&1024&&(l.$$scope={dirty:s,ctx:n}),e.$set(l);const f={};s&4&&(f.open=n[2]),s&1026&&(f.$$scope={dirty:s,ctx:n}),t.$set(f)},i(n){a||(w(e.$$.fragment,n),w(t.$$.fragment,n),a=!0)},o(n){_(e.$$.fragment,n),_(t.$$.fragment,n),a=!1},d(n){T(e,n),n&&m(r),T(t,n)}}}function $t(o){let e;return{c(){e=R("Terminate")},l(r){e=D(r,"Terminate")},m(r,t){A(r,e,t)},d(r){r&&m(e)}}}function kt(o){let e,r;return{c(){e=g("h3"),r=R("Terminate Workflow"),this.h()},l(t){e=$(t,"H3",{slot:!0});var a=v(e);r=D(a,"Terminate Workflow"),a.forEach(m),this.h()},h(){d(e,"slot","title")},m(t,a){A(t,e,a),p(e,r)},p:ne,d(t){t&&m(e)}}}function bt(o){let e,r,t,a,n,s,l;return{c(){e=g("div"),r=g("p"),t=R(`Are you sure you want to terminate this workflow? This action cannot be
        undone.`),a=P(),n=g("input"),this.h()},l(f){e=$(f,"DIV",{slot:!0});var u=v(e);r=$(u,"P",{});var c=v(r);t=D(c,`Are you sure you want to terminate this workflow? This action cannot be
        undone.`),c.forEach(m),a=j(u),n=$(u,"INPUT",{class:!0,placeholder:!0}),u.forEach(m),this.h()},h(){d(n,"class","mt-4 block w-full rounded-md border border-gray-200 p-2"),d(n,"placeholder","Enter a reason"),d(e,"slot","content")},m(f,u){A(f,e,u),p(e,r),p(r,t),p(e,a),p(e,n),We(n,o[1]),s||(l=Ke(n,"input",o[8]),s=!0)},p(f,u){u&2&&n.value!==f[1]&&We(n,f[1])},d(f){f&&m(e),s=!1,l()}}}function vt(o){let e=o[5](o[0]),r,t,a=e&&Ve(o);return{c(){a&&a.c(),r=Se()},l(n){a&&a.l(n),r=Se()},m(n,s){a&&a.m(n,s),A(n,r,s),t=!0},p(n,[s]){s&1&&(e=n[5](n[0])),e?a?(a.p(n,s),s&1&&w(a,1)):(a=Ve(n),a.c(),w(a,1),a.m(r.parentNode,r)):a&&(qe(),_(a,1,1,()=>{a=null}),He())},i(n){t||(w(a),t=!0)},o(n){_(a),t=!1},d(n){a&&a.d(n),n&&m(r)}}}function yt(o,e,r){let{workflow:t}=e,{namespace:a}=e,n="",s=!1;const l=()=>r(2,s=!0),f=()=>r(2,s=!1),u=k=>String(k.status)==="Running",c=()=>{r(2,s=!1),r(1,n=""),ct.add("success","Workflow Terminated"),window.location.reload()},S=()=>{gt({workflow:t,namespace:a,reason:n}).then(c).catch(ut)};function h(){n=this.value,r(1,n)}return o.$$set=k=>{"workflow"in k&&r(0,t=k.workflow),"namespace"in k&&r(7,a=k.namespace)},[t,n,s,l,f,u,S,a,h]}class Et extends Y{constructor(e){super(),Z(this,e,yt,vt,x,{workflow:0,namespace:7})}}function It(o){let e,r;return{c(){e=g("span"),r=R("Download"),this.h()},l(t){e=$(t,"SPAN",{class:!0});var a=v(e);r=D(a,"Download"),a.forEach(m),this.h()},h(){d(e,"class","hidden md:inline")},m(t,a){A(t,e,a),p(e,r)},p:ne,d(t){t&&m(e)}}}function Tt(o){let e,r;return e=new Me({props:{variant:"secondary",icon:"download",$$slots:{default:[It]},$$scope:{ctx:o}}}),e.$on("click",o[0]),{c(){y(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,a){I(e,t,a),r=!0},p(t,[a]){const n={};a&16&&(n.$$scope={dirty:a,ctx:t}),e.$set(n)},i(t){r||(w(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function At(o,e,r){let{namespace:t}=e,{workflowId:a}=e,{runId:n}=e;const s=async()=>{const l=await pt({namespace:t,workflowId:a,runId:n,sort:"ascending"}),f=JSON.stringify({events:l},null,2);u(f,`${n}/events.json`,"text/plain");function u(c,S,h){const k=document.createElement("a"),O=new Blob([c],{type:h});k.href=URL.createObjectURL(O),k.download=S,k.click()}};return o.$$set=l=>{"namespace"in l&&r(1,t=l.namespace),"workflowId"in l&&r(2,a=l.workflowId),"runId"in l&&r(3,n=l.runId)},[s,t,a,n]}class St extends Y{constructor(e){super(),Z(this,e,At,Tt,x,{namespace:1,workflowId:2,runId:3})}}function Wt(o){let e;return{c(){e=R(o[1])},l(r){e=D(r,o[1])},m(r,t){A(r,e,t)},p(r,t){t&2&&oe(e,r[1])},d(r){r&&m(e)}}}function Nt(o){let e,r,t,a;return{c(){e=R(o[1]),r=P(),t=g("span"),a=R(o[2]),this.h()},l(n){e=D(n,o[1]),r=j(n),t=$(n,"SPAN",{class:!0});var s=v(t);a=D(s,o[2]),s.forEach(m),this.h()},h(){d(t,"class","rounded-sm bg-blue-100 px-2 text-blue-700")},m(n,s){A(n,e,s),A(n,r,s),A(n,t,s),p(t,a)},p(n,s){s&2&&oe(e,n[1]),s&4&&oe(a,n[2])},d(n){n&&m(e),n&&m(r),n&&m(t)}}}function Pt(o){let e,r;function t(s,l){return s[2]||s[2]===0?Nt:Wt}let a=t(o),n=a(o);return{c(){e=g("a"),n.c(),this.h()},l(s){e=$(s,"A",{class:!0,href:!0,"data-cy":!0});var l=v(e);n.l(l),l.forEach(m),this.h()},h(){d(e,"class","block whitespace-nowrap text-sm md:text-base svelte-sf1jtj"),d(e,"href",o[0]),d(e,"data-cy",r=o[4].dataCy),Ne(e,"active",o[3])},m(s,l){A(s,e,l),n.m(e,null)},p(s,[l]){a===(a=t(s))&&n?n.p(s,l):(n.d(1),n=a(s),n&&(n.c(),n.m(e,null))),l&1&&d(e,"href",s[0]),l&16&&r!==(r=s[4].dataCy)&&d(e,"data-cy",r),l&8&&Ne(e,"active",s[3])},i:ne,o:ne,d(s){s&&m(e),n.d()}}}function jt(o,e,r){let t,a;X(o,Le,f=>r(5,a=f));let{href:n}=e,{label:s}=e,{amount:l=null}=e;return o.$$set=f=>{r(4,e=Pe(Pe({},e),je(f))),"href"in f&&r(0,n=f.href),"label"in f&&r(1,s=f.label),"amount"in f&&r(2,l=f.amount)},o.$$.update=()=>{o.$$.dirty&33&&r(3,t=a.url.pathname.includes(n))},e=je(e),[n,s,l,t,e,a]}class re extends Y{constructor(e){super(),Z(this,e,jt,Pt,x,{href:0,label:1,amount:2})}}function Ct(o){var ge,$e,ke,be,ve;let e,r,t,a,n,s,l,f,u,c,S,h,k,O=o[1].id+"",ae,se,F,V,le,q,fe,W,H,ie,L,ue,M,ce,U,me,J,ee;return n=new xe({props:{scale:.8,name:"caretLeft",class:"inline"}}),S=new lt({props:{status:(ge=o[1])==null?void 0:ge.status}}),V=new St({props:{namespace:o[0],workflowId:o[1].id,runId:o[1].runId}}),q=new Et({props:{workflow:o[1],namespace:o[0]}}),H=new re({props:{label:"History",href:De(pe({view:o[3]},o[4])),amount:($e=o[1])==null?void 0:$e.historyEvents,dataCy:"history-tab"}}),L=new re({props:{label:"Workers",href:nt(o[4]),amount:(be=(ke=o[2])==null?void 0:ke.pollers)==null?void 0:be.length,dataCy:"workers-tab"}}),M=new re({props:{label:"Pending Activities",href:at(o[4]),amount:(ve=o[1].pendingActivities)==null?void 0:ve.length,dataCy:"pending-activities-tab"}}),U=new re({props:{label:"Stack Trace",href:ot(o[4]),dataCy:"stack-trace-tab"}}),J=new re({props:{label:"Queries",href:st(o[4]),dataCy:"queries-tab"}}),{c(){e=g("header"),r=g("main"),t=g("div"),a=g("a"),y(n.$$.fragment),s=R("Back to Workflows"),f=P(),u=g("div"),c=g("h1"),y(S.$$.fragment),h=P(),k=g("span"),ae=R(O),se=P(),F=g("div"),y(V.$$.fragment),le=P(),y(q.$$.fragment),fe=P(),W=g("nav"),y(H.$$.fragment),ie=P(),y(L.$$.fragment),ue=P(),y(M.$$.fragment),ce=P(),y(U.$$.fragment),me=P(),y(J.$$.fragment),this.h()},l(i){e=$(i,"HEADER",{class:!0});var b=v(e);r=$(b,"MAIN",{class:!0});var C=v(r);t=$(C,"DIV",{class:!0});var Q=v(t);a=$(Q,"A",{href:!0,"data-cy":!0,class:!0});var z=v(a);E(n.$$.fragment,z),s=D(z,"Back to Workflows"),z.forEach(m),Q.forEach(m),f=j(C),u=$(C,"DIV",{class:!0});var B=v(u);c=$(B,"H1",{class:!0});var K=v(c);E(S.$$.fragment,K),h=j(K),k=$(K,"SPAN",{class:!0});var te=v(k);ae=D(te,O),te.forEach(m),K.forEach(m),se=j(B),F=$(B,"DIV",{class:!0});var G=v(F);E(V.$$.fragment,G),le=j(G),E(q.$$.fragment,G),G.forEach(m),B.forEach(m),fe=j(C),W=$(C,"NAV",{class:!0});var N=v(W);E(H.$$.fragment,N),ie=j(N),E(L.$$.fragment,N),ue=j(N),E(M.$$.fragment,N),ce=j(N),E(U.$$.fragment,N),me=j(N),E(J.$$.fragment,N),N.forEach(m),C.forEach(m),b.forEach(m),this.h()},h(){d(a,"href",l=`/namespaces/${o[0]}/workflows?query=${Fe(o[6])}&search=${o[5]}`),d(a,"data-cy","back-to-workflows"),d(a,"class","back-to-workflows svelte-st9g8m"),d(t,"class","-mt-3 -ml-2 block"),d(k,"class","select-all font-medium"),d(c,"class","relative flex items-center gap-4 text-2xl"),d(F,"class","ml-8 flex items-center justify-end gap-4"),d(u,"class","mb-8 flex items-center justify-between"),d(W,"class","flex flex-wrap gap-6"),d(r,"class","relative flex flex-col gap-1"),d(e,"class","mb-4 flex flex-col gap-4")},m(i,b){A(i,e,b),p(e,r),p(r,t),p(t,a),I(n,a,null),p(a,s),p(r,f),p(r,u),p(u,c),I(S,c,null),p(c,h),p(c,k),p(k,ae),p(u,se),p(u,F),I(V,F,null),p(F,le),I(q,F,null),p(r,fe),p(r,W),I(H,W,null),p(W,ie),I(L,W,null),p(W,ue),I(M,W,null),p(W,ce),I(U,W,null),p(W,me),I(J,W,null),ee=!0},p(i,[b]){var G,N,ye,Ee,Ie;(!ee||b&1&&l!==(l=`/namespaces/${i[0]}/workflows?query=${Fe(i[6])}&search=${i[5]}`))&&d(a,"href",l);const C={};b&2&&(C.status=(G=i[1])==null?void 0:G.status),S.$set(C),(!ee||b&2)&&O!==(O=i[1].id+"")&&oe(ae,O);const Q={};b&1&&(Q.namespace=i[0]),b&2&&(Q.workflowId=i[1].id),b&2&&(Q.runId=i[1].runId),V.$set(Q);const z={};b&2&&(z.workflow=i[1]),b&1&&(z.namespace=i[0]),q.$set(z);const B={};b&8&&(B.href=De(pe({view:i[3]},i[4]))),b&2&&(B.amount=(N=i[1])==null?void 0:N.historyEvents),H.$set(B);const K={};b&4&&(K.amount=(Ee=(ye=i[2])==null?void 0:ye.pollers)==null?void 0:Ee.length),L.$set(K);const te={};b&2&&(te.amount=(Ie=i[1].pendingActivities)==null?void 0:Ie.length),M.$set(te)},i(i){ee||(w(n.$$.fragment,i),w(S.$$.fragment,i),w(V.$$.fragment,i),w(q.$$.fragment,i),w(H.$$.fragment,i),w(L.$$.fragment,i),w(M.$$.fragment,i),w(U.$$.fragment,i),w(J.$$.fragment,i),ee=!0)},o(i){_(n.$$.fragment,i),_(S.$$.fragment,i),_(V.$$.fragment,i),_(q.$$.fragment,i),_(H.$$.fragment,i),_(L.$$.fragment,i),_(M.$$.fragment,i),_(U.$$.fragment,i),_(J.$$.fragment,i),ee=!1},d(i){i&&m(e),T(n),T(S),T(V),T(q),T(H),T(L),T(M),T(U),T(J)}}}function Rt(o,e,r){let t,a;X(o,tt,h=>r(7,t=h)),X(o,et,h=>r(3,a=h));let{namespace:n}=e,{workflow:s}=e,{workers:l}=e;const f={namespace:n,workflow:s.id,run:s.runId},{parameters:u,searchType:c}=t,S=rt(u);return o.$$set=h=>{"namespace"in h&&r(0,n=h.namespace),"workflow"in h&&r(1,s=h.workflow),"workers"in h&&r(2,l=h.workers)},[n,s,l,a,f,c,S]}class Dt extends Y{constructor(e){super(),Z(this,e,Rt,Ct,x,{namespace:0,workflow:1,workers:2})}}function Ft(o){let e,r;return e=new ht({props:{$$slots:{default:[qt]},$$scope:{ctx:o}}}),{c(){y(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,a){I(e,t,a),r=!0},p(t,a){const n={};a&18&&(n.$$scope={dirty:a,ctx:t}),e.$set(n)},i(t){r||(w(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function Vt(o){let e,r;return e=new dt({}),{c(){y(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,a){I(e,t,a),r=!0},p:ne,i(t){r||(w(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function qt(o){let e,r,t;e=new Dt({props:{namespace:o[2],workflow:o[1].workflow,workers:o[1].workers}});const a=o[3].default,n=de(a,o,o[4],null);return{c(){y(e.$$.fragment),r=P(),n&&n.c()},l(s){E(e.$$.fragment,s),r=j(s),n&&n.l(s)},m(s,l){I(e,s,l),A(s,r,l),n&&n.m(s,l),t=!0},p(s,l){const f={};l&2&&(f.workflow=s[1].workflow),l&2&&(f.workers=s[1].workers),e.$set(f),n&&n.p&&(!t||l&16)&&we(n,a,s,s[4],t?he(a,s[4],l,null):_e(s[4]),null)},i(s){t||(w(e.$$.fragment,s),w(n,s),t=!0)},o(s){_(e.$$.fragment,s),_(n,s),t=!1},d(s){T(e,s),s&&m(r),n&&n.d(s)}}}function Ht(o){let e,r,t,a;const n=[Vt,Ft],s=[];function l(f,u){return f[0]?0:1}return r=l(o),t=s[r]=n[r](o),{c(){e=g("main"),t.c(),this.h()},l(f){e=$(f,"MAIN",{class:!0});var u=v(e);t.l(u),u.forEach(m),this.h()},h(){d(e,"class","flex h-full flex-col gap-6")},m(f,u){A(f,e,u),s[r].m(e,null),a=!0},p(f,[u]){let c=r;r=l(f),r===c?s[r].p(f,u):(qe(),_(s[c],1,1,()=>{s[c]=null}),He(),t=s[r],t?t.p(f,u):(t=s[r]=n[r](f),t.c()),w(t,1),t.m(e,null))},i(f){a||(w(t),a=!0)},o(f){_(t),a=!1},d(f){f&&m(e),s[r].d()}}}function Lt(o,e,r){let t,a,n,s;X(o,Ce,c=>r(5,t=c)),X(o,Le,c=>r(6,a=c)),X(o,Ye,c=>r(0,n=c)),X(o,Ze,c=>r(1,s=c));let{$$slots:l={},$$scope:f}=e;const{namespace:u}=a.params;return Ge(()=>{Xe(Ce,t=null,t)}),o.$$set=c=>{"$$scope"in c&&r(4,f=c.$$scope)},[n,s,u,l,f]}class Mt extends Y{constructor(e){super(),Z(this,e,Lt,Ht,x,{})}}function Bt(o){let e;const r=o[0].default,t=de(r,o,o[1],null);return{c(){t&&t.c()},l(a){t&&t.l(a)},m(a,n){t&&t.m(a,n),e=!0},p(a,n){t&&t.p&&(!e||n&2)&&we(t,r,a,a[1],e?he(r,a[1],n,null):_e(a[1]),null)},i(a){e||(w(t,a),e=!0)},o(a){_(t,a),e=!1},d(a){t&&t.d(a)}}}function Ot(o){let e,r;return e=new Mt({props:{$$slots:{default:[Bt]},$$scope:{ctx:o}}}),{c(){y(e.$$.fragment)},l(t){E(e.$$.fragment,t)},m(t,a){I(e,t,a),r=!0},p(t,[a]){const n={};a&2&&(n.$$scope={dirty:a,ctx:t}),e.$set(n)},i(t){r||(w(e.$$.fragment,t),r=!0)},o(t){_(e.$$.fragment,t),r=!1},d(t){T(e,t)}}}function Ut(o,e,r){let{$$slots:t={},$$scope:a}=e;return o.$$set=n=>{"$$scope"in n&&r(1,a=n.$$scope)},[t,a]}class Nr extends Y{constructor(e){super(),Z(this,e,Ut,Ot,x,{})}}export{Nr as default};
