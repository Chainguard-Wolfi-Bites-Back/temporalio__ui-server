import{S as k,i as _,s as d,I as T,e as h,w as y,k as Q,c as g,a as I,x as A,m as q,d as m,b as F,g as P,y as S,M as O,J as W,K as C,L as E,q as c,o as f,B as K}from"../../../../../../chunks/index-4d40a842.js";import{e as L}from"../../../../../../chunks/route-for-e4b4dbdd.js";import{r as p,a as w}from"../../../../../../chunks/route-for-api-a0ac37bf.js";import{f as R}from"../../../../../../chunks/workflow-status-cbd742e0.js";import b from"./_header.svelte-7e83c6e8.js";import"../../../../../../chunks/index-af0e9636.js";import"../../../../../../chunks/notifications-136c5477.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";import"../../../../../../chunks/simplify-attributes-64d6cf1a.js";import"../../../../../../chunks/format-date-919f4714.js";import"../../../../../../chunks/to-duration-271d3946.js";import"../../../../../../chunks/index-12dad8b6.js";import"../../../../../../chunks/event-view-a82e2c63.js";import"../../../../../../chunks/stores-9cf180cc.js";import"../../../../../../chunks/persist-store-2422fd33.js";import"../../../../../../chunks/workflows-f391dc73.js";import"../../../../../../chunks/with-loading-22689bcc.js";import"../../../../../../chunks/button-46d5e57c.js";import"../../../../../../chunks/modal-41c2dade.js";import"../../../../../../chunks/events-service-55ce05f5.js";import"../../../../../../chunks/index-5e108558.js";import"../../../../../../chunks/is-http-8674ce27.js";import"../../../../../../chunks/data-converter-config-f121db83.js";import"../../../../../../chunks/atob-eb4fc9a1.js";import"../../../../../../chunks/get-event-categorization-8a63628f.js";async function v(i,a=fetch){const o=await p(w("task-queue",i),{request:a,params:{taskQueueType:"1"}}),l=await p(w("task-queue",i),{request:a,params:{taskQueueType:"2"}});l.pollers.forEach(r=>{r.taskQueueTypes=["ACTIVITY"]}),o.pollers.forEach(r=>{r.taskQueueTypes=["WORKFLOW"]});const n=r=>(s,e)=>{const t=s[e.identity]||{lastAccessTime:void 0,taskQueueTypes:[]};return s[e.identity]={lastAccessTime:!t.lastAccessTime||t.lastAccessTime<e.lastAccessTime?e.lastAccessTime:t.lastAccessTime,taskQueueTypes:t.taskQueueTypes.concat([r])},s};return l.pollers.filter(r=>o.pollers.some(s=>{if(r.identity===s.identity)return r.taskQueueTypes=[...s.taskQueueTypes,...r.taskQueueTypes],r})),l.pollers.reduce(n("ACTIVITY"),o.pollers.reduce(n("WORKFLOW"),{})),{pollers:l.pollers,taskQueueStatus:l.taskQueueStatus}}function M(i){let a,o,l,n;o=new b({props:{namespace:i[1],workflow:i[0],workers:i[2]}});const r=i[4].default,s=T(r,i,i[3],null);return{c(){a=h("main"),y(o.$$.fragment),l=Q(),s&&s.c(),this.h()},l(e){a=g(e,"MAIN",{class:!0});var t=I(a);A(o.$$.fragment,t),l=q(t),s&&s.l(t),t.forEach(m),this.h()},h(){F(a,"class","flex h-full flex-col gap-6")},m(e,t){P(e,a,t),S(o,a,null),O(a,l),s&&s.m(a,null),n=!0},p(e,[t]){const u={};t&2&&(u.namespace=e[1]),t&1&&(u.workflow=e[0]),t&4&&(u.workers=e[2]),o.$set(u),s&&s.p&&(!n||t&8)&&W(s,r,e,e[3],n?E(r,e[3],t,null):C(e[3]),null)},i(e){n||(c(o.$$.fragment,e),c(s,e),n=!0)},o(e){f(o.$$.fragment,e),f(s,e),n=!1},d(e){e&&m(a),K(o),s&&s.d(e)}}}const ce=async function({params:i,fetch:a}){const{workflow:o,run:l,namespace:n}=i,r={namespace:n,workflowId:L(o),runId:l},s=await R(r,a),{taskQueue:e}=s,t=await v({queue:e,namespace:n});return{props:{workflow:s,namespace:n,workers:t},stuff:{workflow:s,workers:t}}};function V(i,a,o){let{$$slots:l={},$$scope:n}=a,{workflow:r}=a,{namespace:s}=a,{workers:e}=a;return i.$$set=t=>{"workflow"in t&&o(0,r=t.workflow),"namespace"in t&&o(1,s=t.namespace),"workers"in t&&o(2,e=t.workers),"$$scope"in t&&o(3,n=t.$$scope)},[r,s,e,n,l]}class fe extends k{constructor(a){super(),_(this,a,V,M,d,{workflow:0,namespace:1,workers:2})}}export{fe as default,ce as load};
