var Ue=Object.defineProperty;var ae=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var De=(s,e,t)=>e in s?Ue(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Ne=(s,e)=>{for(var t in e||(e={}))Se.call(e,t)&&De(s,t,e[t]);if(ae)for(var t of ae(e))Ce.call(e,t)&&De(s,t,e[t]);return s};var je=(s,e)=>{var t={};for(var r in s)Se.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&ae)for(var r of ae(s))e.indexOf(r)<0&&Ce.call(s,r)&&(t[r]=s[r]);return t};import{S as Z,i as ee,s as te,P as ze,e as g,w as V,c as p,a as _,x as R,d as m,b as w,U as Q,g as G,y as x,W as Xe,q as S,o as C,B as J,I as he,ag as Ye,aJ as Ze,T as le,K as Je,M as Be,N as qe,O as Me,r as et,t as O,k as A,h as F,m as P,L as f,f as Le,J as tt,l as Oe,v as rt,aC as st,aK as nt,aL as at,aM as ot}from"../../../../../../../chunks/vendor-ff19c65d.js";import{h as lt,c as me,r as it,a as ft}from"../../../../../../../chunks/route-for-api-9ec299d3.js";import{t as ct}from"../../../../../../../chunks/index-0b5ef030.js";import{r as U}from"../../../../../../../chunks/route-for-6434eb2e.js";import{p as de}from"../../../../../../../chunks/stores-4aa32d62.js";import{a as Fe}from"../../../../../../../chunks/append-query-parameters-b8619cc0.js";import{g as ut}from"../../../../../../../chunks/get-context-e35b97dd.js";import{C as Ve}from"../../../../../../../chunks/code-block-9df75e9c.js";import{f as mt}from"../../../../../../../chunks/format-date-25613f84.js";import"../../../../../../../chunks/navigation-093db9e2.js";import"../../../../../../../chunks/singletons-a6a7384f.js";import"../../../../../../../chunks/notifications-089fbae0.js";import"../../../../../../../chunks/is-network-error-ac7c8caf.js";import"../../../../../../../chunks/data-converter-config-67b393c3.js";import"../../../../../../../chunks/atob-5f9d7101.js";const Ge=(s={},e={})=>{const t=Ne({},s);for(const r of Object.keys(e)){const o=t[r];Array.isArray(o)?t[r]=t[r].concat(e[r]):typeof o=="object"&&!Array.isArray(o)?t[r]=Ge(t[r],e[r]):t[r]=e[r]}return t},Ke=async(s,{onStart:e,onUpdate:t,onComplete:r,onError:o=lt,token:a,previousProps:c}={})=>{!c&&me(e)&&e();try{const n=await s(a),{nextPageToken:l}=n,v=je(n,["nextPageToken"]),h=Ge(c,v);return me(t)&&t(h,v),l?Ke(s,{onStart:e,onUpdate:t,onComplete:r,token:l,previousProps:h}):(me(r)&&r(h),h)}catch(i){o(i)}},We=async({namespace:s,executionId:e,runId:t,onStart:r,onUpdate:o,onComplete:a},c=fetch)=>(await Ke(async i=>it(ft("events",{namespace:s,executionId:e,runId:t}),{token:i,request:c}),{onStart:r,onUpdate:o,onComplete:a})).history.events,ht=async(s,e=fetch)=>We(s,e).then(ct),dt=s=>{var a,c,n,i;let e,t;const r=s==null?void 0:s.find(l=>!!l.workflowExecutionStartedEventAttributes),o=s==null?void 0:s.find(l=>!!l.workflowExecutionCompletedEventAttributes);return r&&(e=JSON.stringify((c=(a=r==null?void 0:r.workflowExecutionStartedEventAttributes)==null?void 0:a.input)==null?void 0:c.payloads)),o&&(t=JSON.stringify((i=(n=o==null?void 0:o.workflowExecutionCompletedEventAttributes)==null?void 0:n.result)==null?void 0:i.payloads)),{input:e,result:t}};function gt(s){let e,t,r,o,a,c;return t=new ze({props:{icon:s[0],scale:s[2]}}),{c(){e=g("a"),V(t.$$.fragment),this.h()},l(n){e=p(n,"A",{class:!0,href:!0});var i=_(e);R(t.$$.fragment,i),i.forEach(m),this.h()},h(){w(e,"class","border-2 py-2 px-4 hover:text-white hover:bg-gray-600 flex items-center justify-center svelte-1orl6nd"),w(e,"href",r=Fe(s[3],s[4].url.searchParams)),Q(e,"rounded-lg",!s[1]),Q(e,"active",s[4].url.pathname.includes(s[3])),Q(e,"group",s[1])},m(n,i){G(n,e,i),x(t,e,null),o=!0,a||(c=Xe(e,"click",s[5]),a=!0)},p(n,[i]){const l={};i&1&&(l.icon=n[0]),i&4&&(l.scale=n[2]),t.$set(l),(!o||i&24&&r!==(r=Fe(n[3],n[4].url.searchParams)))&&w(e,"href",r),i&2&&Q(e,"rounded-lg",!n[1]),i&24&&Q(e,"active",n[4].url.pathname.includes(n[3])),i&2&&Q(e,"group",n[1])},i(n){o||(S(t.$$.fragment,n),o=!0)},o(n){C(t.$$.fragment,n),o=!1},d(n){n&&m(e),J(t),a=!1,c()}}}function pt(s,e,t){let r;he(s,de,l=>t(4,r=l));let{icon:o}=e,{group:a=ut("group")}=e,{scale:c=1}=e,{href:n="#"}=e;function i(l){Ye.call(this,s,l)}return s.$$set=l=>{"icon"in l&&t(0,o=l.icon),"group"in l&&t(1,a=l.group),"scale"in l&&t(2,c=l.scale),"href"in l&&t(3,n=l.href)},[o,a,c,n,r,i]}class oe extends Z{constructor(e){super();ee(this,e,pt,gt,te,{icon:0,group:1,scale:2,href:3})}}function _t(s){let e,t;return e=new oe({props:{icon:Ze}}),e.$on("click",s[0]),{c(){V(e.$$.fragment)},l(r){R(e.$$.fragment,r)},m(r,o){x(e,r,o),t=!0},p:le,i(r){t||(S(e.$$.fragment,r),t=!0)},o(r){C(e.$$.fragment,r),t=!1},d(r){J(e,r)}}}function vt(s,e,t){let r;he(s,de,i=>t(1,r=i));const{workflow:o,run:a,namespace:c}=r.params;return[async()=>{const i=await We({namespace:c,executionId:o,runId:a}),l=JSON.stringify(i,null,2);v(l,`${a}/events.json`,"text/plain");function v(h,$,b){const u=document.createElement("a"),y=new Blob([h],{type:b});u.href=URL.createObjectURL(y),u.download=$,u.click()}}]}class $t extends Z{constructor(e){super();ee(this,e,vt,_t,te,{})}}function wt(s){let e,t;const r=s[1].default,o=Je(r,s,s[0],null);return{c(){e=g("div"),o&&o.c(),this.h()},l(a){e=p(a,"DIV",{class:!0});var c=_(e);o&&o.l(c),c.forEach(m),this.h()},h(){w(e,"class","flex")},m(a,c){G(a,e,c),o&&o.m(e,null),t=!0},p(a,[c]){o&&o.p&&(!t||c&1)&&Be(o,r,a,a[0],t?Me(r,a[0],c,null):qe(a[0]),null)},i(a){t||(S(o,a),t=!0)},o(a){C(o,a),t=!1},d(a){a&&m(e),o&&o.d(a)}}}function bt(s,e,t){let{$$slots:r={},$$scope:o}=e;return et("group",!0),s.$$set=a=>{"$$scope"in a&&t(0,o=a.$$scope)},[o,r]}class Et extends Z{constructor(e){super();ee(this,e,bt,wt,te,{})}}function Re(s,e,t){const r=s.slice();return r[2]=e[t].id,r[3]=st(e[t],["id"]),r}function yt(s){let e,t,r,o,a,c,n,i,l,v=s[0],h=[];for(let $=0;$<v.length;$+=1)h[$]=xe(Re(s,v,$));return{c(){e=g("section"),t=g("h3"),r=O("Pending Activities"),o=A(),a=g("table");for(let $=0;$<h.length;$+=1)h[$].c();c=A(),n=g("div"),i=g("a"),l=O("Show all"),this.h()},l($){e=p($,"SECTION",{class:!0});var b=_(e);t=p(b,"H3",{class:!0});var u=_(t);r=F(u,"Pending Activities"),u.forEach(m),o=P(b),a=p(b,"TABLE",{class:!0});var y=_(a);for(let D=0;D<h.length;D+=1)h[D].l(y);y.forEach(m),c=P(b),n=p(b,"DIV",{class:!0});var j=_(n);i=p(j,"A",{href:!0,class:!0});var T=_(i);l=F(T,"Show all"),T.forEach(m),j.forEach(m),b.forEach(m),this.h()},h(){w(t,"class","text-lg font-medium mb-4"),w(a,"class","w-full table-auto space-x-4"),w(i,"href",Qe),w(i,"class","border-b-2 border-blue-600"),w(n,"class","text-right"),w(e,"class","border-2 border-gray-300 rounded-lg p-4")},m($,b){G($,e,b),f(e,t),f(t,r),f(e,o),f(e,a);for(let u=0;u<h.length;u+=1)h[u].m(a,null);f(e,c),f(e,n),f(n,i),f(i,l)},p($,b){if(b&1){v=$[0];let u;for(u=0;u<v.length;u+=1){const y=Re($,v,u);h[u]?h[u].p(y,b):(h[u]=xe(y),h[u].c(),h[u].m(a,null))}for(;u<h.length;u+=1)h[u].d(1);h.length=v.length}},d($){$&&m(e),tt(h,$)}}}function xe(s){var pe;let e,t,r,o=s[3].activityId+"",a,c,n,i,l,v,h,$,b,u,y=((pe=s[3].activityType)==null?void 0:pe.name)+"",j,T,D,I,B,k,d,E,H,K=s[3].lastFailure+"",q,W,L,M,z,ie,fe,X,ge=mt(s[3].lastHeartbeatTime)+"",ce,ue;return{c(){e=g("tr"),t=g("th"),r=g("a"),a=O(o),n=A(),i=g("td"),l=g("div"),v=g("h4"),h=O("Activity Name"),$=A(),b=g("p"),u=g("span"),j=O(y),T=A(),D=g("td"),I=g("div"),B=g("h3"),k=O("Last Failure"),d=A(),E=g("pre"),H=g("code"),q=O(K),W=A(),L=g("td"),M=g("div"),z=g("h4"),ie=O("Last Heartbeat Time"),fe=A(),X=g("p"),ce=O(ge),ue=A(),this.h()},l(Y){e=p(Y,"TR",{class:!0});var N=_(e);t=p(N,"TH",{class:!0});var _e=_(t);r=p(_e,"A",{href:!0});var ve=_(r);a=F(ve,o),ve.forEach(m),_e.forEach(m),n=P(N),i=p(N,"TD",{});var $e=_(i);l=p($e,"DIV",{class:!0});var re=_(l);v=p(re,"H4",{});var we=_(v);h=F(we,"Activity Name"),we.forEach(m),$=P(re),b=p(re,"P",{});var be=_(b);u=p(be,"SPAN",{class:!0});var Ee=_(u);j=F(Ee,y),Ee.forEach(m),be.forEach(m),re.forEach(m),$e.forEach(m),T=P(N),D=p(N,"TD",{});var ye=_(D);I=p(ye,"DIV",{class:!0});var se=_(I);B=p(se,"H3",{});var ke=_(B);k=F(ke,"Last Failure"),ke.forEach(m),d=P(se),E=p(se,"PRE",{style:!0,class:!0});var Ae=_(E);H=p(Ae,"CODE",{class:!0});var Pe=_(H);q=F(Pe,K),Pe.forEach(m),Ae.forEach(m),se.forEach(m),ye.forEach(m),W=P(N),L=p(N,"TD",{});var Ie=_(L);M=p(Ie,"DIV",{class:!0});var ne=_(M);z=p(ne,"H4",{});var Te=_(z);ie=F(Te,"Last Heartbeat Time"),Te.forEach(m),fe=P(ne),X=p(ne,"P",{});var He=_(X);ce=F(He,ge),He.forEach(m),ne.forEach(m),Ie.forEach(m),ue=P(N),N.forEach(m),this.h()},h(){w(r,"href",c=Qe+"#"+s[2]),w(t,"class","text-left font-normal text-gray-500"),w(u,"class","bg-gray-300 text-gray-700 px-2"),w(l,"class","flex gap-2"),w(H,"class","language-json"),Le(E,"padding","0 1em"),Le(E,"margin","0"),w(E,"class","rounded-lg"),w(I,"class","flex gap-2"),w(M,"class","flex gap-2"),w(e,"class","border-b-2 border-gray-300 pb-4 last-of-type:border-b-0")},m(Y,N){G(Y,e,N),f(e,t),f(t,r),f(r,a),f(e,n),f(e,i),f(i,l),f(l,v),f(v,h),f(l,$),f(l,b),f(b,u),f(u,j),f(e,T),f(e,D),f(D,I),f(I,B),f(B,k),f(I,d),f(I,E),f(E,H),f(H,q),f(e,W),f(e,L),f(L,M),f(M,z),f(z,ie),f(M,fe),f(M,X),f(X,ce),f(e,ue)},p:le,d(Y){Y&&m(e)}}}function kt(s){let e,t=s[0].length&&yt(s);return{c(){t&&t.c(),e=Oe()},l(r){t&&t.l(r),e=Oe()},m(r,o){t&&t.m(r,o),G(r,e,o)},p(r,[o]){r[0].length&&t.p(r,o)},i:le,o:le,d(r){t&&t.d(r),r&&m(e)}}}const Qe="../../pending-activities";function At(s,e,t){let r;he(s,de,a=>t(1,r=a));const{pendingActivities:o}=r.stuff.workflow;return rt(()=>{window.Prism.highlightAll()}),[o]}class Pt extends Z{constructor(e){super();ee(this,e,At,kt,te,{})}}function It(s){let e,t,r,o,a,c;return e=new oe({props:{icon:nt,href:U("workflow.events.summary",s[0])}}),r=new oe({props:{icon:at,href:U("workflow.events.compact",s[0])}}),a=new oe({props:{icon:ot,href:U("workflow.events.json",s[0])}}),{c(){V(e.$$.fragment),t=A(),V(r.$$.fragment),o=A(),V(a.$$.fragment)},l(n){R(e.$$.fragment,n),t=P(n),R(r.$$.fragment,n),o=P(n),R(a.$$.fragment,n)},m(n,i){x(e,n,i),G(n,t,i),x(r,n,i),G(n,o,i),x(a,n,i),c=!0},p(n,i){const l={};i&1&&(l.href=U("workflow.events.summary",n[0])),e.$set(l);const v={};i&1&&(v.href=U("workflow.events.compact",n[0])),r.$set(v);const h={};i&1&&(h.href=U("workflow.events.json",n[0])),a.$set(h)},i(n){c||(S(e.$$.fragment,n),S(r.$$.fragment,n),S(a.$$.fragment,n),c=!0)},o(n){C(e.$$.fragment,n),C(r.$$.fragment,n),C(a.$$.fragment,n),c=!1},d(n){J(e,n),n&&m(t),J(r,n),n&&m(o),J(a,n)}}}function Tt(s){let e,t,r,o,a,c,n,i,l,v,h,$,b,u,y,j,T,D,I;r=new Ve({props:{heading:"Input",content:s[1],framed:!0}}),a=new Ve({props:{heading:"Result",content:s[2],framed:!0}}),n=new Pt({}),y=new Et({props:{$$slots:{default:[It]},$$scope:{ctx:s}}}),T=new $t({});const B=s[4].default,k=Je(B,s,s[5],null);return{c(){e=g("section"),t=g("div"),V(r.$$.fragment),o=A(),V(a.$$.fragment),c=A(),V(n.$$.fragment),i=A(),l=g("section"),v=g("nav"),h=g("h3"),$=O("Event History"),b=A(),u=g("div"),V(y.$$.fragment),j=A(),V(T.$$.fragment),D=A(),k&&k.c(),this.h()},l(d){e=p(d,"SECTION",{class:!0});var E=_(e);t=p(E,"DIV",{class:!0});var H=_(t);R(r.$$.fragment,H),o=P(H),R(a.$$.fragment,H),H.forEach(m),c=P(E),R(n.$$.fragment,E),i=P(E),l=p(E,"SECTION",{id:!0});var K=_(l);v=p(K,"NAV",{class:!0});var q=_(v);h=p(q,"H3",{class:!0});var W=_(h);$=F(W,"Event History"),W.forEach(m),b=P(q),u=p(q,"DIV",{class:!0});var L=_(u);R(y.$$.fragment,L),j=P(L),R(T.$$.fragment,L),L.forEach(m),q.forEach(m),D=P(K),k&&k.l(K),K.forEach(m),E.forEach(m),this.h()},h(){w(t,"class","flex gap-4"),w(h,"class","text-lg font-medium"),w(u,"class","flex gap-4"),w(v,"class","flex gap-4 justify-between items-end pb-4"),w(l,"id","event-history"),w(e,"class","flex flex-col gap-4")},m(d,E){G(d,e,E),f(e,t),x(r,t,null),f(t,o),x(a,t,null),f(e,c),x(n,e,null),f(e,i),f(e,l),f(l,v),f(v,h),f(h,$),f(v,b),f(v,u),x(y,u,null),f(u,j),x(T,u,null),f(l,D),k&&k.m(l,null),I=!0},p(d,[E]){const H={};E&33&&(H.$$scope={dirty:E,ctx:d}),y.$set(H),k&&k.p&&(!I||E&32)&&Be(k,B,d,d[5],I?Me(B,d[5],E,null):qe(d[5]),null)},i(d){I||(S(r.$$.fragment,d),S(a.$$.fragment,d),S(n.$$.fragment,d),S(y.$$.fragment,d),S(T.$$.fragment,d),S(k,d),I=!0)},o(d){C(r.$$.fragment,d),C(a.$$.fragment,d),C(n.$$.fragment,d),C(y.$$.fragment,d),C(T.$$.fragment,d),C(k,d),I=!1},d(d){d&&m(e),J(r),J(a),J(n),J(y),J(T),k&&k.d(d)}}}const Kt=async function({params:s}){const{workflow:e,run:t,namespace:r}=s,o={namespace:r,executionId:e,runId:t},{events:a,eventGroups:c}=await ht(o);return{props:{workflowParameters:{workflowId:e,runId:t,namespace:r},events:a,eventGroups:c},stuff:{events:a,eventGroups:c}}};function Ht(s,e,t){let{$$slots:r={},$$scope:o}=e,{workflowParameters:a}=e,{events:c}=e;const{input:n,result:i}=dt(c);return s.$$set=l=>{"workflowParameters"in l&&t(0,a=l.workflowParameters),"events"in l&&t(3,c=l.events),"$$scope"in l&&t(5,o=l.$$scope)},[a,n,i,c,r,o]}class Wt extends Z{constructor(e){super();ee(this,e,Ht,Tt,te,{workflowParameters:0,events:3})}}export{Wt as default,Kt as load};
