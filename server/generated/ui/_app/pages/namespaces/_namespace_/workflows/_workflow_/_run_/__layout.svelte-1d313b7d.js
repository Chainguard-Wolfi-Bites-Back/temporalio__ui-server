import{S as oe,i as le,s as fe,w as I,x as P,y as S,q as b,o as v,B as y,l as Se,g as W,n as We,p as Fe,d as m,t as N,h as T,e as _,c as w,a as g,b as c,U as ye,T as Ne,I as De,j as z,k as $,m as k,L as u,P as He,aA as Re,f as qe,K as Be,M as Me,N as Oe,O as je}from"../../../../../../chunks/vendor-cba54241.js";import{W as Ce,a as Le}from"../../../../../../chunks/workflow-status-e40997de.js";import{a as Qe,b as Ve,c as Je,d as Ke,e as Ue,f as ze}from"../../../../../../chunks/route-for-bfb45385.js";import{g as Ge}from"../../../../../../chunks/navigation-093db9e2.js";import{r as Xe,a as Ye,h as Ze}from"../../../../../../chunks/route-for-api-f58641b9.js";import{n as xe}from"../../../../../../chunks/notifications-dc83cd3a.js";import{B as et}from"../../../../../../chunks/button-b6adbef3.js";import{p as tt}from"../../../../../../chunks/stores-a6bbeb31.js";import"../../../../../../chunks/singletons-a6a7384f.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";async function at({workflow:r,namespace:e,reason:t}){return await Xe(Ye("workflow.terminate",{namespace:e,executionId:r.id,runId:r.runId}),{options:{method:"POST",body:JSON.stringify({reason:t})},shouldRetry:!1})}function Te(r){let e,t;return e=new et({props:{destroy:!0,$$slots:{default:[nt]},$$scope:{ctx:r}}}),e.$on("click",r[2]),{c(){I(e.$$.fragment)},l(s){P(e.$$.fragment,s)},m(s,a){S(e,s,a),t=!0},p(s,a){const n={};a&64&&(n.$$scope={dirty:a,ctx:s}),e.$set(n)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){v(e.$$.fragment,s),t=!1},d(s){y(e,s)}}}function nt(r){let e;return{c(){e=N("Terminate")},l(t){e=T(t,"Terminate")},m(t,s){W(t,e,s)},d(t){t&&m(e)}}}function st(r){let e=r[1](r[0]),t,s,a=e&&Te(r);return{c(){a&&a.c(),t=Se()},l(n){a&&a.l(n),t=Se()},m(n,o){a&&a.m(n,o),W(n,t,o),s=!0},p(n,[o]){o&1&&(e=n[1](n[0])),e?a?(a.p(n,o),o&1&&b(a,1)):(a=Te(n),a.c(),b(a,1),a.m(t.parentNode,t)):a&&(We(),v(a,1,1,()=>{a=null}),Fe())},i(n){s||(b(a),s=!0)},o(n){v(a),s=!1},d(n){a&&a.d(n),n&&m(t)}}}function rt(r,e,t){let{workflow:s}=e,{namespace:a}=e,n="";const o=h=>String(h.status)==="Running",l=()=>{n="",xe.add("success","Workflow Terminated"),Ge(Qe({namespace:a,workflow:s.id,run:s.runId}))},i=()=>{at({workflow:s,namespace:a,reason:n}).then(l).catch(Ze)};return r.$$set=h=>{"workflow"in h&&t(0,s=h.workflow),"namespace"in h&&t(3,a=h.namespace)},[s,o,i,a]}class ot extends oe{constructor(e){super();le(this,e,rt,st,fe,{workflow:0,namespace:3})}}function lt(r){let e;return{c(){e=N(r[1])},l(t){e=T(t,r[1])},m(t,s){W(t,e,s)},p(t,s){s&2&&z(e,t[1])},d(t){t&&m(e)}}}function ft(r){let e,t,s,a;return{c(){e=N(r[1]),t=$(),s=_("span"),a=N(r[2]),this.h()},l(n){e=T(n,r[1]),t=k(n),s=w(n,"SPAN",{class:!0});var o=g(s);a=T(o,r[2]),o.forEach(m),this.h()},h(){c(s,"class","px-2 text-blue-700 bg-blue-100 rounded-sm")},m(n,o){W(n,e,o),W(n,t,o),W(n,s,o),u(s,a)},p(n,o){o&2&&z(e,n[1]),o&4&&z(a,n[2])},d(n){n&&m(e),n&&m(t),n&&m(s)}}}function it(r){let e;function t(n,o){return n[2]||n[2]===0?ft:lt}let s=t(r),a=s(r);return{c(){e=_("a"),a.c(),this.h()},l(n){e=w(n,"A",{class:!0,href:!0});var o=g(e);a.l(o),o.forEach(m),this.h()},h(){c(e,"class","block svelte-tavydt"),c(e,"href",r[0]),ye(e,"active",r[3])},m(n,o){W(n,e,o),a.m(e,null)},p(n,[o]){s===(s=t(n))&&a?a.p(n,o):(a.d(1),a=s(n),a&&(a.c(),a.m(e,null))),o&1&&c(e,"href",n[0]),o&8&&ye(e,"active",n[3])},i:Ne,o:Ne,d(n){n&&m(e),a.d()}}}function ut(r,e,t){let s,a;De(r,tt,i=>t(4,a=i));let{href:n}=e,{label:o}=e,{amount:l=null}=e;return r.$$set=i=>{"href"in i&&t(0,n=i.href),"label"in i&&t(1,o=i.label),"amount"in i&&t(2,l=i.amount)},r.$$.update=()=>{r.$$.dirty&17&&t(3,s=a.url.pathname.includes(n))},[n,o,l,s,a]}class te extends oe{constructor(e){super();le(this,e,ut,it,fe,{href:0,label:1,amount:2})}}function mt(r){var ve,Ee,Ae;let e,t,s,a,n,o,l,i,h=r[1].name+"",ae,ie,F,ue,D,me,H,G,ce,he,J,X=r[1].id+"",ne,pe,R,Y,_e,we,K,Z=r[1].runId+"",se,ge,d,q,de,B,$e,O,ke,j,be,C,M;return a=new He({props:{icon:Re}}),F=new Ce({props:{status:(ve=r[1])==null?void 0:ve.status}}),D=new ot({props:{workflow:r[1],namespace:r[0]}}),q=new te({props:{label:"History",href:Ve(r[2]),amount:(Ee=r[1])==null?void 0:Ee.historyEvents}}),B=new te({props:{label:"Pending Activities",href:Je(r[2]),amount:(Ae=r[1].pendingActivities)==null?void 0:Ae.length}}),O=new te({props:{label:"Workers",href:Ke(r[2])}}),j=new te({props:{label:"Stack Trace",href:Ue(r[2])}}),C=new te({props:{label:"Query",href:ze(r[2])}}),{c(){e=_("header"),t=_("main"),s=_("a"),I(a.$$.fragment),o=$(),l=_("div"),i=_("h1"),ae=N(h),ie=$(),I(F.$$.fragment),ue=$(),I(D.$$.fragment),me=$(),H=_("p"),G=_("span"),ce=N("Workflow ID"),he=$(),J=_("span"),ne=N(X),pe=$(),R=_("p"),Y=_("span"),_e=N("Run ID"),we=$(),K=_("span"),se=N(Z),ge=$(),d=_("nav"),I(q.$$.fragment),de=$(),I(B.$$.fragment),$e=$(),I(O.$$.fragment),ke=$(),I(j.$$.fragment),be=$(),I(C.$$.fragment),this.h()},l(f){e=w(f,"HEADER",{class:!0});var p=g(e);t=w(p,"MAIN",{class:!0});var E=g(t);s=w(E,"A",{href:!0,class:!0,style:!0});var U=g(s);P(a.$$.fragment,U),U.forEach(m),o=k(E),l=w(E,"DIV",{class:!0});var L=g(l);i=w(L,"H1",{class:!0});var Q=g(i);ae=T(Q,h),ie=k(Q),P(F.$$.fragment,Q),Q.forEach(m),ue=k(L),P(D.$$.fragment,L),L.forEach(m),me=k(E),H=w(E,"P",{class:!0});var V=g(H);G=w(V,"SPAN",{});var x=g(G);ce=T(x,"Workflow ID"),x.forEach(m),he=k(V),J=w(V,"SPAN",{class:!0});var ee=g(J);ne=T(ee,X),ee.forEach(m),V.forEach(m),pe=k(E),R=w(E,"P",{class:!0});var re=g(R);Y=w(re,"SPAN",{});var Ie=g(Y);_e=T(Ie,"Run ID"),Ie.forEach(m),we=k(re),K=w(re,"SPAN",{class:!0});var Pe=g(K);se=T(Pe,Z),Pe.forEach(m),re.forEach(m),E.forEach(m),ge=k(p),d=w(p,"NAV",{class:!0});var A=g(d);P(q.$$.fragment,A),de=k(A),P(B.$$.fragment,A),$e=k(A),P(O.$$.fragment,A),ke=k(A),P(j.$$.fragment,A),be=k(A),P(C.$$.fragment,A),A.forEach(m),p.forEach(m),this.h()},h(){c(s,"href",n="/namespaces/"+r[0]+"/workflows"),c(s,"class","absolute top-2 back-to-workflows"),qe(s,"left","-1.5rem"),c(i,"class","text-2xl"),c(l,"class","flex justify-between items-center"),c(J,"class","font-medium"),c(H,"class","text-md"),c(K,"class","font-medium"),c(R,"class","text-md"),c(t,"class","flex flex-col gap-1 relative"),c(d,"class","flex gap-6"),c(e,"class","flex flex-col gap-4")},m(f,p){W(f,e,p),u(e,t),u(t,s),S(a,s,null),u(t,o),u(t,l),u(l,i),u(i,ae),u(i,ie),S(F,i,null),u(l,ue),S(D,l,null),u(t,me),u(t,H),u(H,G),u(G,ce),u(H,he),u(H,J),u(J,ne),u(t,pe),u(t,R),u(R,Y),u(Y,_e),u(R,we),u(R,K),u(K,se),u(e,ge),u(e,d),S(q,d,null),u(d,de),S(B,d,null),u(d,$e),S(O,d,null),u(d,ke),S(j,d,null),u(d,be),S(C,d,null),M=!0},p(f,[p]){var V,x,ee;(!M||p&1&&n!==(n="/namespaces/"+f[0]+"/workflows"))&&c(s,"href",n),(!M||p&2)&&h!==(h=f[1].name+"")&&z(ae,h);const E={};p&2&&(E.status=(V=f[1])==null?void 0:V.status),F.$set(E);const U={};p&2&&(U.workflow=f[1]),p&1&&(U.namespace=f[0]),D.$set(U),(!M||p&2)&&X!==(X=f[1].id+"")&&z(ne,X),(!M||p&2)&&Z!==(Z=f[1].runId+"")&&z(se,Z);const L={};p&2&&(L.amount=(x=f[1])==null?void 0:x.historyEvents),q.$set(L);const Q={};p&2&&(Q.amount=(ee=f[1].pendingActivities)==null?void 0:ee.length),B.$set(Q)},i(f){M||(b(a.$$.fragment,f),b(F.$$.fragment,f),b(D.$$.fragment,f),b(q.$$.fragment,f),b(B.$$.fragment,f),b(O.$$.fragment,f),b(j.$$.fragment,f),b(C.$$.fragment,f),M=!0)},o(f){v(a.$$.fragment,f),v(F.$$.fragment,f),v(D.$$.fragment,f),v(q.$$.fragment,f),v(B.$$.fragment,f),v(O.$$.fragment,f),v(j.$$.fragment,f),v(C.$$.fragment,f),M=!1},d(f){f&&m(e),y(a),y(F),y(D),y(q),y(B),y(O),y(j),y(C)}}}function ct(r,e,t){let{namespace:s}=e,{workflow:a}=e;const n={namespace:s,workflow:a.id,run:a.runId};return r.$$set=o=>{"namespace"in o&&t(0,s=o.namespace),"workflow"in o&&t(1,a=o.workflow)},[s,a,n]}class ht extends oe{constructor(e){super();le(this,e,ct,mt,fe,{namespace:0,workflow:1})}}function pt(r){let e,t,s,a;t=new ht({props:{namespace:r[1],workflow:r[0]}});const n=r[3].default,o=Be(n,r,r[2],null);return{c(){e=_("main"),I(t.$$.fragment),s=$(),o&&o.c(),this.h()},l(l){e=w(l,"MAIN",{class:!0});var i=g(e);P(t.$$.fragment,i),s=k(i),o&&o.l(i),i.forEach(m),this.h()},h(){c(e,"class","flex flex-col gap-6 h-full")},m(l,i){W(l,e,i),S(t,e,null),u(e,s),o&&o.m(e,null),a=!0},p(l,[i]){const h={};i&2&&(h.namespace=l[1]),i&1&&(h.workflow=l[0]),t.$set(h),o&&o.p&&(!a||i&4)&&Me(o,n,l,l[2],a?je(n,l[2],i,null):Oe(l[2]),null)},i(l){a||(b(t.$$.fragment,l),b(o,l),a=!0)},o(l){v(t.$$.fragment,l),v(o,l),a=!1},d(l){l&&m(e),y(t),o&&o.d(l)}}}const Pt=async function({params:r}){const{workflow:e,run:t,namespace:s}=r,n=await Le({namespace:s,executionId:e,runId:t},fetch);return{props:{workflow:n,namespace:s},stuff:{workflow:n}}};function _t(r,e,t){let{$$slots:s={},$$scope:a}=e,{workflow:n}=e,{namespace:o}=e;return r.$$set=l=>{"workflow"in l&&t(0,n=l.workflow),"namespace"in l&&t(1,o=l.namespace),"$$scope"in l&&t(2,a=l.$$scope)},[n,o,a,s]}class St extends oe{constructor(e){super();le(this,e,_t,pt,fe,{workflow:0,namespace:1})}}export{St as default,Pt as load};
