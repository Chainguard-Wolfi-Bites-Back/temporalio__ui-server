import{S as he,i as pe,s as de,e as _,k as g,w as M,c as h,a as d,d as c,m as v,x as H,b as p,g as P,L as i,y as R,W as qe,M as Ee,N as Ie,O as Te,q as w,o as k,B as j,l as we,n as Be,p as Oe,aj as Qe,P as Le,aB as Ue,K as Ae,t as V,h as C,j as fe,aq as Ve,U as Ce,T as Fe,I as Je,aC as Ke,f as ze}from"../../../../../../chunks/vendor-50e5f379.js";import{W as Ge,a as Xe}from"../../../../../../chunks/workflow-status-bf377cf6.js";import{b as Ye,c as Ze,d as xe,e as et,f as tt}from"../../../../../../chunks/route-for-f402e023.js";import{r as nt,a as st,h as at}from"../../../../../../chunks/route-for-api-8dcf5656.js";import{n as lt}from"../../../../../../chunks/notifications-47c0b7f7.js";import{B as Pe}from"../../../../../../chunks/button-0f06bcb9.js";import{p as rt}from"../../../../../../chunks/stores-21b93f9e.js";import"../../../../../../chunks/navigation-093db9e2.js";import"../../../../../../chunks/singletons-a6a7384f.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";async function ot({workflow:l,namespace:e,reason:t}){return await nt(st("workflow.terminate",{namespace:e,executionId:l.id,runId:l.runId}),{options:{method:"POST",body:JSON.stringify({reason:t})},shouldRetry:!1})}const ft=l=>({}),Me=l=>({}),it=l=>({}),He=l=>({});function Re(l){let e,t,a,n,s,r,o,f,$,A,D,E,b,B,q,y,J,ie;r=new Le({props:{icon:Ue}});const ee=l[3].title,L=Ae(ee,l,l[7],He),N=L||ct(),K=l[3].content,z=Ae(K,l,l[7],Me),I=z||ut();return b=new Pe({props:{secondary:!0,$$slots:{default:[mt]},$$scope:{ctx:l}}}),b.$on("click",l[5]),q=new Pe({props:{destroy:!0,$$slots:{default:[_t]},$$scope:{ctx:l}}}),q.$on("click",l[6]),{c(){e=_("div"),t=_("div"),a=g(),n=_("div"),s=_("div"),M(r.$$.fragment),o=g(),f=_("div"),N&&N.c(),$=g(),A=_("div"),I&&I.c(),D=g(),E=_("div"),M(b.$$.fragment),B=g(),M(q.$$.fragment),this.h()},l(u){e=h(u,"DIV",{class:!0});var T=d(e);t=h(T,"DIV",{class:!0}),d(t).forEach(c),a=v(T),n=h(T,"DIV",{class:!0});var W=d(n);s=h(W,"DIV",{class:!0});var O=d(s);H(r.$$.fragment,O),O.forEach(c),o=v(W),f=h(W,"DIV",{class:!0});var G=d(f);N&&N.l(G),G.forEach(c),$=v(W),A=h(W,"DIV",{class:!0});var te=d(A);I&&I.l(te),te.forEach(c),D=v(W),E=h(W,"DIV",{class:!0});var X=d(E);H(b.$$.fragment,X),B=v(X),H(q.$$.fragment,X),X.forEach(c),W.forEach(c),T.forEach(c),this.h()},h(){p(t,"class","overlay svelte-p12tlm"),p(s,"class","float-right cursor-pointer p-6"),p(f,"class","title svelte-p12tlm"),p(A,"class","content svelte-p12tlm"),p(E,"class","flex justify-end items-center p-6 space-x-2"),p(n,"class","body svelte-p12tlm"),p(e,"class","modal svelte-p12tlm")},m(u,T){P(u,e,T),i(e,t),i(e,a),i(e,n),i(n,s),R(r,s,null),i(n,o),i(n,f),N&&N.m(f,null),i(n,$),i(n,A),I&&I.m(A,null),i(n,D),i(n,E),R(b,E,null),i(E,B),R(q,E,null),y=!0,J||(ie=qe(s,"click",l[4]),J=!0)},p(u,T){L&&L.p&&(!y||T&128)&&Ee(L,ee,u,u[7],y?Te(ee,u[7],T,it):Ie(u[7]),He),z&&z.p&&(!y||T&128)&&Ee(z,K,u,u[7],y?Te(K,u[7],T,ft):Ie(u[7]),Me);const W={};T&128&&(W.$$scope={dirty:T,ctx:u}),b.$set(W);const O={};T&130&&(O.$$scope={dirty:T,ctx:u}),q.$set(O)},i(u){y||(w(r.$$.fragment,u),w(N,u),w(I,u),w(b.$$.fragment,u),w(q.$$.fragment,u),y=!0)},o(u){k(r.$$.fragment,u),k(N,u),k(I,u),k(b.$$.fragment,u),k(q.$$.fragment,u),y=!1},d(u){u&&c(e),j(r),N&&N.d(u),I&&I.d(u),j(b),j(q),J=!1,ie()}}}function ct(l){let e,t;return{c(){e=_("h3"),t=V("Title")},l(a){e=h(a,"H3",{});var n=d(e);t=C(n,"Title"),n.forEach(c)},m(a,n){P(a,e,n),i(e,t)},d(a){a&&c(e)}}}function ut(l){let e,t;return{c(){e=_("span"),t=V("Content")},l(a){e=h(a,"SPAN",{});var n=d(e);t=C(n,"Content"),n.forEach(c)},m(a,n){P(a,e,n),i(e,t)},d(a){a&&c(e)}}}function mt(l){let e;return{c(){e=V("Cancel")},l(t){e=C(t,"Cancel")},m(t,a){P(t,e,a)},d(t){t&&c(e)}}}function _t(l){let e;return{c(){e=V(l[1])},l(t){e=C(t,l[1])},m(t,a){P(t,e,a)},p(t,a){a&2&&fe(e,t[1])},d(t){t&&c(e)}}}function ht(l){let e,t,a=l[0]&&Re(l);return{c(){a&&a.c(),e=we()},l(n){a&&a.l(n),e=we()},m(n,s){a&&a.m(n,s),P(n,e,s),t=!0},p(n,[s]){n[0]?a?(a.p(n,s),s&1&&w(a,1)):(a=Re(n),a.c(),w(a,1),a.m(e.parentNode,e)):a&&(Be(),k(a,1,1,()=>{a=null}),Oe())},i(n){t||(w(a),t=!0)},o(n){k(a),t=!1},d(n){a&&a.d(n),n&&c(e)}}}function pt(l,e,t){let{$$slots:a={},$$scope:n}=e,{open:s=!1}=e,{confirmText:r="Confirm"}=e;const o=Qe(),f=()=>o("cancelModal",{}),$=()=>o("cancelModal",{}),A=()=>o("confirmModal",{});return l.$$set=D=>{"open"in D&&t(0,s=D.open),"confirmText"in D&&t(1,r=D.confirmText),"$$scope"in D&&t(7,n=D.$$scope)},[s,r,o,a,f,$,A,n]}class dt extends he{constructor(e){super();pe(this,e,pt,ht,de,{open:0,confirmText:1})}}function je(l){let e,t,a,n;return e=new Pe({props:{destroy:!0,thin:!0,$$slots:{default:[$t]},$$scope:{ctx:l}}}),e.$on("click",l[3]),a=new dt({props:{open:l[2],confirmText:"Terminate",$$slots:{content:[gt],title:[wt]},$$scope:{ctx:l}}}),a.$on("cancelModal",l[4]),a.$on("confirmModal",l[6]),{c(){M(e.$$.fragment),t=g(),M(a.$$.fragment)},l(s){H(e.$$.fragment,s),t=v(s),H(a.$$.fragment,s)},m(s,r){R(e,s,r),P(s,t,r),R(a,s,r),n=!0},p(s,r){const o={};r&1024&&(o.$$scope={dirty:r,ctx:s}),e.$set(o);const f={};r&4&&(f.open=s[2]),r&1026&&(f.$$scope={dirty:r,ctx:s}),a.$set(f)},i(s){n||(w(e.$$.fragment,s),w(a.$$.fragment,s),n=!0)},o(s){k(e.$$.fragment,s),k(a.$$.fragment,s),n=!1},d(s){j(e,s),s&&c(t),j(a,s)}}}function $t(l){let e;return{c(){e=V("Terminate")},l(t){e=C(t,"Terminate")},m(t,a){P(t,e,a)},d(t){t&&c(e)}}}function wt(l){let e,t;return{c(){e=_("h3"),t=V("Terminate Workflow"),this.h()},l(a){e=h(a,"H3",{slot:!0});var n=d(e);t=C(n,"Terminate Workflow"),n.forEach(c),this.h()},h(){p(e,"slot","title")},m(a,n){P(a,e,n),i(e,t)},d(a){a&&c(e)}}}function gt(l){let e,t,a,n,s,r,o;return{c(){e=_("div"),t=_("p"),a=V(`Are you sure you want to terminate this workflow? This action cannot be
        undone.`),n=g(),s=_("input"),this.h()},l(f){e=h(f,"DIV",{slot:!0});var $=d(e);t=h($,"P",{});var A=d(t);a=C(A,`Are you sure you want to terminate this workflow? This action cannot be
        undone.`),A.forEach(c),n=v($),s=h($,"INPUT",{class:!0,placeholder:!0}),$.forEach(c),this.h()},h(){p(s,"class","block w-full border border-gray-200 rounded-md p-2 mt-4"),p(s,"placeholder","Enter a reason"),p(e,"slot","content")},m(f,$){P(f,e,$),i(e,t),i(t,a),i(e,n),i(e,s),Ve(s,l[1]),r||(o=qe(s,"input",l[8]),r=!0)},p(f,$){$&2&&s.value!==f[1]&&Ve(s,f[1])},d(f){f&&c(e),r=!1,o()}}}function vt(l){let e=l[5](l[0]),t,a,n=e&&je(l);return{c(){n&&n.c(),t=we()},l(s){n&&n.l(s),t=we()},m(s,r){n&&n.m(s,r),P(s,t,r),a=!0},p(s,[r]){r&1&&(e=s[5](s[0])),e?n?(n.p(s,r),r&1&&w(n,1)):(n=je(s),n.c(),w(n,1),n.m(t.parentNode,t)):n&&(Be(),k(n,1,1,()=>{n=null}),Oe())},i(s){a||(w(n),a=!0)},o(s){k(n),a=!1},d(s){n&&n.d(s),s&&c(t)}}}function kt(l,e,t){let{workflow:a}=e,{namespace:n}=e,s="",r=!1;const o=()=>t(2,r=!0),f=()=>t(2,r=!1),$=b=>String(b.status)==="Running",A=()=>{t(2,r=!1),t(1,s=""),lt.add("success","Workflow Terminated"),window.location.reload()},D=()=>{ot({workflow:a,namespace:n,reason:s}).then(A).catch(at)};function E(){s=this.value,t(1,s)}return l.$$set=b=>{"workflow"in b&&t(0,a=b.workflow),"namespace"in b&&t(7,n=b.namespace)},[a,s,r,o,f,$,D,n,E]}class bt extends he{constructor(e){super();pe(this,e,kt,vt,de,{workflow:0,namespace:7})}}function Et(l){let e;return{c(){e=V(l[1])},l(t){e=C(t,l[1])},m(t,a){P(t,e,a)},p(t,a){a&2&&fe(e,t[1])},d(t){t&&c(e)}}}function It(l){let e,t,a,n;return{c(){e=V(l[1]),t=g(),a=_("span"),n=V(l[2]),this.h()},l(s){e=C(s,l[1]),t=v(s),a=h(s,"SPAN",{class:!0});var r=d(a);n=C(r,l[2]),r.forEach(c),this.h()},h(){p(a,"class","px-2 text-blue-700 bg-blue-100 rounded-sm")},m(s,r){P(s,e,r),P(s,t,r),P(s,a,r),i(a,n)},p(s,r){r&2&&fe(e,s[1]),r&4&&fe(n,s[2])},d(s){s&&c(e),s&&c(t),s&&c(a)}}}function Tt(l){let e;function t(s,r){return s[2]||s[2]===0?It:Et}let a=t(l),n=a(l);return{c(){e=_("a"),n.c(),this.h()},l(s){e=h(s,"A",{class:!0,href:!0});var r=d(e);n.l(r),r.forEach(c),this.h()},h(){p(e,"class","block svelte-tavydt"),p(e,"href",l[0]),Ce(e,"active",l[3])},m(s,r){P(s,e,r),n.m(e,null)},p(s,[r]){a===(a=t(s))&&n?n.p(s,r):(n.d(1),n=a(s),n&&(n.c(),n.m(e,null))),r&1&&p(e,"href",s[0]),r&8&&Ce(e,"active",s[3])},i:Fe,o:Fe,d(s){s&&c(e),n.d()}}}function At(l,e,t){let a,n;Je(l,rt,f=>t(4,n=f));let{href:s}=e,{label:r}=e,{amount:o=null}=e;return l.$$set=f=>{"href"in f&&t(0,s=f.href),"label"in f&&t(1,r=f.label),"amount"in f&&t(2,o=f.amount)},l.$$.update=()=>{l.$$.dirty&17&&t(3,a=n.url.pathname.includes(s))},[s,r,o,a,n]}class _e extends he{constructor(e){super();pe(this,e,At,Tt,de,{href:0,label:1,amount:2})}}function Pt(l){var ye,De,Ne;let e,t,a,n,s,r,o,f,$=l[1].name+"",A,D,E,b,B,q,y,J,ie,ee,L,N=l[1].id+"",K,z,I,u,T,W,O,G=l[1].runId+"",te,X,F,Y,ge,Z,ve,ne,ke,se,be,ae,x;return n=new Le({props:{icon:Ke}}),E=new Ge({props:{status:(ye=l[1])==null?void 0:ye.status}}),B=new bt({props:{workflow:l[1],namespace:l[0]}}),Y=new _e({props:{label:"History",href:Ye(l[2]),amount:(De=l[1])==null?void 0:De.historyEvents}}),Z=new _e({props:{label:"Pending Activities",href:Ze(l[2]),amount:(Ne=l[1].pendingActivities)==null?void 0:Ne.length}}),ne=new _e({props:{label:"Workers",href:xe(l[2])}}),se=new _e({props:{label:"Stack Trace",href:et(l[2])}}),ae=new _e({props:{label:"Query",href:tt(l[2])}}),{c(){e=_("header"),t=_("main"),a=_("a"),M(n.$$.fragment),r=g(),o=_("div"),f=_("h1"),A=V($),D=g(),M(E.$$.fragment),b=g(),M(B.$$.fragment),q=g(),y=_("p"),J=_("span"),ie=V("Workflow ID"),ee=g(),L=_("span"),K=V(N),z=g(),I=_("p"),u=_("span"),T=V("Run ID"),W=g(),O=_("span"),te=V(G),X=g(),F=_("nav"),M(Y.$$.fragment),ge=g(),M(Z.$$.fragment),ve=g(),M(ne.$$.fragment),ke=g(),M(se.$$.fragment),be=g(),M(ae.$$.fragment),this.h()},l(m){e=h(m,"HEADER",{class:!0});var S=d(e);t=h(S,"MAIN",{class:!0});var Q=d(t);a=h(Q,"A",{href:!0,class:!0,style:!0});var ce=d(a);H(n.$$.fragment,ce),ce.forEach(c),r=v(Q),o=h(Q,"DIV",{class:!0});var le=d(o);f=h(le,"H1",{class:!0});var re=d(f);A=C(re,$),D=v(re),H(E.$$.fragment,re),re.forEach(c),b=v(le),H(B.$$.fragment,le),le.forEach(c),q=v(Q),y=h(Q,"P",{class:!0});var oe=d(y);J=h(oe,"SPAN",{});var ue=d(J);ie=C(ue,"Workflow ID"),ue.forEach(c),ee=v(oe),L=h(oe,"SPAN",{class:!0});var me=d(L);K=C(me,N),me.forEach(c),oe.forEach(c),z=v(Q),I=h(Q,"P",{class:!0});var $e=d(I);u=h($e,"SPAN",{});var Se=d(u);T=C(Se,"Run ID"),Se.forEach(c),W=v($e),O=h($e,"SPAN",{class:!0});var We=d(O);te=C(We,G),We.forEach(c),$e.forEach(c),Q.forEach(c),X=v(S),F=h(S,"NAV",{class:!0});var U=d(F);H(Y.$$.fragment,U),ge=v(U),H(Z.$$.fragment,U),ve=v(U),H(ne.$$.fragment,U),ke=v(U),H(se.$$.fragment,U),be=v(U),H(ae.$$.fragment,U),U.forEach(c),S.forEach(c),this.h()},h(){p(a,"href",s="/namespaces/"+l[0]+"/workflows"),p(a,"class","absolute top-2 back-to-workflows"),ze(a,"left","-1.5rem"),p(f,"class","text-2xl"),p(o,"class","flex justify-between items-center"),p(L,"class","font-medium"),p(y,"class","text-md"),p(O,"class","font-medium"),p(I,"class","text-md"),p(t,"class","flex flex-col gap-1 relative"),p(F,"class","flex gap-6"),p(e,"class","flex flex-col gap-4")},m(m,S){P(m,e,S),i(e,t),i(t,a),R(n,a,null),i(t,r),i(t,o),i(o,f),i(f,A),i(f,D),R(E,f,null),i(o,b),R(B,o,null),i(t,q),i(t,y),i(y,J),i(J,ie),i(y,ee),i(y,L),i(L,K),i(t,z),i(t,I),i(I,u),i(u,T),i(I,W),i(I,O),i(O,te),i(e,X),i(e,F),R(Y,F,null),i(F,ge),R(Z,F,null),i(F,ve),R(ne,F,null),i(F,ke),R(se,F,null),i(F,be),R(ae,F,null),x=!0},p(m,[S]){var oe,ue,me;(!x||S&1&&s!==(s="/namespaces/"+m[0]+"/workflows"))&&p(a,"href",s),(!x||S&2)&&$!==($=m[1].name+"")&&fe(A,$);const Q={};S&2&&(Q.status=(oe=m[1])==null?void 0:oe.status),E.$set(Q);const ce={};S&2&&(ce.workflow=m[1]),S&1&&(ce.namespace=m[0]),B.$set(ce),(!x||S&2)&&N!==(N=m[1].id+"")&&fe(K,N),(!x||S&2)&&G!==(G=m[1].runId+"")&&fe(te,G);const le={};S&2&&(le.amount=(ue=m[1])==null?void 0:ue.historyEvents),Y.$set(le);const re={};S&2&&(re.amount=(me=m[1].pendingActivities)==null?void 0:me.length),Z.$set(re)},i(m){x||(w(n.$$.fragment,m),w(E.$$.fragment,m),w(B.$$.fragment,m),w(Y.$$.fragment,m),w(Z.$$.fragment,m),w(ne.$$.fragment,m),w(se.$$.fragment,m),w(ae.$$.fragment,m),x=!0)},o(m){k(n.$$.fragment,m),k(E.$$.fragment,m),k(B.$$.fragment,m),k(Y.$$.fragment,m),k(Z.$$.fragment,m),k(ne.$$.fragment,m),k(se.$$.fragment,m),k(ae.$$.fragment,m),x=!1},d(m){m&&c(e),j(n),j(E),j(B),j(Y),j(Z),j(ne),j(se),j(ae)}}}function yt(l,e,t){let{namespace:a}=e,{workflow:n}=e;const s={namespace:a,workflow:n.id,run:n.runId};return l.$$set=r=>{"namespace"in r&&t(0,a=r.namespace),"workflow"in r&&t(1,n=r.workflow)},[a,n,s]}class Dt extends he{constructor(e){super();pe(this,e,yt,Pt,de,{namespace:0,workflow:1})}}function Nt(l){let e,t,a,n;t=new Dt({props:{namespace:l[1],workflow:l[0]}});const s=l[3].default,r=Ae(s,l,l[2],null);return{c(){e=_("main"),M(t.$$.fragment),a=g(),r&&r.c(),this.h()},l(o){e=h(o,"MAIN",{class:!0});var f=d(e);H(t.$$.fragment,f),a=v(f),r&&r.l(f),f.forEach(c),this.h()},h(){p(e,"class","flex flex-col gap-6 h-full")},m(o,f){P(o,e,f),R(t,e,null),i(e,a),r&&r.m(e,null),n=!0},p(o,[f]){const $={};f&2&&($.namespace=o[1]),f&1&&($.workflow=o[0]),t.$set($),r&&r.p&&(!n||f&4)&&Ee(r,s,o,o[2],n?Te(s,o[2],f,null):Ie(o[2]),null)},i(o){n||(w(t.$$.fragment,o),w(r,o),n=!0)},o(o){k(t.$$.fragment,o),k(r,o),n=!1},d(o){o&&c(e),j(t),r&&r.d(o)}}}const Ot=async function({params:l}){const{workflow:e,run:t,namespace:a}=l,s=await Xe({namespace:a,executionId:e,runId:t},fetch);return{props:{workflow:s,namespace:a},stuff:{workflow:s}}};function St(l,e,t){let{$$slots:a={},$$scope:n}=e,{workflow:s}=e,{namespace:r}=e;return l.$$set=o=>{"workflow"in o&&t(0,s=o.workflow),"namespace"in o&&t(1,r=o.namespace),"$$scope"in o&&t(2,n=o.$$scope)},[s,r,n,a]}class Lt extends he{constructor(e){super();pe(this,e,St,Nt,de,{workflow:0,namespace:1})}}export{Lt as default,Ot as load};
