import{S as me,i as de,s as pe,e as d,t as A,k,w as q,c as p,a as h,h as N,d as f,m as b,x as B,b as $,g as P,M as n,y as M,a3 as Oe,ag as De,q as O,o as H,B as G,l as fe,O as He,v as Ne,ah as Pe,ai as Ie,aj as Le,n as Ve,p as We,E as ie,I as xe,J as Re,K as Fe,L as je}from"../../../../../../../chunks/index-9f955617.js";import{a as Je}from"../../../../../../../chunks/events-service-3b6e59c2.js";import{e as qe,a as Be,g as Me,h as Ge}from"../../../../../../../chunks/index.es-d36a04e6.js";import{f as Ke,d as se}from"../../../../../../../chunks/route-for-d606e623.js";import{i as ze}from"../../../../../../../chunks/index-a8ee0a5c.js";import{T as Qe,a as ce}from"../../../../../../../chunks/toggle-buttons-f7af497b.js";import{C as ue}from"../../../../../../../chunks/code-block-740ab0c9.js";import{p as Ue}from"../../../../../../../chunks/stores-dc10aa65.js";import{f as Xe}from"../../../../../../../chunks/format-date-a3b7d511.js";import{L as Ye}from"../../../../../../../chunks/link-f07eabff.js";import{g as Ze}from"../../../../../../../chunks/query-service-26dbda14.js";import{E as et}from"../../../../../../../chunks/empty-state-406f4743.js";import"../../../../../../../chunks/route-for-api-40822ec4.js";import"../../../../../../../chunks/navigation-3f1ea447.js";import"../../../../../../../chunks/singletons-d1fb5791.js";import"../../../../../../../chunks/index-fef70e44.js";import"../../../../../../../chunks/notifications-9be462b8.js";import"../../../../../../../chunks/is-network-error-ac7c8caf.js";import"../../../../../../../chunks/index-e58309ae.js";import"../../../../../../../chunks/data-converter-config-2b2331c2.js";import"../../../../../../../chunks/persist-store-510d175e.js";import"../../../../../../../chunks/atob-5f9d7101.js";import"../../../../../../../chunks/get-event-categorization-b2bce139.js";import"../../../../../../../chunks/simplify-attributes-42eef498.js";const tt=["WorkflowExecutionFailed","WorkflowExecutionCompleted","WorkflowExecutionContinuedAsNew","WorkflowExecutionTimedOut","WorkflowExecutionCanceled","WorkflowExecutionTerminated"],lt=a=>{for(const e of tt)if(a.eventType===e)return!0;return!1},rt=a=>{for(const e of a)if(lt(e))return e},st=a=>ze(a)?a.attributes.result===null?null:a.attributes.result.payloads:a.attributes,ot=a=>{var o,c;let e,t;const l=a==null?void 0:a.find(i=>!!i.workflowExecutionStartedEventAttributes),r=rt(a);return l&&(e=JSON.stringify((c=(o=l==null?void 0:l.workflowExecutionStartedEventAttributes)==null?void 0:o.input)==null?void 0:c.payloads)),r&&(t=JSON.stringify(st(r))),{input:e,result:t}};function Se(a,e,t){const l=a.slice();return l[6]=e[t].id,l[7]=Pe(e[t],["id"]),l}function at(a){let e,t,l,r,o,c=[],i=new Map,m,s,u,w,I=a[0];const y=g=>g[6];for(let g=0;g<I.length;g+=1){let _=Se(a,I,g),T=y(_);i.set(T,c[g]=Ce(T,_))}return u=new Ye({props:{href:a[1],$$slots:{default:[nt]},$$scope:{ctx:a}}}),{c(){e=d("section"),t=d("h3"),l=A("Pending Activities"),r=k(),o=d("section");for(let g=0;g<c.length;g+=1)c[g].c();m=k(),s=d("div"),q(u.$$.fragment),this.h()},l(g){e=p(g,"SECTION",{class:!0});var _=h(e);t=p(_,"H3",{class:!0});var T=h(t);l=N(T,"Pending Activities"),T.forEach(f),r=b(_),o=p(_,"SECTION",{class:!0});var D=h(o);for(let S=0;S<c.length;S+=1)c[S].l(D);D.forEach(f),m=b(_),s=p(_,"DIV",{class:!0});var L=h(s);B(u.$$.fragment,L),L.forEach(f),_.forEach(f),this.h()},h(){$(t,"class","text-lg font-medium mb-4"),$(o,"class","w-full table-auto space-x-4"),$(s,"class","text-right"),$(e,"class","border-2 border-gray-300 rounded-lg p-4")},m(g,_){P(g,e,_),n(e,t),n(t,l),n(e,r),n(e,o);for(let T=0;T<c.length;T+=1)c[T].m(o,null);n(e,m),n(e,s),M(u,s,null),w=!0},p(g,_){_&3&&(I=g[0],c=Oe(c,_,y,1,g,I,i,o,De,Ce,null,Se));const T={};_&1024&&(T.$$scope={dirty:_,ctx:g}),u.$set(T)},i(g){w||(O(u.$$.fragment,g),w=!0)},o(g){H(u.$$.fragment,g),w=!1},d(g){g&&f(e);for(let _=0;_<c.length;_+=1)c[_].d();G(u)}}}function Ce(a,e){var le,ee;let t,l,r=e[7].activityId+"",o,c,i,m,s,u,w,I,y,g=e[7].activityType+"",_,T,D,L,S,R,K,z,Q,U=((ee=(le=e[7].lastFailure)==null?void 0:le.message)!=null?ee:"")+"",F,Z,x,j,C,v,E,W,X=Xe(e[7].lastHeartbeatTime)+"",te,Y;return{key:a,first:null,c(){t=d("a"),l=d("div"),o=A(r),c=k(),i=d("div"),m=d("div"),s=d("h4"),u=A("Activity Name"),w=k(),I=d("p"),y=d("span"),_=A(g),T=k(),D=d("div"),L=d("div"),S=d("h3"),R=A("Last Failure"),K=k(),z=d("pre"),Q=d("code"),F=A(U),Z=k(),x=d("div"),j=d("div"),C=d("h4"),v=A("Last Heartbeat Time"),E=k(),W=d("p"),te=A(X),Y=k(),this.h()},l(J){t=p(J,"A",{class:!0,href:!0});var V=h(t);l=p(V,"DIV",{class:!0});var re=h(l);o=N(re,r),re.forEach(f),c=b(V),i=p(V,"DIV",{class:!0});var he=h(i);m=p(he,"DIV",{class:!0});var oe=h(m);s=p(oe,"H4",{});var ge=h(s);u=N(ge,"Activity Name"),ge.forEach(f),w=b(oe),I=p(oe,"P",{});var _e=h(I);y=p(_e,"SPAN",{class:!0});var $e=h(y);_=N($e,g),$e.forEach(f),_e.forEach(f),oe.forEach(f),he.forEach(f),T=b(V),D=p(V,"DIV",{class:!0});var ve=h(D);L=p(ve,"DIV",{class:!0});var ae=h(L);S=p(ae,"H3",{class:!0});var we=h(S);R=N(we,"Last Failure"),we.forEach(f),K=b(ae),z=p(ae,"PRE",{class:!0});var ke=h(z);Q=p(ke,"CODE",{class:!0});var be=h(Q);F=N(be,U),be.forEach(f),ke.forEach(f),ae.forEach(f),ve.forEach(f),Z=b(V),x=p(V,"DIV",{class:!0});var Ee=h(x);j=p(Ee,"DIV",{class:!0});var ne=h(j);C=p(ne,"H4",{});var ye=h(C);v=N(ye,"Last Heartbeat Time"),ye.forEach(f),E=b(ne),W=p(ne,"P",{});var Te=h(W);te=N(Te,X),Te.forEach(f),ne.forEach(f),Ee.forEach(f),Y=b(V),V.forEach(f),this.h()},h(){$(l,"class","md:w-1/12 text-left font-normal text-gray-500 w-40"),$(y,"class","bg-gray-300 text-gray-700 px-2"),$(m,"class","flex gap-2"),$(i,"class","w-full md:w-1/4"),$(S,"class","whitespace-nowrap"),$(Q,"class","language-json"),$(z,"class","w-full rounded-lg"),$(L,"class","flex gap-2 items-center"),$(D,"class","w-full md:w-5/12"),$(j,"class","flex gap-2"),$(x,"class","w-full md:w-1/4"),$(t,"class","block md:flex content-between w-full border-b-2 border-gray-300 p-2 last-of-type:border-b-0 hover:bg-gray-50 gap-4 items-center"),$(t,"href",e[1]),this.first=t},m(J,V){P(J,t,V),n(t,l),n(l,o),n(t,c),n(t,i),n(i,m),n(m,s),n(s,u),n(m,w),n(m,I),n(I,y),n(y,_),n(t,T),n(t,D),n(D,L),n(L,S),n(S,R),n(L,K),n(L,z),n(z,Q),n(Q,F),n(t,Z),n(t,x),n(x,j),n(j,C),n(C,v),n(j,E),n(j,W),n(W,te),n(t,Y)},p(J,V){e=J},d(J){J&&f(t)}}}function nt(a){let e;return{c(){e=A("Show all")},l(t){e=N(t,"Show all")},m(t,l){P(t,e,l)},d(t){t&&f(e)}}}function ct(a){let e,t,l=a[0].length&&at(a);return{c(){l&&l.c(),e=fe()},l(r){l&&l.l(r),e=fe()},m(r,o){l&&l.m(r,o),P(r,e,o),t=!0},p(r,[o]){r[0].length&&l.p(r,o)},i(r){t||(O(l),t=!0)},o(r){H(l),t=!1},d(r){l&&l.d(r),r&&f(e)}}}function it(a,e,t){let l;He(a,Ue,s=>t(2,l=s));const{pendingActivities:r}=l.stuff.workflow,{namespace:o,workflow:c,run:i}=l.params,m=Ke({namespace:o,workflow:c,run:i});return Ne(()=>{window.Prism.highlightAll()}),[r,m]}class ft extends me{constructor(e){super(),de(this,e,it,ct,pe,{})}}function Ae(a){let e,t,l,r,o,c,i={ctx:a,current:null,token:null,hasCatch:!0,pending:dt,then:mt,catch:ut,value:3,error:4,blocks:[,,,]};return Ie(o=a[1],i),{c(){e=d("section"),t=d("h3"),l=A("Stack Trace"),r=k(),i.block.c(),this.h()},l(m){e=p(m,"SECTION",{class:!0});var s=h(e);t=p(s,"H3",{class:!0});var u=h(t);l=N(u,"Stack Trace"),u.forEach(f),r=b(s),i.block.l(s),s.forEach(f),this.h()},h(){$(t,"class","text-lg mb-2 w-full"),$(e,"class","stack-trace svelte-18yyc2q")},m(m,s){P(m,e,s),n(e,t),n(t,l),n(e,r),i.block.m(e,i.anchor=null),i.mount=()=>e,i.anchor=null,c=!0},p(m,s){a=m,i.ctx=a,s&2&&o!==(o=a[1])&&Ie(o,i)||Le(i,a,s)},i(m){c||(O(i.block),c=!0)},o(m){for(let s=0;s<3;s+=1){const u=i.blocks[s];H(u)}c=!1},d(m){m&&f(e),i.block.d(),i.token=null,i=null}}}function ut(a){let e,t;return e=new et({props:{title:"An Error Occured",content:"Please make sure you have at least one worker running."}}),{c(){q(e.$$.fragment)},l(l){B(e.$$.fragment,l)},m(l,r){M(e,l,r),t=!0},p:ie,i(l){t||(O(e.$$.fragment,l),t=!0)},o(l){H(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function mt(a){let e,t,l;return t=new ue({props:{content:a[3],language:"text"}}),{c(){e=d("div"),q(t.$$.fragment),this.h()},l(r){e=p(r,"DIV",{class:!0});var o=h(e);B(t.$$.fragment,o),o.forEach(f),this.h()},h(){$(e,"class","flex items-start h-full")},m(r,o){P(r,e,o),M(t,e,null),l=!0},p(r,o){const c={};o&2&&(c.content=r[3]),t.$set(c)},i(r){l||(O(t.$$.fragment,r),l=!0)},o(r){H(t.$$.fragment,r),l=!1},d(r){r&&f(e),G(t)}}}function dt(a){let e,t,l,r,o,c;return{c(){e=d("div"),t=d("h2"),l=A("Loading\u2026"),r=k(),o=d("p"),c=A("(This will fail if you have no workers running.)"),this.h()},l(i){e=p(i,"DIV",{class:!0});var m=h(e);t=p(m,"H2",{class:!0});var s=h(t);l=N(s,"Loading\u2026"),s.forEach(f),r=b(m),o=p(m,"P",{});var u=h(o);c=N(u,"(This will fail if you have no workers running.)"),u.forEach(f),m.forEach(f),this.h()},h(){$(t,"class","font-bold text-2xl mb-4"),$(e,"class","text-center")},m(i,m){P(i,e,m),n(e,t),n(t,l),n(e,r),n(e,o),n(o,c)},p:ie,i:ie,o:ie,d(i){i&&f(e)}}}function pt(a){let e=String(a[0].status)==="Running",t,l,r=e&&Ae(a);return{c(){r&&r.c(),t=fe()},l(o){r&&r.l(o),t=fe()},m(o,c){r&&r.m(o,c),P(o,t,c),l=!0},p(o,[c]){c&1&&(e=String(o[0].status)==="Running"),e?r?(r.p(o,c),c&1&&O(r,1)):(r=Ae(o),r.c(),O(r,1),r.m(t.parentNode,t)):r&&(Ve(),H(r,1,1,()=>{r=null}),We())},i(o){l||(O(r),l=!0)},o(o){H(r),l=!1},d(o){r&&r.d(o),o&&f(t)}}}function ht(a,e,t){let{namespace:l}=e,{workflow:r}=e,o;return Ne(()=>{t(1,o=(()=>Ze({workflow:r,namespace:l}))())}),a.$$set=c=>{"namespace"in c&&t(2,l=c.namespace),"workflow"in c&&t(0,r=c.workflow)},[r,o,l]}class gt extends me{constructor(e){super(),de(this,e,ht,pt,pe,{namespace:2,workflow:0})}}function _t(a){let e;return{c(){e=A("Summary")},l(t){e=N(t,"Summary")},m(t,l){P(t,e,l)},d(t){t&&f(e)}}}function $t(a){let e;return{c(){e=A("Full")},l(t){e=N(t,"Full")},m(t,l){P(t,e,l)},d(t){t&&f(e)}}}function vt(a){let e;return{c(){e=A("Compact")},l(t){e=N(t,"Compact")},m(t,l){P(t,e,l)},d(t){t&&f(e)}}}function wt(a){let e;return{c(){e=A("JSON")},l(t){e=N(t,"JSON")},m(t,l){P(t,e,l)},d(t){t&&f(e)}}}function kt(a){let e,t,l,r,o,c,i,m;return e=new ce({props:{icon:qe,base:se(a[4]("summary")),href:se(a[4]("summary")),$$slots:{default:[_t]},$$scope:{ctx:a}}}),l=new ce({props:{icon:Be,href:se(a[4]("full")),$$slots:{default:[$t]},$$scope:{ctx:a}}}),o=new ce({props:{icon:Me,href:se(a[4]("compact")),$$slots:{default:[vt]},$$scope:{ctx:a}}}),i=new ce({props:{icon:Ge,href:se(a[4]("json")),$$slots:{default:[wt]},$$scope:{ctx:a}}}),{c(){q(e.$$.fragment),t=k(),q(l.$$.fragment),r=k(),q(o.$$.fragment),c=k(),q(i.$$.fragment)},l(s){B(e.$$.fragment,s),t=b(s),B(l.$$.fragment,s),r=b(s),B(o.$$.fragment,s),c=b(s),B(i.$$.fragment,s)},m(s,u){M(e,s,u),P(s,t,u),M(l,s,u),P(s,r,u),M(o,s,u),P(s,c,u),M(i,s,u),m=!0},p(s,u){const w={};u&128&&(w.$$scope={dirty:u,ctx:s}),e.$set(w);const I={};u&128&&(I.$$scope={dirty:u,ctx:s}),l.$set(I);const y={};u&128&&(y.$$scope={dirty:u,ctx:s}),o.$set(y);const g={};u&128&&(g.$$scope={dirty:u,ctx:s}),i.$set(g)},i(s){m||(O(e.$$.fragment,s),O(l.$$.fragment,s),O(o.$$.fragment,s),O(i.$$.fragment,s),m=!0)},o(s){H(e.$$.fragment,s),H(l.$$.fragment,s),H(o.$$.fragment,s),H(i.$$.fragment,s),m=!1},d(s){G(e,s),s&&f(t),G(l,s),s&&f(r),G(o,s),s&&f(c),G(i,s)}}}function bt(a){let e,t,l,r,o,c,i,m,s,u,w,I,y,g,_,T,D,L,S,R,K,z,Q,U,F,Z,x;i=new ue({props:{content:a[2]}}),y=new ue({props:{content:a[3]}}),_=new gt({props:{namespace:a[0],workflow:a[1]}}),D=new ft({}),F=new Qe({props:{$$slots:{default:[kt]},$$scope:{ctx:a}}});const j=a[6].default,C=xe(j,a,a[7],null);return{c(){e=d("section"),t=d("section"),l=d("article"),r=d("h3"),o=A("Input"),c=k(),q(i.$$.fragment),m=k(),s=d("article"),u=d("h3"),w=A("Results"),I=k(),q(y.$$.fragment),g=k(),q(_.$$.fragment),T=k(),q(D.$$.fragment),L=k(),S=d("section"),R=d("nav"),K=d("h3"),z=A("Recent Events"),Q=k(),U=d("div"),q(F.$$.fragment),Z=k(),C&&C.c(),this.h()},l(v){e=p(v,"SECTION",{class:!0});var E=h(e);t=p(E,"SECTION",{class:!0});var W=h(t);l=p(W,"ARTICLE",{class:!0});var X=h(l);r=p(X,"H3",{class:!0});var te=h(r);o=N(te,"Input"),te.forEach(f),c=b(X),B(i.$$.fragment,X),X.forEach(f),m=b(W),s=p(W,"ARTICLE",{class:!0});var Y=h(s);u=p(Y,"H3",{class:!0});var le=h(u);w=N(le,"Results"),le.forEach(f),I=b(Y),B(y.$$.fragment,Y),Y.forEach(f),W.forEach(f),g=b(E),B(_.$$.fragment,E),T=b(E),B(D.$$.fragment,E),L=b(E),S=p(E,"SECTION",{id:!0});var ee=h(S);R=p(ee,"NAV",{class:!0});var J=h(R);K=p(J,"H3",{class:!0});var V=h(K);z=N(V,"Recent Events"),V.forEach(f),Q=b(J),U=p(J,"DIV",{id:!0,class:!0});var re=h(U);B(F.$$.fragment,re),re.forEach(f),J.forEach(f),Z=b(ee),C&&C.l(ee),ee.forEach(f),E.forEach(f),this.h()},h(){$(r,"class","text-lg"),$(l,"class","border-2 border-gray-300 p-4 rounded-lg w-full"),$(u,"class","text-lg"),$(s,"class","border-2 border-gray-300 p-4 rounded-lg w-full"),$(t,"class","flex flex-col md:flex-row gap-4 w-full"),$(K,"class","text-lg font-medium"),$(U,"id","event-view-toggle"),$(U,"class","flex gap-4"),$(R,"class","flex gap-4 justify-between items-end pb-4"),$(S,"id","event-history"),$(e,"class","flex flex-col gap-4")},m(v,E){P(v,e,E),n(e,t),n(t,l),n(l,r),n(r,o),n(l,c),M(i,l,null),n(t,m),n(t,s),n(s,u),n(u,w),n(s,I),M(y,s,null),n(e,g),M(_,e,null),n(e,T),M(D,e,null),n(e,L),n(e,S),n(S,R),n(R,K),n(K,z),n(R,Q),n(R,U),M(F,U,null),n(S,Z),C&&C.m(S,null),x=!0},p(v,[E]){const W={};E&1&&(W.namespace=v[0]),E&2&&(W.workflow=v[1]),_.$set(W);const X={};E&128&&(X.$$scope={dirty:E,ctx:v}),F.$set(X),C&&C.p&&(!x||E&128)&&Re(C,j,v,v[7],x?je(j,v[7],E,null):Fe(v[7]),null)},i(v){x||(O(i.$$.fragment,v),O(y.$$.fragment,v),O(_.$$.fragment,v),O(D.$$.fragment,v),O(F.$$.fragment,v),O(C,v),x=!0)},o(v){H(i.$$.fragment,v),H(y.$$.fragment,v),H(_.$$.fragment,v),H(D.$$.fragment,v),H(F.$$.fragment,v),H(C,v),x=!1},d(v){v&&f(e),G(i),G(y),G(_),G(D),G(F),C&&C.d(v)}}}const zt=async function({params:a,url:e,stuff:t,fetch:l}){var r;const{workflow:o}=t,{namespace:c}=a,i={namespace:c,workflowId:o.id,runId:o.runId,reverse:Boolean((r=e==null?void 0:e.searchParams)===null||r===void 0?void 0:r.get("sort"))},{events:m,eventGroups:s}=await Je(i,l);return{props:{namespace:c,workflow:o,events:m,eventGroups:s},stuff:{events:m,eventGroups:s}}};function Et(a,e,t){let{$$slots:l={},$$scope:r}=e,{namespace:o}=e,{workflow:c}=e,{events:i}=e;const{input:m,result:s}=ot(i),u=(w,I)=>({namespace:o,workflow:c.id,run:c.runId,view:w,eventId:I});return a.$$set=w=>{"namespace"in w&&t(0,o=w.namespace),"workflow"in w&&t(1,c=w.workflow),"events"in w&&t(5,i=w.events),"$$scope"in w&&t(7,r=w.$$scope)},[o,c,m,s,u,i,l,r]}class Qt extends me{constructor(e){super(),de(this,e,Et,bt,pe,{namespace:0,workflow:1,events:5})}}export{Qt as default,zt as load};
