import{S as se,i as re,s as le,w as I,x as A,y,q as $,o as v,B as S,l as Ie,g as T,n as Ne,p as Pe,d as m,t as N,h as P,e as _,c as h,a as p,b as w,U as Ae,T as ye,I as Te,j as K,k as g,m as k,L as u,P as We,aA as De,f as Fe,K as Re,M as qe,N as He,O as Be}from"../../../../../../chunks/vendor-ff19c65d.js";import{W as Me,a as Oe}from"../../../../../../chunks/workflow-status-5939b39b.js";import{r as X}from"../../../../../../chunks/route-for-6434eb2e.js";import{g as je}from"../../../../../../chunks/navigation-093db9e2.js";import{r as Ce,a as Le,h as Ve}from"../../../../../../chunks/route-for-api-41dce74a.js";import{n as Je}from"../../../../../../chunks/notifications-089fbae0.js";import{B as Ke}from"../../../../../../chunks/button-fcd14ccb.js";import{p as Qe}from"../../../../../../chunks/stores-4aa32d62.js";import"../../../../../../chunks/singletons-a6a7384f.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";async function Ue({workflow:r,namespace:e,reason:a}){return await Ce(Le("workflow.terminate",{namespace:e,executionId:r.id,runId:r.runId}),{options:{method:"POST",body:JSON.stringify({reason:a})},shouldRetry:!1})}function Se(r){let e,a;return e=new Ke({props:{destroy:!0,$$slots:{default:[ze]},$$scope:{ctx:r}}}),e.$on("click",r[2]),{c(){I(e.$$.fragment)},l(s){A(e.$$.fragment,s)},m(s,t){y(e,s,t),a=!0},p(s,t){const n={};t&64&&(n.$$scope={dirty:t,ctx:s}),e.$set(n)},i(s){a||($(e.$$.fragment,s),a=!0)},o(s){v(e.$$.fragment,s),a=!1},d(s){S(e,s)}}}function ze(r){let e;return{c(){e=N("Terminate")},l(a){e=P(a,"Terminate")},m(a,s){T(a,e,s)},d(a){a&&m(e)}}}function Ge(r){let e=r[1](r[0]),a,s,t=e&&Se(r);return{c(){t&&t.c(),a=Ie()},l(n){t&&t.l(n),a=Ie()},m(n,l){t&&t.m(n,l),T(n,a,l),s=!0},p(n,[l]){l&1&&(e=n[1](n[0])),e?t?(t.p(n,l),l&1&&$(t,1)):(t=Se(n),t.c(),$(t,1),t.m(a.parentNode,a)):t&&(Ne(),v(t,1,1,()=>{t=null}),Pe())},i(n){s||($(t),s=!0)},o(n){v(t),s=!1},d(n){t&&t.d(n),n&&m(a)}}}function Xe(r,e,a){let{workflow:s}=e,{namespace:t}=e,n="";const l=c=>String(c.status)==="Running",o=()=>{n="",Je.add("success","Workflow Terminated"),je(X("workflow",{namespace:t,workflowId:s.id,runId:s.runId}))},f=()=>{Ue({workflow:s,namespace:t,reason:n}).then(o).catch(Ve)};return r.$$set=c=>{"workflow"in c&&a(0,s=c.workflow),"namespace"in c&&a(3,t=c.namespace)},[s,l,f,t]}class Ye extends se{constructor(e){super();re(this,e,Xe,Ge,le,{workflow:0,namespace:3})}}function Ze(r){let e;return{c(){e=N(r[1])},l(a){e=P(a,r[1])},m(a,s){T(a,e,s)},p(a,s){s&2&&K(e,a[1])},d(a){a&&m(e)}}}function xe(r){let e,a,s,t;return{c(){e=N(r[1]),a=g(),s=_("span"),t=N(r[2]),this.h()},l(n){e=P(n,r[1]),a=k(n),s=h(n,"SPAN",{class:!0});var l=p(s);t=P(l,r[2]),l.forEach(m),this.h()},h(){w(s,"class","px-2 text-blue-700 bg-blue-100 rounded-sm")},m(n,l){T(n,e,l),T(n,a,l),T(n,s,l),u(s,t)},p(n,l){l&2&&K(e,n[1]),l&4&&K(t,n[2])},d(n){n&&m(e),n&&m(a),n&&m(s)}}}function et(r){let e;function a(n,l){return n[2]?xe:Ze}let s=a(r),t=s(r);return{c(){e=_("a"),t.c(),this.h()},l(n){e=h(n,"A",{class:!0,href:!0});var l=p(e);t.l(l),l.forEach(m),this.h()},h(){w(e,"class","block svelte-tavydt"),w(e,"href",r[0]),Ae(e,"active",r[3])},m(n,l){T(n,e,l),t.m(e,null)},p(n,[l]){s===(s=a(n))&&t?t.p(n,l):(t.d(1),t=s(n),t&&(t.c(),t.m(e,null))),l&1&&w(e,"href",n[0]),l&8&&Ae(e,"active",n[3])},i:ye,o:ye,d(n){n&&m(e),t.d()}}}function tt(r,e,a){let s,t;Te(r,Qe,f=>a(4,t=f));let{href:n}=e,{label:l}=e,{amount:o=null}=e;return r.$$set=f=>{"href"in f&&a(0,n=f.href),"label"in f&&a(1,l=f.label),"amount"in f&&a(2,o=f.amount)},r.$$.update=()=>{r.$$.dirty&17&&a(3,s=t.url.pathname.includes(n))},[n,l,o,s,t]}class ne extends se{constructor(e){super();re(this,e,tt,et,le,{href:0,label:1,amount:2})}}function at(r){var ke;let e,a,s,t,n,l,o,f,c=r[1].name+"",Y,oe,W,fe,D,ie,F,Q,ue,me,L,U=r[1].id+"",Z,ce,R,z,we,_e,V,G=r[1].runId+"",x,he,b,B,pe,M,de,O,ge,j,q;return t=new We({props:{icon:De}}),W=new Me({props:{status:(ke=r[1])==null?void 0:ke.status}}),D=new Ye({props:{workflow:r[1],namespace:r[0]}}),B=new ne({props:{label:"History",href:X("workflow.events",r[3]),amount:r[2]}}),M=new ne({props:{label:"Workers",href:X("workers",r[3])}}),O=new ne({props:{label:"Stack Trace",href:X("workflow.stack-trace",r[3])}}),j=new ne({props:{label:"Query",href:X("workflow.query",r[3])}}),{c(){e=_("header"),a=_("main"),s=_("a"),I(t.$$.fragment),l=g(),o=_("div"),f=_("h1"),Y=N(c),oe=g(),I(W.$$.fragment),fe=g(),I(D.$$.fragment),ie=g(),F=_("p"),Q=_("span"),ue=N("Workflow ID"),me=g(),L=_("span"),Z=N(U),ce=g(),R=_("p"),z=_("span"),we=N("Run ID"),_e=g(),V=_("span"),x=N(G),he=g(),b=_("nav"),I(B.$$.fragment),pe=g(),I(M.$$.fragment),de=g(),I(O.$$.fragment),ge=g(),I(j.$$.fragment),this.h()},l(i){e=h(i,"HEADER",{class:!0});var d=p(e);a=h(d,"MAIN",{class:!0});var E=p(a);s=h(E,"A",{href:!0,class:!0,style:!0});var J=p(s);A(t.$$.fragment,J),J.forEach(m),l=k(E),o=h(E,"DIV",{class:!0});var C=p(o);f=h(C,"H1",{class:!0});var ee=p(f);Y=P(ee,c),oe=k(ee),A(W.$$.fragment,ee),ee.forEach(m),fe=k(C),A(D.$$.fragment,C),C.forEach(m),ie=k(E),F=h(E,"P",{class:!0});var te=p(F);Q=h(te,"SPAN",{});var $e=p(Q);ue=P($e,"Workflow ID"),$e.forEach(m),me=k(te),L=h(te,"SPAN",{class:!0});var be=p(L);Z=P(be,U),be.forEach(m),te.forEach(m),ce=k(E),R=h(E,"P",{class:!0});var ae=p(R);z=h(ae,"SPAN",{});var ve=p(z);we=P(ve,"Run ID"),ve.forEach(m),_e=k(ae),V=h(ae,"SPAN",{class:!0});var Ee=p(V);x=P(Ee,G),Ee.forEach(m),ae.forEach(m),E.forEach(m),he=k(d),b=h(d,"NAV",{class:!0});var H=p(b);A(B.$$.fragment,H),pe=k(H),A(M.$$.fragment,H),de=k(H),A(O.$$.fragment,H),ge=k(H),A(j.$$.fragment,H),H.forEach(m),d.forEach(m),this.h()},h(){w(s,"href",n="/namespaces/"+r[0]+"/workflows"),w(s,"class","absolute top-2 back-to-workflows"),Fe(s,"left","-1.5rem"),w(f,"class","text-2xl"),w(o,"class","flex justify-between items-center"),w(L,"class","font-medium"),w(F,"class","text-md"),w(V,"class","font-medium"),w(R,"class","text-md"),w(a,"class","flex flex-col gap-1 relative"),w(b,"class","flex gap-6"),w(e,"class","flex flex-col gap-4")},m(i,d){T(i,e,d),u(e,a),u(a,s),y(t,s,null),u(a,l),u(a,o),u(o,f),u(f,Y),u(f,oe),y(W,f,null),u(o,fe),y(D,o,null),u(a,ie),u(a,F),u(F,Q),u(Q,ue),u(F,me),u(F,L),u(L,Z),u(a,ce),u(a,R),u(R,z),u(z,we),u(R,_e),u(R,V),u(V,x),u(e,he),u(e,b),y(B,b,null),u(b,pe),y(M,b,null),u(b,de),y(O,b,null),u(b,ge),y(j,b,null),q=!0},p(i,[d]){var C;(!q||d&1&&n!==(n="/namespaces/"+i[0]+"/workflows"))&&w(s,"href",n),(!q||d&2)&&c!==(c=i[1].name+"")&&K(Y,c);const E={};d&2&&(E.status=(C=i[1])==null?void 0:C.status),W.$set(E);const J={};d&2&&(J.workflow=i[1]),d&1&&(J.namespace=i[0]),D.$set(J),(!q||d&2)&&U!==(U=i[1].id+"")&&K(Z,U),(!q||d&2)&&G!==(G=i[1].runId+"")&&K(x,G)},i(i){q||($(t.$$.fragment,i),$(W.$$.fragment,i),$(D.$$.fragment,i),$(B.$$.fragment,i),$(M.$$.fragment,i),$(O.$$.fragment,i),$(j.$$.fragment,i),q=!0)},o(i){v(t.$$.fragment,i),v(W.$$.fragment,i),v(D.$$.fragment,i),v(B.$$.fragment,i),v(M.$$.fragment,i),v(O.$$.fragment,i),v(j.$$.fragment,i),q=!1},d(i){i&&m(e),S(t),S(W),S(D),S(B),S(M),S(O),S(j)}}}function nt(r,e,a){let{namespace:s}=e,{workflow:t}=e;const{id:n,runId:l}=t,o=t==null?void 0:t.historyEvents,f={namespace:s,workflowId:n,runId:l};return r.$$set=c=>{"namespace"in c&&a(0,s=c.namespace),"workflow"in c&&a(1,t=c.workflow)},[s,t,o,f]}class st extends se{constructor(e){super();re(this,e,nt,at,le,{namespace:0,workflow:1})}}function rt(r){let e,a,s,t;a=new st({props:{namespace:r[1],workflow:r[0]}});const n=r[3].default,l=Re(n,r,r[2],null);return{c(){e=_("main"),I(a.$$.fragment),s=g(),l&&l.c(),this.h()},l(o){e=h(o,"MAIN",{class:!0});var f=p(e);A(a.$$.fragment,f),s=k(f),l&&l.l(f),f.forEach(m),this.h()},h(){w(e,"class","flex flex-col gap-6 h-full")},m(o,f){T(o,e,f),y(a,e,null),u(e,s),l&&l.m(e,null),t=!0},p(o,[f]){const c={};f&2&&(c.namespace=o[1]),f&1&&(c.workflow=o[0]),a.$set(c),l&&l.p&&(!t||f&4)&&qe(l,n,o,o[2],t?Be(n,o[2],f,null):He(o[2]),null)},i(o){t||($(a.$$.fragment,o),$(l,o),t=!0)},o(o){v(a.$$.fragment,o),v(l,o),t=!1},d(o){o&&m(e),S(a),l&&l.d(o)}}}const dt=async function({params:r}){const{workflow:e,run:a,namespace:s}=r,n=await Oe({namespace:s,executionId:e,runId:a},fetch);return{props:{workflow:n,namespace:s},stuff:{workflow:n}}};function lt(r,e,a){let{$$slots:s={},$$scope:t}=e,{workflow:n}=e,{namespace:l}=e;return r.$$set=o=>{"workflow"in o&&a(0,n=o.workflow),"namespace"in o&&a(1,l=o.namespace),"$$scope"in o&&a(2,t=o.$$scope)},[n,l,t,s]}class gt extends se{constructor(e){super();re(this,e,lt,rt,le,{workflow:0,namespace:1})}}export{gt as default,dt as load};
