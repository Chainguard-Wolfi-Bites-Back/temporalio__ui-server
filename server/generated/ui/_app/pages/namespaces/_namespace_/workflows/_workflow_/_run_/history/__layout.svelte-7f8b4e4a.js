import{S as ye,i as Ie,s as Ce,e as $,t as D,k as I,w as F,c as h,a as v,h as O,d as c,m as C,x as L,b as E,g as V,M as l,y as J,a3 as Se,ag as Te,q as W,o as x,B as R,l as we,O as Ae,v as Ne,ah as De,I as Oe,J as Pe,K as Ve,L as He}from"../../../../../../../chunks/index-f021a159.js";import{a as We}from"../../../../../../../chunks/events-service-5da60d2c.js";import{b as xe,c as Fe,d as Le,e as Je}from"../../../../../../../chunks/index.es-3049caa8.js";import{f as Re,d as U}from"../../../../../../../chunks/route-for-d606e623.js";import{i as je}from"../../../../../../../chunks/index-a8ee0a5c.js";import{T as Be,a as ee}from"../../../../../../../chunks/toggle-buttons-fb12271e.js";import{C as Ee}from"../../../../../../../chunks/code-block-fb92f050.js";import{p as Me}from"../../../../../../../chunks/stores-2e95f632.js";import{f as qe}from"../../../../../../../chunks/format-date-a3b7d511.js";import{L as Ge}from"../../../../../../../chunks/link-f8fe0e86.js";import"../../../../../../../chunks/route-for-api-92604397.js";import"../../../../../../../chunks/navigation-3f1ea447.js";import"../../../../../../../chunks/singletons-d1fb5791.js";import"../../../../../../../chunks/index-cfbcd7ef.js";import"../../../../../../../chunks/notifications-0558c095.js";import"../../../../../../../chunks/is-network-error-ac7c8caf.js";import"../../../../../../../chunks/index-04d70d1c.js";import"../../../../../../../chunks/data-converter-config-fb2097df.js";import"../../../../../../../chunks/persist-store-210df7c0.js";import"../../../../../../../chunks/atob-5f9d7101.js";import"../../../../../../../chunks/get-event-categorization-b2bce139.js";import"../../../../../../../chunks/simplify-attributes-42eef498.js";const Ke=["WorkflowExecutionFailed","WorkflowExecutionCompleted","WorkflowExecutionContinuedAsNew","WorkflowExecutionTimedOut","WorkflowExecutionCanceled","WorkflowExecutionTerminated"],ze=r=>{for(const e of Ke)if(r.eventType===e)return!0;return!1},Qe=r=>{for(const e of r)if(ze(e))return e},Ue=r=>je(r)?r.attributes.result===null?null:r.attributes.result.payloads:r.attributes,Xe=r=>{var a,u;let e,t;const o=r==null?void 0:r.find(m=>!!m.workflowExecutionStartedEventAttributes),n=Qe(r);return o&&(e=JSON.stringify((u=(a=o==null?void 0:o.workflowExecutionStartedEventAttributes)==null?void 0:a.input)==null?void 0:u.payloads)),n&&(t=JSON.stringify(Ue(n))),{input:e,result:t}};function be(r,e,t){const o=r.slice();return o[6]=e[t].id,o[7]=De(e[t],["id"]),o}function Ye(r){let e,t,o,n,a,u=[],m=new Map,g,s,i,p,k=r[0];const S=f=>f[6];for(let f=0;f<k.length;f+=1){let d=be(r,k,f),b=S(d);m.set(b,u[f]=ke(b,d))}return i=new Ge({props:{href:r[1],$$slots:{default:[Ze]},$$scope:{ctx:r}}}),{c(){e=$("section"),t=$("h3"),o=D("Pending Activities"),n=I(),a=$("section");for(let f=0;f<u.length;f+=1)u[f].c();g=I(),s=$("div"),F(i.$$.fragment),this.h()},l(f){e=h(f,"SECTION",{class:!0});var d=v(e);t=h(d,"H3",{class:!0});var b=v(t);o=O(b,"Pending Activities"),b.forEach(c),n=C(d),a=h(d,"SECTION",{class:!0});var T=v(a);for(let w=0;w<u.length;w+=1)u[w].l(T);T.forEach(c),g=C(d),s=h(d,"DIV",{class:!0});var A=v(s);L(i.$$.fragment,A),A.forEach(c),d.forEach(c),this.h()},h(){E(t,"class","text-lg font-medium mb-4"),E(a,"class","w-full table-auto space-x-4"),E(s,"class","text-right"),E(e,"class","border-2 border-gray-300 rounded-lg p-4")},m(f,d){V(f,e,d),l(e,t),l(t,o),l(e,n),l(e,a);for(let b=0;b<u.length;b+=1)u[b].m(a,null);l(e,g),l(e,s),J(i,s,null),p=!0},p(f,d){d&3&&(k=f[0],u=Se(u,d,S,1,f,k,m,a,Te,ke,null,be));const b={};d&1024&&(b.$$scope={dirty:d,ctx:f}),i.$set(b)},i(f){p||(W(i.$$.fragment,f),p=!0)},o(f){x(i.$$.fragment,f),p=!1},d(f){f&&c(e);for(let d=0;d<u.length;d+=1)u[d].d();R(i)}}}function ke(r,e){var le,ne;let t,o,n=e[7].activityId+"",a,u,m,g,s,i,p,k,S,f=e[7].activityType+"",d,b,T,A,w,_,y,N,H,B=((ne=(le=e[7].lastFailure)==null?void 0:le.message)!=null?ne:"")+"",q,G,K,j,z,te,se,Q,ae=qe(e[7].lastHeartbeatTime)+"",oe,re;return{key:r,first:null,c(){t=$("a"),o=$("div"),a=D(n),u=I(),m=$("div"),g=$("div"),s=$("h4"),i=D("Activity Name"),p=I(),k=$("p"),S=$("span"),d=D(f),b=I(),T=$("div"),A=$("div"),w=$("h3"),_=D("Last Failure"),y=I(),N=$("pre"),H=$("code"),q=D(B),G=I(),K=$("div"),j=$("div"),z=$("h4"),te=D("Last Heartbeat Time"),se=I(),Q=$("p"),oe=D(ae),re=I(),this.h()},l(M){t=h(M,"A",{class:!0,href:!0});var P=v(t);o=h(P,"DIV",{class:!0});var ie=v(o);a=O(ie,n),ie.forEach(c),u=C(P),m=h(P,"DIV",{class:!0});var fe=v(m);g=h(fe,"DIV",{class:!0});var X=v(g);s=h(X,"H4",{});var ce=v(s);i=O(ce,"Activity Name"),ce.forEach(c),p=C(X),k=h(X,"P",{});var ue=v(k);S=h(ue,"SPAN",{class:!0});var me=v(S);d=O(me,f),me.forEach(c),ue.forEach(c),X.forEach(c),fe.forEach(c),b=C(P),T=h(P,"DIV",{class:!0});var de=v(T);A=h(de,"DIV",{class:!0});var Y=v(A);w=h(Y,"H3",{class:!0});var pe=v(w);_=O(pe,"Last Failure"),pe.forEach(c),y=C(Y),N=h(Y,"PRE",{class:!0});var ge=v(N);H=h(ge,"CODE",{class:!0});var _e=v(H);q=O(_e,B),_e.forEach(c),ge.forEach(c),Y.forEach(c),de.forEach(c),G=C(P),K=h(P,"DIV",{class:!0});var $e=v(K);j=h($e,"DIV",{class:!0});var Z=v(j);z=h(Z,"H4",{});var he=v(z);te=O(he,"Last Heartbeat Time"),he.forEach(c),se=C(Z),Q=h(Z,"P",{});var ve=v(Q);oe=O(ve,ae),ve.forEach(c),Z.forEach(c),$e.forEach(c),re=C(P),P.forEach(c),this.h()},h(){E(o,"class","md:w-1/12 text-left font-normal text-gray-500 w-40"),E(S,"class","bg-gray-300 text-gray-700 px-2"),E(g,"class","flex gap-2"),E(m,"class","w-full md:w-1/4"),E(w,"class","whitespace-nowrap"),E(H,"class","language-json"),E(N,"class","w-full rounded-lg"),E(A,"class","flex gap-2 items-center"),E(T,"class","w-full md:w-5/12"),E(j,"class","flex gap-2"),E(K,"class","w-full md:w-1/4"),E(t,"class","block md:flex content-between w-full border-b-2 border-gray-300 p-2 last-of-type:border-b-0 hover:bg-gray-50 gap-4 items-center"),E(t,"href",e[1]),this.first=t},m(M,P){V(M,t,P),l(t,o),l(o,a),l(t,u),l(t,m),l(m,g),l(g,s),l(s,i),l(g,p),l(g,k),l(k,S),l(S,d),l(t,b),l(t,T),l(T,A),l(A,w),l(w,_),l(A,y),l(A,N),l(N,H),l(H,q),l(t,G),l(t,K),l(K,j),l(j,z),l(z,te),l(j,se),l(j,Q),l(Q,oe),l(t,re)},p(M,P){e=M},d(M){M&&c(t)}}}function Ze(r){let e;return{c(){e=D("Show all")},l(t){e=O(t,"Show all")},m(t,o){V(t,e,o)},d(t){t&&c(e)}}}function et(r){let e,t,o=r[0].length&&Ye(r);return{c(){o&&o.c(),e=we()},l(n){o&&o.l(n),e=we()},m(n,a){o&&o.m(n,a),V(n,e,a),t=!0},p(n,[a]){n[0].length&&o.p(n,a)},i(n){t||(W(o),t=!0)},o(n){x(o),t=!1},d(n){o&&o.d(n),n&&c(e)}}}function tt(r,e,t){let o;Ae(r,Me,s=>t(2,o=s));const{pendingActivities:n}=o.stuff.workflow,{namespace:a,workflow:u,run:m}=o.params,g=Re({namespace:a,workflow:u,run:m});return Ne(()=>{window.Prism.highlightAll()}),[n,g]}class st extends ye{constructor(e){super(),Ie(this,e,tt,et,Ce,{})}}function ot(r){let e;return{c(){e=D("Summary")},l(t){e=O(t,"Summary")},m(t,o){V(t,e,o)},d(t){t&&c(e)}}}function rt(r){let e;return{c(){e=D("Full")},l(t){e=O(t,"Full")},m(t,o){V(t,e,o)},d(t){t&&c(e)}}}function at(r){let e;return{c(){e=D("Compact")},l(t){e=O(t,"Compact")},m(t,o){V(t,e,o)},d(t){t&&c(e)}}}function lt(r){let e;return{c(){e=D("JSON")},l(t){e=O(t,"JSON")},m(t,o){V(t,e,o)},d(t){t&&c(e)}}}function nt(r){let e,t,o,n,a,u,m,g;return e=new ee({props:{icon:xe,base:U(r[2]("summary")),href:U(r[2]("summary")),$$slots:{default:[ot]},$$scope:{ctx:r}}}),o=new ee({props:{icon:Fe,href:U(r[2]("full")),$$slots:{default:[rt]},$$scope:{ctx:r}}}),a=new ee({props:{icon:Le,href:U(r[2]("compact")),$$slots:{default:[at]},$$scope:{ctx:r}}}),m=new ee({props:{icon:Je,href:U(r[2]("json")),$$slots:{default:[lt]},$$scope:{ctx:r}}}),{c(){F(e.$$.fragment),t=I(),F(o.$$.fragment),n=I(),F(a.$$.fragment),u=I(),F(m.$$.fragment)},l(s){L(e.$$.fragment,s),t=C(s),L(o.$$.fragment,s),n=C(s),L(a.$$.fragment,s),u=C(s),L(m.$$.fragment,s)},m(s,i){J(e,s,i),V(s,t,i),J(o,s,i),V(s,n,i),J(a,s,i),V(s,u,i),J(m,s,i),g=!0},p(s,i){const p={};i&128&&(p.$$scope={dirty:i,ctx:s}),e.$set(p);const k={};i&128&&(k.$$scope={dirty:i,ctx:s}),o.$set(k);const S={};i&128&&(S.$$scope={dirty:i,ctx:s}),a.$set(S);const f={};i&128&&(f.$$scope={dirty:i,ctx:s}),m.$set(f)},i(s){g||(W(e.$$.fragment,s),W(o.$$.fragment,s),W(a.$$.fragment,s),W(m.$$.fragment,s),g=!0)},o(s){x(e.$$.fragment,s),x(o.$$.fragment,s),x(a.$$.fragment,s),x(m.$$.fragment,s),g=!1},d(s){R(e,s),s&&c(t),R(o,s),s&&c(n),R(a,s),s&&c(u),R(m,s)}}}function it(r){let e,t,o,n,a,u,m,g,s,i,p,k,S,f,d,b,T;o=new Ee({props:{heading:"Input",content:r[0],framed:!0}}),a=new Ee({props:{heading:"Result",content:r[1],framed:!0}}),m=new st({}),d=new Be({props:{$$slots:{default:[nt]},$$scope:{ctx:r}}});const A=r[6].default,w=Oe(A,r,r[7],null);return{c(){e=$("section"),t=$("div"),F(o.$$.fragment),n=I(),F(a.$$.fragment),u=I(),F(m.$$.fragment),g=I(),s=$("section"),i=$("nav"),p=$("h3"),k=D("Recent Events"),S=I(),f=$("div"),F(d.$$.fragment),b=I(),w&&w.c(),this.h()},l(_){e=h(_,"SECTION",{class:!0});var y=v(e);t=h(y,"DIV",{class:!0});var N=v(t);L(o.$$.fragment,N),n=C(N),L(a.$$.fragment,N),N.forEach(c),u=C(y),L(m.$$.fragment,y),g=C(y),s=h(y,"SECTION",{id:!0});var H=v(s);i=h(H,"NAV",{class:!0});var B=v(i);p=h(B,"H3",{class:!0});var q=v(p);k=O(q,"Recent Events"),q.forEach(c),S=C(B),f=h(B,"DIV",{id:!0,class:!0});var G=v(f);L(d.$$.fragment,G),G.forEach(c),B.forEach(c),b=C(H),w&&w.l(H),H.forEach(c),y.forEach(c),this.h()},h(){E(t,"class","flex gap-4"),E(p,"class","text-lg font-medium"),E(f,"id","event-view-toggle"),E(f,"class","flex gap-4"),E(i,"class","flex gap-4 justify-between items-end pb-4"),E(s,"id","event-history"),E(e,"class","flex flex-col gap-4")},m(_,y){V(_,e,y),l(e,t),J(o,t,null),l(t,n),J(a,t,null),l(e,u),J(m,e,null),l(e,g),l(e,s),l(s,i),l(i,p),l(p,k),l(i,S),l(i,f),J(d,f,null),l(s,b),w&&w.m(s,null),T=!0},p(_,[y]){const N={};y&128&&(N.$$scope={dirty:y,ctx:_}),d.$set(N),w&&w.p&&(!T||y&128)&&Pe(w,A,_,_[7],T?He(A,_[7],y,null):Ve(_[7]),null)},i(_){T||(W(o.$$.fragment,_),W(a.$$.fragment,_),W(m.$$.fragment,_),W(d.$$.fragment,_),W(w,_),T=!0)},o(_){x(o.$$.fragment,_),x(a.$$.fragment,_),x(m.$$.fragment,_),x(d.$$.fragment,_),x(w,_),T=!1},d(_){_&&c(e),R(o),R(a),R(m),R(d),w&&w.d(_)}}}const Ot=async function({params:r,url:e,stuff:t,fetch:o}){var n;const{workflow:a}=t,{namespace:u}=r,m={namespace:u,workflowId:a.id,runId:a.runId,reverse:Boolean((n=e==null?void 0:e.searchParams)===null||n===void 0?void 0:n.get("sort"))},{events:g,eventGroups:s}=await We(m,o);return{props:{namespace:u,workflow:a,events:g,eventGroups:s},stuff:{events:g,eventGroups:s}}};function ft(r,e,t){let{$$slots:o={},$$scope:n}=e,{namespace:a}=e,{workflow:u}=e,{events:m}=e;const{input:g,result:s}=Xe(m),i=(p,k)=>({namespace:a,workflow:u.id,run:u.runId,view:p,eventId:k});return r.$$set=p=>{"namespace"in p&&t(3,a=p.namespace),"workflow"in p&&t(4,u=p.workflow),"events"in p&&t(5,m=p.events),"$$scope"in p&&t(7,n=p.$$scope)},[g,s,i,a,u,m,o,n]}class Pt extends ye{constructor(e){super(),Ie(this,e,ft,it,Ce,{namespace:3,workflow:4,events:5})}}export{Pt as default,Ot as load};
