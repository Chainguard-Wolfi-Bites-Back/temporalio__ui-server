var Le=Object.defineProperty;var Te=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var Ae=(o,e,n)=>e in o?Le(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,de=(o,e)=>{for(var n in e||(e={}))Oe.call(e,n)&&Ae(o,n,e[n]);if(Te)for(var n of Te(e))Ue.call(e,n)&&Ae(o,n,e[n]);return o};import{S as X,i as Y,s as Z,I as pe,e as _,c as g,a as v,d as c,g as A,J as we,K as he,L as _e,q as p,a4 as Je,a5 as Qe,o as w,a6 as ze,w as y,k as P,x as I,m as j,y as E,B as T,l as Se,n as qe,p as He,t as R,h as F,b as d,M as m,E as ae,ab as We,T as Ke,R as Ne,N as ee,C as Pe,V as je,j as oe}from"../../../../../../chunks/index-604742bf.js";import{p as Me}from"../../../../../../chunks/stores-810822a9.js";import{l as Ge,w as Xe}from"../../../../../../chunks/workflow-run-4b2466b3.js";import{f as Ce}from"../../../../../../chunks/index-69aa65a3.js";import{I as Ye}from"../../../../../../chunks/index-0574ae1f.js";import{e as Ze}from"../../../../../../chunks/event-view-963ec0ce.js";import{w as xe}from"../../../../../../chunks/workflows-1f018cf1.js";import{t as et}from"../../../../../../chunks/workflow-service-250a9fea.js";import{e as Re,f as tt,g as rt,h as nt,i as at,j as Fe}from"../../../../../../chunks/route-for-1f2060cd.js";import{W as ot}from"../../../../../../chunks/workflow-status-ca8cb7e9.js";import{r as st,a as lt,h as ft}from"../../../../../../chunks/route-for-api-605baeb9.js";import{n as it}from"../../../../../../chunks/notifications-cfed8e58.js";import{B as Be}from"../../../../../../chunks/button-0ce95595.js";import{M as ut}from"../../../../../../chunks/modal-0d6320a7.js";import{f as ct}from"../../../../../../chunks/events-service-c14937d5.js";import"../../../../../../chunks/index-c9e619a8.js";import"../../../../../../chunks/with-loading-22689bcc.js";import"../../../../../../chunks/persist-store-26f405dd.js";import"../../../../../../chunks/simplify-attributes-64d6cf1a.js";import"../../../../../../chunks/format-date-919f4714.js";import"../../../../../../chunks/to-duration-271d3946.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";import"../../../../../../chunks/index-e3391e94.js";import"../../../../../../chunks/is-http-24b20bf9.js";import"../../../../../../chunks/data-converter-config-6fc5efe1.js";import"../../../../../../chunks/atob-eb4fc9a1.js";import"../../../../../../chunks/get-event-categorization-8a63628f.js";function mt(o){let e,n,t,a;const r=o[1].default,s=pe(r,o,o[0],null);return{c(){e=_("div"),s&&s.c()},l(l){e=g(l,"DIV",{});var f=v(e);s&&s.l(f),f.forEach(c)},m(l,f){A(l,e,f),s&&s.m(e,null),a=!0},p(l,[f]){s&&s.p&&(!a||f&1)&&we(s,r,l,l[0],a?_e(r,l[0],f,null):he(l[0]),null)},i(l){a||(p(s,l),Je(()=>{t&&t.end(1),n=Qe(e,Ce,{y:-50,duration:250,delay:250}),n.start()}),a=!0)},o(l){w(s,l),n&&n.invalidate(),t=ze(e,Ce,{y:-50,duration:250}),a=!1},d(l){l&&c(e),s&&s.d(l),l&&t&&t.end()}}}function dt(o,e,n){let{$$slots:t={},$$scope:a}=e;return o.$$set=r=>{"$$scope"in r&&n(0,a=r.$$scope)},[a,t]}class pt extends X{constructor(e){super(),Y(this,e,dt,mt,Z,{})}}async function wt({workflow:o,namespace:e,reason:n}){return await st(lt("workflow.terminate",{namespace:e,workflowId:o.id,runId:o.runId}),{options:{method:"POST",body:JSON.stringify({reason:n})},shouldRetry:!1})}function Ve(o){let e,n,t,a;return e=new Be({props:{destroy:!0,$$slots:{default:[ht]},$$scope:{ctx:o}}}),e.$on("click",o[3]),t=new ut({props:{open:o[2],confirmText:"Terminate",$$slots:{content:[gt],title:[_t]},$$scope:{ctx:o}}}),t.$on("cancelModal",o[4]),t.$on("confirmModal",o[6]),{c(){y(e.$$.fragment),n=P(),y(t.$$.fragment)},l(r){I(e.$$.fragment,r),n=j(r),I(t.$$.fragment,r)},m(r,s){E(e,r,s),A(r,n,s),E(t,r,s),a=!0},p(r,s){const l={};s&1024&&(l.$$scope={dirty:s,ctx:r}),e.$set(l);const f={};s&4&&(f.open=r[2]),s&1026&&(f.$$scope={dirty:s,ctx:r}),t.$set(f)},i(r){a||(p(e.$$.fragment,r),p(t.$$.fragment,r),a=!0)},o(r){w(e.$$.fragment,r),w(t.$$.fragment,r),a=!1},d(r){T(e,r),r&&c(n),T(t,r)}}}function ht(o){let e;return{c(){e=R("Terminate")},l(n){e=F(n,"Terminate")},m(n,t){A(n,e,t)},d(n){n&&c(e)}}}function _t(o){let e,n;return{c(){e=_("h3"),n=R("Terminate Workflow"),this.h()},l(t){e=g(t,"H3",{slot:!0});var a=v(e);n=F(a,"Terminate Workflow"),a.forEach(c),this.h()},h(){d(e,"slot","title")},m(t,a){A(t,e,a),m(e,n)},p:ae,d(t){t&&c(e)}}}function gt(o){let e,n,t,a,r,s,l;return{c(){e=_("div"),n=_("p"),t=R(`Are you sure you want to terminate this workflow? This action cannot be
        undone.`),a=P(),r=_("input"),this.h()},l(f){e=g(f,"DIV",{slot:!0});var u=v(e);n=g(u,"P",{});var $=v(n);t=F($,`Are you sure you want to terminate this workflow? This action cannot be
        undone.`),$.forEach(c),a=j(u),r=g(u,"INPUT",{class:!0,placeholder:!0}),u.forEach(c),this.h()},h(){d(r,"class","mt-4 block w-full rounded-md border border-gray-200 p-2"),d(r,"placeholder","Enter a reason"),d(e,"slot","content")},m(f,u){A(f,e,u),m(e,n),m(n,t),m(e,a),m(e,r),We(r,o[1]),s||(l=Ke(r,"input",o[8]),s=!0)},p(f,u){u&2&&r.value!==f[1]&&We(r,f[1])},d(f){f&&c(e),s=!1,l()}}}function $t(o){let e=o[5](o[0]),n,t,a=e&&Ve(o);return{c(){a&&a.c(),n=Se()},l(r){a&&a.l(r),n=Se()},m(r,s){a&&a.m(r,s),A(r,n,s),t=!0},p(r,[s]){s&1&&(e=r[5](r[0])),e?a?(a.p(r,s),s&1&&p(a,1)):(a=Ve(r),a.c(),p(a,1),a.m(n.parentNode,n)):a&&(qe(),w(a,1,1,()=>{a=null}),He())},i(r){t||(p(a),t=!0)},o(r){w(a),t=!1},d(r){a&&a.d(r),r&&c(n)}}}function kt(o,e,n){let{workflow:t}=e,{namespace:a}=e,r="",s=!1;const l=()=>n(2,s=!0),f=()=>n(2,s=!1),u=k=>String(k.status)==="Running",$=()=>{n(2,s=!1),n(1,r=""),it.add("success","Workflow Terminated"),window.location.reload()},S=()=>{wt({workflow:t,namespace:a,reason:r}).then($).catch(ft)};function h(){r=this.value,n(1,r)}return o.$$set=k=>{"workflow"in k&&n(0,t=k.workflow),"namespace"in k&&n(7,a=k.namespace)},[t,r,s,l,f,u,S,a,h]}class bt extends X{constructor(e){super(),Y(this,e,kt,$t,Z,{workflow:0,namespace:7})}}function vt(o){let e,n;return{c(){e=_("span"),n=R("Download"),this.h()},l(t){e=g(t,"SPAN",{class:!0});var a=v(e);n=F(a,"Download"),a.forEach(c),this.h()},h(){d(e,"class","hidden md:inline")},m(t,a){A(t,e,a),m(e,n)},p:ae,d(t){t&&c(e)}}}function yt(o){let e,n;return e=new Be({props:{secondary:!0,icon:"download",$$slots:{default:[vt]},$$scope:{ctx:o}}}),e.$on("click",o[0]),{c(){y(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,a){E(e,t,a),n=!0},p(t,[a]){const r={};a&16&&(r.$$scope={dirty:a,ctx:t}),e.$set(r)},i(t){n||(p(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){T(e,t)}}}function It(o,e,n){let{namespace:t}=e,{workflowId:a}=e,{runId:r}=e;const s=async()=>{const l=await ct({namespace:t,workflowId:a,runId:r}),f=JSON.stringify({events:l},null,2);u(f,`${r}/events.json`,"text/plain");function u($,S,h){const k=document.createElement("a"),O=new Blob([$],{type:h});k.href=URL.createObjectURL(O),k.download=S,k.click()}};return o.$$set=l=>{"namespace"in l&&n(1,t=l.namespace),"workflowId"in l&&n(2,a=l.workflowId),"runId"in l&&n(3,r=l.runId)},[s,t,a,r]}class Et extends X{constructor(e){super(),Y(this,e,It,yt,Z,{namespace:1,workflowId:2,runId:3})}}function Tt(o){let e;return{c(){e=R(o[1])},l(n){e=F(n,o[1])},m(n,t){A(n,e,t)},p(n,t){t&2&&oe(e,n[1])},d(n){n&&c(e)}}}function At(o){let e,n,t,a;return{c(){e=R(o[1]),n=P(),t=_("span"),a=R(o[2]),this.h()},l(r){e=F(r,o[1]),n=j(r),t=g(r,"SPAN",{class:!0});var s=v(t);a=F(s,o[2]),s.forEach(c),this.h()},h(){d(t,"class","rounded-sm bg-blue-100 px-2 text-blue-700")},m(r,s){A(r,e,s),A(r,n,s),A(r,t,s),m(t,a)},p(r,s){s&2&&oe(e,r[1]),s&4&&oe(a,r[2])},d(r){r&&c(e),r&&c(n),r&&c(t)}}}function St(o){let e,n;function t(s,l){return s[2]||s[2]===0?At:Tt}let a=t(o),r=a(o);return{c(){e=_("a"),r.c(),this.h()},l(s){e=g(s,"A",{class:!0,href:!0,"data-cy":!0});var l=v(e);r.l(l),l.forEach(c),this.h()},h(){d(e,"class","block whitespace-nowrap text-sm md:text-base svelte-sf1jtj"),d(e,"href",o[0]),d(e,"data-cy",n=o[4].dataCy),Ne(e,"active",o[3])},m(s,l){A(s,e,l),r.m(e,null)},p(s,[l]){a===(a=t(s))&&r?r.p(s,l):(r.d(1),r=a(s),r&&(r.c(),r.m(e,null))),l&1&&d(e,"href",s[0]),l&16&&n!==(n=s[4].dataCy)&&d(e,"data-cy",n),l&8&&Ne(e,"active",s[3])},i:ae,o:ae,d(s){s&&c(e),r.d()}}}function Wt(o,e,n){let t,a;ee(o,Me,f=>n(5,a=f));let{href:r}=e,{label:s}=e,{amount:l=null}=e;return o.$$set=f=>{n(4,e=Pe(Pe({},e),je(f))),"href"in f&&n(0,r=f.href),"label"in f&&n(1,s=f.label),"amount"in f&&n(2,l=f.amount)},o.$$.update=()=>{o.$$.dirty&33&&n(3,t=a.url.pathname.includes(r))},e=je(e),[r,s,l,t,e,a]}class re extends X{constructor(e){super(),Y(this,e,Wt,St,Z,{href:0,label:1,amount:2})}}function Nt(o){var ge,$e,ke,be,ve;let e,n,t,a,r,s,l,f,u,$,S,h,k,O=o[1].id+"",ne,se,V,D,le,q,fe,W,H,ie,M,ue,B,ce,U,me,J,x;return r=new Ye({props:{scale:.8,name:"caretLeft",class:"inline"}}),S=new ot({props:{status:(ge=o[1])==null?void 0:ge.status}}),D=new Et({props:{namespace:o[0],workflowId:o[1].id,runId:o[1].runId}}),q=new bt({props:{workflow:o[1],namespace:o[0]}}),H=new re({props:{label:"History",href:Re(de({view:o[3]},o[4])),amount:($e=o[1])==null?void 0:$e.historyEvents,dataCy:"history-tab"}}),M=new re({props:{label:"Workers",href:tt(o[4]),amount:(be=(ke=o[2])==null?void 0:ke.pollers)==null?void 0:be.length,dataCy:"workers-tab"}}),B=new re({props:{label:"Pending Activities",href:rt(o[4]),amount:(ve=o[1].pendingActivities)==null?void 0:ve.length,dataCy:"pending-activities-tab"}}),U=new re({props:{label:"Stack Trace",href:nt(o[4]),dataCy:"stack-trace-tab"}}),J=new re({props:{label:"Queries",href:at(o[4]),dataCy:"queries-tab"}}),{c(){e=_("header"),n=_("main"),t=_("div"),a=_("a"),y(r.$$.fragment),s=R("Back to Workflows"),f=P(),u=_("div"),$=_("h1"),y(S.$$.fragment),h=P(),k=_("span"),ne=R(O),se=P(),V=_("div"),y(D.$$.fragment),le=P(),y(q.$$.fragment),fe=P(),W=_("nav"),y(H.$$.fragment),ie=P(),y(M.$$.fragment),ue=P(),y(B.$$.fragment),ce=P(),y(U.$$.fragment),me=P(),y(J.$$.fragment),this.h()},l(i){e=g(i,"HEADER",{class:!0});var b=v(e);n=g(b,"MAIN",{class:!0});var C=v(n);t=g(C,"DIV",{class:!0});var Q=v(t);a=g(Q,"A",{href:!0,"data-cy":!0,class:!0});var z=v(a);I(r.$$.fragment,z),s=F(z,"Back to Workflows"),z.forEach(c),Q.forEach(c),f=j(C),u=g(C,"DIV",{class:!0});var L=v(u);$=g(L,"H1",{class:!0});var K=v($);I(S.$$.fragment,K),h=j(K),k=g(K,"SPAN",{class:!0});var te=v(k);ne=F(te,O),te.forEach(c),K.forEach(c),se=j(L),V=g(L,"DIV",{class:!0});var G=v(V);I(D.$$.fragment,G),le=j(G),I(q.$$.fragment,G),G.forEach(c),L.forEach(c),fe=j(C),W=g(C,"NAV",{class:!0});var N=v(W);I(H.$$.fragment,N),ie=j(N),I(M.$$.fragment,N),ue=j(N),I(B.$$.fragment,N),ce=j(N),I(U.$$.fragment,N),me=j(N),I(J.$$.fragment,N),N.forEach(c),C.forEach(c),b.forEach(c),this.h()},h(){d(a,"href",l=`/namespaces/${o[0]}/workflows?query=${Fe(o[6])}&search=${o[5]}`),d(a,"data-cy","back-to-workflows"),d(a,"class","back-to-workflows svelte-st9g8m"),d(t,"class","-mt-3 -ml-2 block"),d(k,"class","select-all font-medium"),d($,"class","relative flex items-center gap-4 text-2xl"),d(V,"class","ml-8 flex items-center justify-end gap-4"),d(u,"class","mb-8 flex items-center justify-between"),d(W,"class","flex flex-wrap gap-6"),d(n,"class","relative flex flex-col gap-1"),d(e,"class","flex flex-col gap-4")},m(i,b){A(i,e,b),m(e,n),m(n,t),m(t,a),E(r,a,null),m(a,s),m(n,f),m(n,u),m(u,$),E(S,$,null),m($,h),m($,k),m(k,ne),m(u,se),m(u,V),E(D,V,null),m(V,le),E(q,V,null),m(n,fe),m(n,W),E(H,W,null),m(W,ie),E(M,W,null),m(W,ue),E(B,W,null),m(W,ce),E(U,W,null),m(W,me),E(J,W,null),x=!0},p(i,[b]){var G,N,ye,Ie,Ee;(!x||b&1&&l!==(l=`/namespaces/${i[0]}/workflows?query=${Fe(i[6])}&search=${i[5]}`))&&d(a,"href",l);const C={};b&2&&(C.status=(G=i[1])==null?void 0:G.status),S.$set(C),(!x||b&2)&&O!==(O=i[1].id+"")&&oe(ne,O);const Q={};b&1&&(Q.namespace=i[0]),b&2&&(Q.workflowId=i[1].id),b&2&&(Q.runId=i[1].runId),D.$set(Q);const z={};b&2&&(z.workflow=i[1]),b&1&&(z.namespace=i[0]),q.$set(z);const L={};b&8&&(L.href=Re(de({view:i[3]},i[4]))),b&2&&(L.amount=(N=i[1])==null?void 0:N.historyEvents),H.$set(L);const K={};b&4&&(K.amount=(Ie=(ye=i[2])==null?void 0:ye.pollers)==null?void 0:Ie.length),M.$set(K);const te={};b&2&&(te.amount=(Ee=i[1].pendingActivities)==null?void 0:Ee.length),B.$set(te)},i(i){x||(p(r.$$.fragment,i),p(S.$$.fragment,i),p(D.$$.fragment,i),p(q.$$.fragment,i),p(H.$$.fragment,i),p(M.$$.fragment,i),p(B.$$.fragment,i),p(U.$$.fragment,i),p(J.$$.fragment,i),x=!0)},o(i){w(r.$$.fragment,i),w(S.$$.fragment,i),w(D.$$.fragment,i),w(q.$$.fragment,i),w(H.$$.fragment,i),w(M.$$.fragment,i),w(B.$$.fragment,i),w(U.$$.fragment,i),w(J.$$.fragment,i),x=!1},d(i){i&&c(e),T(r),T(S),T(D),T(q),T(H),T(M),T(B),T(U),T(J)}}}function Pt(o,e,n){let t,a;ee(o,xe,h=>n(7,t=h)),ee(o,Ze,h=>n(3,a=h));let{namespace:r}=e,{workflow:s}=e,{workers:l}=e;const f={namespace:r,workflow:s.id,run:s.runId},{parameters:u,searchType:$}=t,S=et(u);return o.$$set=h=>{"namespace"in h&&n(0,r=h.namespace),"workflow"in h&&n(1,s=h.workflow),"workers"in h&&n(2,l=h.workers)},[r,s,l,a,f,$,S]}class jt extends X{constructor(e){super(),Y(this,e,Pt,Nt,Z,{namespace:0,workflow:1,workers:2})}}function De(o){let e,n,t;e=new jt({props:{namespace:o[2],workflow:o[1].workflow,workers:o[1].workers}});const a=o[3].default,r=pe(a,o,o[4],null);return{c(){y(e.$$.fragment),n=P(),r&&r.c()},l(s){I(e.$$.fragment,s),n=j(s),r&&r.l(s)},m(s,l){E(e,s,l),A(s,n,l),r&&r.m(s,l),t=!0},p(s,l){const f={};l&2&&(f.workflow=s[1].workflow),l&2&&(f.workers=s[1].workers),e.$set(f),r&&r.p&&(!t||l&16)&&we(r,a,s,s[4],t?_e(a,s[4],l,null):he(s[4]),null)},i(s){t||(p(e.$$.fragment,s),p(r,s),t=!0)},o(s){w(e.$$.fragment,s),w(r,s),t=!1},d(s){T(e,s),s&&c(n),r&&r.d(s)}}}function Ct(o){let e,n,t=!o[0]&&De(o);return{c(){e=_("main"),t&&t.c(),this.h()},l(a){e=g(a,"MAIN",{class:!0});var r=v(e);t&&t.l(r),r.forEach(c),this.h()},h(){d(e,"class","flex h-full flex-col gap-6")},m(a,r){A(a,e,r),t&&t.m(e,null),n=!0},p(a,r){a[0]?t&&(qe(),w(t,1,1,()=>{t=null}),He()):t?(t.p(a,r),r&1&&p(t,1)):(t=De(a),t.c(),p(t,1),t.m(e,null))},i(a){n||(p(t),n=!0)},o(a){w(t),n=!1},d(a){a&&c(e),t&&t.d()}}}function Rt(o){let e,n;return e=new pt({props:{$$slots:{default:[Ct]},$$scope:{ctx:o}}}),{c(){y(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,a){E(e,t,a),n=!0},p(t,[a]){const r={};a&19&&(r.$$scope={dirty:a,ctx:t}),e.$set(r)},i(t){n||(p(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){T(e,t)}}}function Ft(o,e,n){let t,a,r;ee(o,Me,u=>n(5,t=u)),ee(o,Ge,u=>n(0,a=u)),ee(o,Xe,u=>n(1,r=u));let{$$slots:s={},$$scope:l}=e;const{namespace:f}=t.params;return o.$$set=u=>{"$$scope"in u&&n(4,l=u.$$scope)},[a,r,f,s,l]}class Vt extends X{constructor(e){super(),Y(this,e,Ft,Rt,Z,{})}}function Dt(o){let e;const n=o[0].default,t=pe(n,o,o[1],null);return{c(){t&&t.c()},l(a){t&&t.l(a)},m(a,r){t&&t.m(a,r),e=!0},p(a,r){t&&t.p&&(!e||r&2)&&we(t,n,a,a[1],e?_e(n,a[1],r,null):he(a[1]),null)},i(a){e||(p(t,a),e=!0)},o(a){w(t,a),e=!1},d(a){t&&t.d(a)}}}function qt(o){let e,n;return e=new Vt({props:{$$slots:{default:[Dt]},$$scope:{ctx:o}}}),{c(){y(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,a){E(e,t,a),n=!0},p(t,[a]){const r={};a&2&&(r.$$scope={dirty:a,ctx:t}),e.$set(r)},i(t){n||(p(e.$$.fragment,t),n=!0)},o(t){w(e.$$.fragment,t),n=!1},d(t){T(e,t)}}}function Ht(o,e,n){let{$$slots:t={},$$scope:a}=e;return o.$$set=r=>{"$$scope"in r&&n(1,a=r.$$scope)},[t,a]}class pr extends X{constructor(e){super(),Y(this,e,Ht,qt,Z,{})}}export{pr as default};
