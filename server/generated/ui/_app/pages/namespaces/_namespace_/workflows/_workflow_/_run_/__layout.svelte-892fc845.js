import{S as ne,i as se,s as re,w as I,x as y,y as A,q as $,o as v,B as S,l as Ee,g as T,n as Se,p as Ne,d as m,t as N,h as P,e as h,c as p,a as w,b as c,U as Ie,T as ye,I as Pe,j as J,k as g,m as k,L as i,P as Te,aA as We,f as Fe,K as De,M as He,N as Re,O as qe}from"../../../../../../chunks/vendor-ff19c65d.js";import{W as Be,a as Me}from"../../../../../../chunks/workflow-status-6df83a5c.js";import{a as Oe,b as je,c as Ce,d as Le,e as Qe}from"../../../../../../chunks/route-for-47027f7b.js";import{g as Ve}from"../../../../../../chunks/navigation-093db9e2.js";import{r as Je,a as Ke,h as Ue}from"../../../../../../chunks/route-for-api-1884f93e.js";import{n as ze}from"../../../../../../chunks/notifications-089fbae0.js";import{B as Ge}from"../../../../../../chunks/button-fcd14ccb.js";import{p as Xe}from"../../../../../../chunks/stores-4aa32d62.js";import"../../../../../../chunks/singletons-a6a7384f.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";async function Ye({workflow:r,namespace:e,reason:a}){return await Je(Ke("workflow.terminate",{namespace:e,executionId:r.id,runId:r.runId}),{options:{method:"POST",body:JSON.stringify({reason:a})},shouldRetry:!1})}function Ae(r){let e,a;return e=new Ge({props:{destroy:!0,$$slots:{default:[Ze]},$$scope:{ctx:r}}}),e.$on("click",r[2]),{c(){I(e.$$.fragment)},l(s){y(e.$$.fragment,s)},m(s,t){A(e,s,t),a=!0},p(s,t){const n={};t&64&&(n.$$scope={dirty:t,ctx:s}),e.$set(n)},i(s){a||($(e.$$.fragment,s),a=!0)},o(s){v(e.$$.fragment,s),a=!1},d(s){S(e,s)}}}function Ze(r){let e;return{c(){e=N("Terminate")},l(a){e=P(a,"Terminate")},m(a,s){T(a,e,s)},d(a){a&&m(e)}}}function xe(r){let e=r[1](r[0]),a,s,t=e&&Ae(r);return{c(){t&&t.c(),a=Ee()},l(n){t&&t.l(n),a=Ee()},m(n,l){t&&t.m(n,l),T(n,a,l),s=!0},p(n,[l]){l&1&&(e=n[1](n[0])),e?t?(t.p(n,l),l&1&&$(t,1)):(t=Ae(n),t.c(),$(t,1),t.m(a.parentNode,a)):t&&(Se(),v(t,1,1,()=>{t=null}),Ne())},i(n){s||($(t),s=!0)},o(n){v(t),s=!1},d(n){t&&t.d(n),n&&m(a)}}}function et(r,e,a){let{workflow:s}=e,{namespace:t}=e,n="";const l=_=>String(_.status)==="Running",o=()=>{n="",ze.add("success","Workflow Terminated"),Ve(Oe({namespace:t,workflow:s.id,run:s.runId}))},f=()=>{Ye({workflow:s,namespace:t,reason:n}).then(o).catch(Ue)};return r.$$set=_=>{"workflow"in _&&a(0,s=_.workflow),"namespace"in _&&a(3,t=_.namespace)},[s,l,f,t]}class tt extends ne{constructor(e){super();se(this,e,et,xe,re,{workflow:0,namespace:3})}}function at(r){let e;return{c(){e=N(r[1])},l(a){e=P(a,r[1])},m(a,s){T(a,e,s)},p(a,s){s&2&&J(e,a[1])},d(a){a&&m(e)}}}function nt(r){let e,a,s,t;return{c(){e=N(r[1]),a=g(),s=h("span"),t=N(r[2]),this.h()},l(n){e=P(n,r[1]),a=k(n),s=p(n,"SPAN",{class:!0});var l=w(s);t=P(l,r[2]),l.forEach(m),this.h()},h(){c(s,"class","px-2 text-blue-700 bg-blue-100 rounded-sm")},m(n,l){T(n,e,l),T(n,a,l),T(n,s,l),i(s,t)},p(n,l){l&2&&J(e,n[1]),l&4&&J(t,n[2])},d(n){n&&m(e),n&&m(a),n&&m(s)}}}function st(r){let e;function a(n,l){return n[2]?nt:at}let s=a(r),t=s(r);return{c(){e=h("a"),t.c(),this.h()},l(n){e=p(n,"A",{class:!0,href:!0});var l=w(e);t.l(l),l.forEach(m),this.h()},h(){c(e,"class","block svelte-tavydt"),c(e,"href",r[0]),Ie(e,"active",r[3])},m(n,l){T(n,e,l),t.m(e,null)},p(n,[l]){s===(s=a(n))&&t?t.p(n,l):(t.d(1),t=s(n),t&&(t.c(),t.m(e,null))),l&1&&c(e,"href",n[0]),l&8&&Ie(e,"active",n[3])},i:ye,o:ye,d(n){n&&m(e),t.d()}}}function rt(r,e,a){let s,t;Pe(r,Xe,f=>a(4,t=f));let{href:n}=e,{label:l}=e,{amount:o=null}=e;return r.$$set=f=>{"href"in f&&a(0,n=f.href),"label"in f&&a(1,l=f.label),"amount"in f&&a(2,o=f.amount)},r.$$.update=()=>{r.$$.dirty&17&&a(3,s=t.url.pathname.includes(n))},[n,l,o,s,t]}class ae extends ne{constructor(e){super();se(this,e,rt,st,re,{href:0,label:1,amount:2})}}function lt(r){var ge;let e,a,s,t,n,l,o,f,_=r[1].name+"",X,le,W,oe,F,fe,D,K,ue,ie,L,U=r[1].id+"",Y,me,H,z,ce,_e,Q,G=r[1].runId+"",Z,he,b,B,pe,M,we,O,de,j,R;return t=new Te({props:{icon:We}}),W=new Be({props:{status:(ge=r[1])==null?void 0:ge.status}}),F=new tt({props:{workflow:r[1],namespace:r[0]}}),B=new ae({props:{label:"History",href:je(r[3]),amount:r[2]}}),M=new ae({props:{label:"Workers",href:Ce(r[3])}}),O=new ae({props:{label:"Stack Trace",href:Le(r[3])}}),j=new ae({props:{label:"Query",href:Qe(r[3])}}),{c(){e=h("header"),a=h("main"),s=h("a"),I(t.$$.fragment),l=g(),o=h("div"),f=h("h1"),X=N(_),le=g(),I(W.$$.fragment),oe=g(),I(F.$$.fragment),fe=g(),D=h("p"),K=h("span"),ue=N("Workflow ID"),ie=g(),L=h("span"),Y=N(U),me=g(),H=h("p"),z=h("span"),ce=N("Run ID"),_e=g(),Q=h("span"),Z=N(G),he=g(),b=h("nav"),I(B.$$.fragment),pe=g(),I(M.$$.fragment),we=g(),I(O.$$.fragment),de=g(),I(j.$$.fragment),this.h()},l(u){e=p(u,"HEADER",{class:!0});var d=w(e);a=p(d,"MAIN",{class:!0});var E=w(a);s=p(E,"A",{href:!0,class:!0,style:!0});var V=w(s);y(t.$$.fragment,V),V.forEach(m),l=k(E),o=p(E,"DIV",{class:!0});var C=w(o);f=p(C,"H1",{class:!0});var x=w(f);X=P(x,_),le=k(x),y(W.$$.fragment,x),x.forEach(m),oe=k(C),y(F.$$.fragment,C),C.forEach(m),fe=k(E),D=p(E,"P",{class:!0});var ee=w(D);K=p(ee,"SPAN",{});var ke=w(K);ue=P(ke,"Workflow ID"),ke.forEach(m),ie=k(ee),L=p(ee,"SPAN",{class:!0});var $e=w(L);Y=P($e,U),$e.forEach(m),ee.forEach(m),me=k(E),H=p(E,"P",{class:!0});var te=w(H);z=p(te,"SPAN",{});var be=w(z);ce=P(be,"Run ID"),be.forEach(m),_e=k(te),Q=p(te,"SPAN",{class:!0});var ve=w(Q);Z=P(ve,G),ve.forEach(m),te.forEach(m),E.forEach(m),he=k(d),b=p(d,"NAV",{class:!0});var q=w(b);y(B.$$.fragment,q),pe=k(q),y(M.$$.fragment,q),we=k(q),y(O.$$.fragment,q),de=k(q),y(j.$$.fragment,q),q.forEach(m),d.forEach(m),this.h()},h(){c(s,"href",n="/namespaces/"+r[0]+"/workflows"),c(s,"class","absolute top-2 back-to-workflows"),Fe(s,"left","-1.5rem"),c(f,"class","text-2xl"),c(o,"class","flex justify-between items-center"),c(L,"class","font-medium"),c(D,"class","text-md"),c(Q,"class","font-medium"),c(H,"class","text-md"),c(a,"class","flex flex-col gap-1 relative"),c(b,"class","flex gap-6"),c(e,"class","flex flex-col gap-4")},m(u,d){T(u,e,d),i(e,a),i(a,s),A(t,s,null),i(a,l),i(a,o),i(o,f),i(f,X),i(f,le),A(W,f,null),i(o,oe),A(F,o,null),i(a,fe),i(a,D),i(D,K),i(K,ue),i(D,ie),i(D,L),i(L,Y),i(a,me),i(a,H),i(H,z),i(z,ce),i(H,_e),i(H,Q),i(Q,Z),i(e,he),i(e,b),A(B,b,null),i(b,pe),A(M,b,null),i(b,we),A(O,b,null),i(b,de),A(j,b,null),R=!0},p(u,[d]){var C;(!R||d&1&&n!==(n="/namespaces/"+u[0]+"/workflows"))&&c(s,"href",n),(!R||d&2)&&_!==(_=u[1].name+"")&&J(X,_);const E={};d&2&&(E.status=(C=u[1])==null?void 0:C.status),W.$set(E);const V={};d&2&&(V.workflow=u[1]),d&1&&(V.namespace=u[0]),F.$set(V),(!R||d&2)&&U!==(U=u[1].id+"")&&J(Y,U),(!R||d&2)&&G!==(G=u[1].runId+"")&&J(Z,G)},i(u){R||($(t.$$.fragment,u),$(W.$$.fragment,u),$(F.$$.fragment,u),$(B.$$.fragment,u),$(M.$$.fragment,u),$(O.$$.fragment,u),$(j.$$.fragment,u),R=!0)},o(u){v(t.$$.fragment,u),v(W.$$.fragment,u),v(F.$$.fragment,u),v(B.$$.fragment,u),v(M.$$.fragment,u),v(O.$$.fragment,u),v(j.$$.fragment,u),R=!1},d(u){u&&m(e),S(t),S(W),S(F),S(B),S(M),S(O),S(j)}}}function ot(r,e,a){let{namespace:s}=e,{workflow:t}=e;const n=t==null?void 0:t.historyEvents,l={namespace:s,workflow:t.id,run:t.runId};return r.$$set=o=>{"namespace"in o&&a(0,s=o.namespace),"workflow"in o&&a(1,t=o.workflow)},[s,t,n,l]}class ft extends ne{constructor(e){super();se(this,e,ot,lt,re,{namespace:0,workflow:1})}}function ut(r){let e,a,s,t;a=new ft({props:{namespace:r[1],workflow:r[0]}});const n=r[3].default,l=De(n,r,r[2],null);return{c(){e=h("main"),I(a.$$.fragment),s=g(),l&&l.c(),this.h()},l(o){e=p(o,"MAIN",{class:!0});var f=w(e);y(a.$$.fragment,f),s=k(f),l&&l.l(f),f.forEach(m),this.h()},h(){c(e,"class","flex flex-col gap-6 h-full")},m(o,f){T(o,e,f),A(a,e,null),i(e,s),l&&l.m(e,null),t=!0},p(o,[f]){const _={};f&2&&(_.namespace=o[1]),f&1&&(_.workflow=o[0]),a.$set(_),l&&l.p&&(!t||f&4)&&He(l,n,o,o[2],t?qe(n,o[2],f,null):Re(o[2]),null)},i(o){t||($(a.$$.fragment,o),$(l,o),t=!0)},o(o){v(a.$$.fragment,o),v(l,o),t=!1},d(o){o&&m(e),S(a),l&&l.d(o)}}}const bt=async function({params:r}){const{workflow:e,run:a,namespace:s}=r,n=await Me({namespace:s,executionId:e,runId:a},fetch);return{props:{workflow:n,namespace:s},stuff:{workflow:n}}};function it(r,e,a){let{$$slots:s={},$$scope:t}=e,{workflow:n}=e,{namespace:l}=e;return r.$$set=o=>{"workflow"in o&&a(0,n=o.workflow),"namespace"in o&&a(1,l=o.namespace),"$$scope"in o&&a(2,t=o.$$scope)},[n,l,t,s]}class vt extends ne{constructor(e){super();se(this,e,it,ut,re,{workflow:0,namespace:1})}}export{vt as default,bt as load};
