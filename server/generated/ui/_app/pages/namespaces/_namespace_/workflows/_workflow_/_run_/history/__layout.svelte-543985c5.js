import{S as Ce,i as Se,s as Te,e as $,t as A,k as C,w as L,c as v,a as h,h as D,d as f,m as S,x as J,b as E,g as P,M as a,y as R,a3 as Ae,ag as De,q as x,o as F,B as j,l as be,O as Ne,v as Ve,ah as Oe,I as Pe,J as He,K as We,L as xe}from"../../../../../../../chunks/index-f021a159.js";import{a as Fe}from"../../../../../../../chunks/events-service-a50aaa55.js";import{b as Le,c as Je,d as Re,e as je}from"../../../../../../../chunks/index.es-c091a2eb.js";import{f as Be,d as U}from"../../../../../../../chunks/route-for-d606e623.js";import{i as Me}from"../../../../../../../chunks/index-a8ee0a5c.js";import{T as qe,a as ee}from"../../../../../../../chunks/toggle-buttons-a09d7d20.js";import{C as ke}from"../../../../../../../chunks/code-block-a854edcb.js";import{p as Ge}from"../../../../../../../chunks/stores-2e95f632.js";import{f as Ke}from"../../../../../../../chunks/format-date-27daa7ac.js";import{L as ze}from"../../../../../../../chunks/link-10f27692.js";import"../../../../../../../chunks/route-for-api-e4a488a6.js";import"../../../../../../../chunks/navigation-3f1ea447.js";import"../../../../../../../chunks/singletons-d1fb5791.js";import"../../../../../../../chunks/index-cfbcd7ef.js";import"../../../../../../../chunks/notifications-0558c095.js";import"../../../../../../../chunks/is-network-error-ac7c8caf.js";import"../../../../../../../chunks/index-ae512670.js";import"../../../../../../../chunks/data-converter-config-fb2097df.js";import"../../../../../../../chunks/persist-store-210df7c0.js";import"../../../../../../../chunks/atob-5f9d7101.js";import"../../../../../../../chunks/get-event-categorization-b2bce139.js";import"../../../../../../../chunks/simplify-attributes-f9117c31.js";const Qe=["WorkflowExecutionFailed","WorkflowExecutionCompleted","WorkflowExecutionContinuedAsNew","WorkflowExecutionTimedOut","WorkflowExecutionCanceled","WorkflowExecutionTerminated"],Ue=r=>{for(const e of Qe)if(r.eventType===e)return!0;return!1},Xe=r=>{for(const e of r)if(Ue(e))return e},Ye=r=>Me(r)?r.attributes.result===null?null:r.attributes.result.payloads:r.attributes,Ze=r=>{var l,u;let e,t;const o=r==null?void 0:r.find(m=>!!m.workflowExecutionStartedEventAttributes),n=Xe(r);return o&&(e=JSON.stringify((u=(l=o==null?void 0:o.workflowExecutionStartedEventAttributes)==null?void 0:l.input)==null?void 0:u.payloads)),n&&(t=JSON.stringify(Ye(n))),{input:e,result:t}};function ye(r,e,t){const o=r.slice();return o[6]=e[t].id,o[7]=Oe(e[t],["id"]),o}function et(r){let e,t,o,n,l,u=[],m=new Map,g,s,i,p,k=r[0];const T=c=>c[6];for(let c=0;c<k.length;c+=1){let d=ye(r,k,c),b=T(d);m.set(b,u[c]=Ie(b,d))}return i=new ze({props:{href:r[1],$$slots:{default:[tt]},$$scope:{ctx:r}}}),{c(){e=$("section"),t=$("h3"),o=A("Pending Activities"),n=C(),l=$("section");for(let c=0;c<u.length;c+=1)u[c].c();g=C(),s=$("div"),L(i.$$.fragment),this.h()},l(c){e=v(c,"SECTION",{class:!0});var d=h(e);t=v(d,"H3",{class:!0});var b=h(t);o=D(b,"Pending Activities"),b.forEach(f),n=S(d),l=v(d,"SECTION",{class:!0});var y=h(l);for(let w=0;w<u.length;w+=1)u[w].l(y);y.forEach(f),g=S(d),s=v(d,"DIV",{class:!0});var N=h(s);J(i.$$.fragment,N),N.forEach(f),d.forEach(f),this.h()},h(){E(t,"class","text-lg font-medium mb-4"),E(l,"class","w-full table-auto space-x-4"),E(s,"class","text-right"),E(e,"class","border-2 border-gray-300 rounded-lg p-4")},m(c,d){P(c,e,d),a(e,t),a(t,o),a(e,n),a(e,l);for(let b=0;b<u.length;b+=1)u[b].m(l,null);a(e,g),a(e,s),R(i,s,null),p=!0},p(c,d){d&3&&(k=c[0],u=Ae(u,d,T,1,c,k,m,l,De,Ie,null,ye));const b={};d&1024&&(b.$$scope={dirty:d,ctx:c}),i.$set(b)},i(c){p||(x(i.$$.fragment,c),p=!0)},o(c){F(i.$$.fragment,c),p=!1},d(c){c&&f(e);for(let d=0;d<u.length;d+=1)u[d].d();j(i)}}}function Ie(r,e){var ne,ie;let t,o,n=e[7].activityId+"",l,u,m,g,s,i,p,k,T,c=e[7].activityType+"",d,b,y,N,w,_,I,V,H,W,K=((ie=(ne=e[7].lastFailure)==null?void 0:ne.message)!=null?ie:"")+"",q,te,G,B,z,se,oe,Q,le=Ke(e[7].lastHeartbeatTime)+"",re,ae;return{key:r,first:null,c(){t=$("a"),o=$("div"),l=A(n),u=C(),m=$("div"),g=$("div"),s=$("h4"),i=A("Activity Name"),p=C(),k=$("p"),T=$("span"),d=A(c),b=C(),y=$("div"),N=$("div"),w=$("h3"),_=A("Last Failure"),I=C(),V=$("div"),H=$("pre"),W=$("code"),q=A(K),te=C(),G=$("div"),B=$("div"),z=$("h4"),se=A("Last Heartbeat Time"),oe=C(),Q=$("p"),re=A(le),ae=C(),this.h()},l(M){t=v(M,"A",{class:!0,href:!0});var O=h(t);o=v(O,"DIV",{class:!0});var fe=h(o);l=D(fe,n),fe.forEach(f),u=S(O),m=v(O,"DIV",{class:!0});var ce=h(m);g=v(ce,"DIV",{class:!0});var X=h(g);s=v(X,"H4",{});var ue=h(s);i=D(ue,"Activity Name"),ue.forEach(f),p=S(X),k=v(X,"P",{});var me=h(k);T=v(me,"SPAN",{class:!0});var de=h(T);d=D(de,c),de.forEach(f),me.forEach(f),X.forEach(f),ce.forEach(f),b=S(O),y=v(O,"DIV",{class:!0});var Y=h(y);N=v(Y,"DIV",{class:!0});var pe=h(N);w=v(pe,"H3",{});var ge=h(w);_=D(ge,"Last Failure"),ge.forEach(f),pe.forEach(f),I=S(Y),V=v(Y,"DIV",{});var _e=h(V);H=v(_e,"PRE",{class:!0});var $e=h(H);W=v($e,"CODE",{class:!0});var ve=h(W);q=D(ve,K),ve.forEach(f),$e.forEach(f),_e.forEach(f),Y.forEach(f),te=S(O),G=v(O,"DIV",{class:!0});var he=h(G);B=v(he,"DIV",{class:!0});var Z=h(B);z=v(Z,"H4",{});var we=h(z);se=D(we,"Last Heartbeat Time"),we.forEach(f),oe=S(Z),Q=v(Z,"P",{});var Ee=h(Q);re=D(Ee,le),Ee.forEach(f),Z.forEach(f),he.forEach(f),ae=S(O),O.forEach(f),this.h()},h(){E(o,"class","w-full md:w-1/12 text-left font-normal text-gray-500 w-40"),E(T,"class","bg-gray-300 text-gray-700 px-2"),E(g,"class","flex gap-2"),E(m,"class","w-full md:w-1/4"),E(N,"class","flex gap-2"),E(W,"class","language-json"),E(H,"class","rounded-lg"),E(y,"class","w-full md:w-5/12"),E(B,"class","flex gap-2"),E(G,"class","w-full md:w-1/4"),E(t,"class","block md:flex content-between w-full border-b-2 border-gray-300 p-2 last-of-type:border-b-0 hover:bg-gray-50"),E(t,"href",e[1]),this.first=t},m(M,O){P(M,t,O),a(t,o),a(o,l),a(t,u),a(t,m),a(m,g),a(g,s),a(s,i),a(g,p),a(g,k),a(k,T),a(T,d),a(t,b),a(t,y),a(y,N),a(N,w),a(w,_),a(y,I),a(y,V),a(V,H),a(H,W),a(W,q),a(t,te),a(t,G),a(G,B),a(B,z),a(z,se),a(B,oe),a(B,Q),a(Q,re),a(t,ae)},p(M,O){e=M},d(M){M&&f(t)}}}function tt(r){let e;return{c(){e=A("Show all")},l(t){e=D(t,"Show all")},m(t,o){P(t,e,o)},d(t){t&&f(e)}}}function st(r){let e,t,o=r[0].length&&et(r);return{c(){o&&o.c(),e=be()},l(n){o&&o.l(n),e=be()},m(n,l){o&&o.m(n,l),P(n,e,l),t=!0},p(n,[l]){n[0].length&&o.p(n,l)},i(n){t||(x(o),t=!0)},o(n){F(o),t=!1},d(n){o&&o.d(n),n&&f(e)}}}function ot(r,e,t){let o;Ne(r,Ge,s=>t(2,o=s));const{pendingActivities:n}=o.stuff.workflow,{namespace:l,workflow:u,run:m}=o.params,g=Be({namespace:l,workflow:u,run:m});return Ve(()=>{window.Prism.highlightAll()}),[n,g]}class rt extends Ce{constructor(e){super(),Se(this,e,ot,st,Te,{})}}function at(r){let e;return{c(){e=A("Summary")},l(t){e=D(t,"Summary")},m(t,o){P(t,e,o)},d(t){t&&f(e)}}}function lt(r){let e;return{c(){e=A("Full")},l(t){e=D(t,"Full")},m(t,o){P(t,e,o)},d(t){t&&f(e)}}}function nt(r){let e;return{c(){e=A("Compact")},l(t){e=D(t,"Compact")},m(t,o){P(t,e,o)},d(t){t&&f(e)}}}function it(r){let e;return{c(){e=A("JSON")},l(t){e=D(t,"JSON")},m(t,o){P(t,e,o)},d(t){t&&f(e)}}}function ft(r){let e,t,o,n,l,u,m,g;return e=new ee({props:{icon:Le,base:U(r[2]("summary")),href:U(r[2]("summary")),$$slots:{default:[at]},$$scope:{ctx:r}}}),o=new ee({props:{icon:Je,href:U(r[2]("full")),$$slots:{default:[lt]},$$scope:{ctx:r}}}),l=new ee({props:{icon:Re,href:U(r[2]("compact")),$$slots:{default:[nt]},$$scope:{ctx:r}}}),m=new ee({props:{icon:je,href:U(r[2]("json")),$$slots:{default:[it]},$$scope:{ctx:r}}}),{c(){L(e.$$.fragment),t=C(),L(o.$$.fragment),n=C(),L(l.$$.fragment),u=C(),L(m.$$.fragment)},l(s){J(e.$$.fragment,s),t=S(s),J(o.$$.fragment,s),n=S(s),J(l.$$.fragment,s),u=S(s),J(m.$$.fragment,s)},m(s,i){R(e,s,i),P(s,t,i),R(o,s,i),P(s,n,i),R(l,s,i),P(s,u,i),R(m,s,i),g=!0},p(s,i){const p={};i&128&&(p.$$scope={dirty:i,ctx:s}),e.$set(p);const k={};i&128&&(k.$$scope={dirty:i,ctx:s}),o.$set(k);const T={};i&128&&(T.$$scope={dirty:i,ctx:s}),l.$set(T);const c={};i&128&&(c.$$scope={dirty:i,ctx:s}),m.$set(c)},i(s){g||(x(e.$$.fragment,s),x(o.$$.fragment,s),x(l.$$.fragment,s),x(m.$$.fragment,s),g=!0)},o(s){F(e.$$.fragment,s),F(o.$$.fragment,s),F(l.$$.fragment,s),F(m.$$.fragment,s),g=!1},d(s){j(e,s),s&&f(t),j(o,s),s&&f(n),j(l,s),s&&f(u),j(m,s)}}}function ct(r){let e,t,o,n,l,u,m,g,s,i,p,k,T,c,d,b,y;o=new ke({props:{heading:"Input",content:r[0],framed:!0}}),l=new ke({props:{heading:"Result",content:r[1],framed:!0}}),m=new rt({}),d=new qe({props:{$$slots:{default:[ft]},$$scope:{ctx:r}}});const N=r[6].default,w=Pe(N,r,r[7],null);return{c(){e=$("section"),t=$("div"),L(o.$$.fragment),n=C(),L(l.$$.fragment),u=C(),L(m.$$.fragment),g=C(),s=$("section"),i=$("nav"),p=$("h3"),k=A("Recent Events"),T=C(),c=$("div"),L(d.$$.fragment),b=C(),w&&w.c(),this.h()},l(_){e=v(_,"SECTION",{class:!0});var I=h(e);t=v(I,"DIV",{class:!0});var V=h(t);J(o.$$.fragment,V),n=S(V),J(l.$$.fragment,V),V.forEach(f),u=S(I),J(m.$$.fragment,I),g=S(I),s=v(I,"SECTION",{id:!0});var H=h(s);i=v(H,"NAV",{class:!0});var W=h(i);p=v(W,"H3",{class:!0});var K=h(p);k=D(K,"Recent Events"),K.forEach(f),T=S(W),c=v(W,"DIV",{id:!0,class:!0});var q=h(c);J(d.$$.fragment,q),q.forEach(f),W.forEach(f),b=S(H),w&&w.l(H),H.forEach(f),I.forEach(f),this.h()},h(){E(t,"class","flex gap-4"),E(p,"class","text-lg font-medium"),E(c,"id","event-view-toggle"),E(c,"class","flex gap-4"),E(i,"class","flex gap-4 justify-between items-end pb-4"),E(s,"id","event-history"),E(e,"class","flex flex-col gap-4")},m(_,I){P(_,e,I),a(e,t),R(o,t,null),a(t,n),R(l,t,null),a(e,u),R(m,e,null),a(e,g),a(e,s),a(s,i),a(i,p),a(p,k),a(i,T),a(i,c),R(d,c,null),a(s,b),w&&w.m(s,null),y=!0},p(_,[I]){const V={};I&128&&(V.$$scope={dirty:I,ctx:_}),d.$set(V),w&&w.p&&(!y||I&128)&&He(w,N,_,_[7],y?xe(N,_[7],I,null):We(_[7]),null)},i(_){y||(x(o.$$.fragment,_),x(l.$$.fragment,_),x(m.$$.fragment,_),x(d.$$.fragment,_),x(w,_),y=!0)},o(_){F(o.$$.fragment,_),F(l.$$.fragment,_),F(m.$$.fragment,_),F(d.$$.fragment,_),F(w,_),y=!1},d(_){_&&f(e),j(o),j(l),j(m),j(d),w&&w.d(_)}}}const Pt=async function({params:r,url:e,stuff:t,fetch:o}){var n;const{workflow:l}=t,{namespace:u}=r,m={namespace:u,workflowId:l.id,runId:l.runId,reverse:Boolean((n=e==null?void 0:e.searchParams)===null||n===void 0?void 0:n.get("sort"))},{events:g,eventGroups:s}=await Fe(m,o);return{props:{namespace:u,workflow:l,events:g,eventGroups:s},stuff:{events:g,eventGroups:s}}};function ut(r,e,t){let{$$slots:o={},$$scope:n}=e,{namespace:l}=e,{workflow:u}=e,{events:m}=e;const{input:g,result:s}=Ze(m),i=(p,k)=>({namespace:l,workflow:u.id,run:u.runId,view:p,eventId:k});return r.$$set=p=>{"namespace"in p&&t(3,l=p.namespace),"workflow"in p&&t(4,u=p.workflow),"events"in p&&t(5,m=p.events),"$$scope"in p&&t(7,n=p.$$scope)},[g,s,i,l,u,m,o,n]}class Ht extends Ce{constructor(e){super(),Se(this,e,ut,ct,Te,{namespace:3,workflow:4,events:5})}}export{Ht as default,Pt as load};
