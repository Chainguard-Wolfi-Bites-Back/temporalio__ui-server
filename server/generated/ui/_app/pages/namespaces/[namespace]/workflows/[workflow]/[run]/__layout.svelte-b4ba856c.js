import{S as z,i as U,s as X,j as A,m as j,o as S,x as $,u as b,v as y,l as de,f as N,r as ve,w as Ie,d as c,t as T,g as P,e as _,c as d,a as k,b as h,R as ke,Q as ce,G as ge,h as O,k as v,n as I,J as u,N as Ee,aw as Ae,ax as je,I as Se,K as ye,L as Ne,M as Te}from"../../../../../../chunks/vendor-07bbbbe5.js";import{W as Pe,a as We}from"../../../../../../chunks/workflow-status-54dbfdbc.js";import{g as De}from"../../../../../../chunks/navigation-51f4a605.js";import{r as Y}from"../../../../../../chunks/route-for-11851a4f.js";import{r as Re,a as Fe,h as He}from"../../../../../../chunks/route-for-api-46d29c40.js";import{n as qe}from"../../../../../../chunks/notifications-ff4076d0.js";import{B as Me}from"../../../../../../chunks/button-ae7eabbe.js";import{p as $e}from"../../../../../../chunks/stores-053bb508.js";import"../../../../../../chunks/singletons-12a22614.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";async function Be({workflow:s,namespace:e,reason:a}){return await Re(Fe("workflow.terminate",{namespace:e,executionId:s.id,runId:s.runId}),{options:{method:"POST",body:JSON.stringify({reason:a})},shouldRetry:!1})}function be(s){let e,a;return e=new Me({props:{destroy:!0,$$slots:{default:[Ce]},$$scope:{ctx:s}}}),e.$on("click",s[2]),{c(){A(e.$$.fragment)},l(r){j(e.$$.fragment,r)},m(r,t){S(e,r,t),a=!0},p(r,t){const n={};t&64&&(n.$$scope={dirty:t,ctx:r}),e.$set(n)},i(r){a||($(e.$$.fragment,r),a=!0)},o(r){b(e.$$.fragment,r),a=!1},d(r){y(e,r)}}}function Ce(s){let e;return{c(){e=T("Terminate")},l(a){e=P(a,"Terminate")},m(a,r){N(a,e,r)},d(a){a&&c(e)}}}function Je(s){let e=s[1](s[0]),a,r,t=e&&be(s);return{c(){t&&t.c(),a=de()},l(n){t&&t.l(n),a=de()},m(n,o){t&&t.m(n,o),N(n,a,o),r=!0},p(n,[o]){o&1&&(e=n[1](n[0])),e?t?(t.p(n,o),o&1&&$(t,1)):(t=be(n),t.c(),$(t,1),t.m(a.parentNode,a)):t&&(ve(),b(t,1,1,()=>{t=null}),Ie())},i(n){r||($(t),r=!0)},o(n){b(t),r=!1},d(n){t&&t.d(n),n&&c(a)}}}function Le(s,e,a){let{workflow:r}=e,{namespace:t}=e,n="";const o=i=>String(i.status)==="Running",l=()=>{n="",qe.add("success","Workflow Terminated"),De(Y("workflow",{namespace:t,workflowId:r.id,runId:r.runId}))},f=()=>{Be({workflow:r,namespace:t,reason:n}).then(l).catch(He)};return s.$$set=i=>{"workflow"in i&&a(0,r=i.workflow),"namespace"in i&&a(3,t=i.namespace)},[r,o,f,t]}class Oe extends z{constructor(e){super();U(this,e,Le,Je,X,{workflow:0,namespace:3})}}function Qe(s){let e;return{c(){e=T(s[1])},l(a){e=P(a,s[1])},m(a,r){N(a,e,r)},p(a,r){r&2&&O(e,a[1])},d(a){a&&c(e)}}}function Ve(s){let e,a,r,t;return{c(){e=T(s[1]),a=v(),r=_("span"),t=T(s[2]),this.h()},l(n){e=P(n,s[1]),a=I(n),r=d(n,"SPAN",{class:!0});var o=k(r);t=P(o,s[2]),o.forEach(c),this.h()},h(){h(r,"class","px-2 text-blue-700 bg-blue-100 rounded-sm")},m(n,o){N(n,e,o),N(n,a,o),N(n,r,o),u(r,t)},p(n,o){o&2&&O(e,n[1]),o&4&&O(t,n[2])},d(n){n&&c(e),n&&c(a),n&&c(r)}}}function Ge(s){let e;function a(n,o){return n[2]?Ve:Qe}let r=a(s),t=r(s);return{c(){e=_("a"),t.c(),this.h()},l(n){e=d(n,"A",{class:!0,href:!0});var o=k(e);t.l(o),o.forEach(c),this.h()},h(){h(e,"class","block svelte-tavydt"),h(e,"href",s[0]),ke(e,"active",s[3])},m(n,o){N(n,e,o),t.m(e,null)},p(n,[o]){r===(r=a(n))&&t?t.p(n,o):(t.d(1),t=r(n),t&&(t.c(),t.m(e,null))),o&1&&h(e,"href",n[0]),o&8&&ke(e,"active",n[3])},i:ce,o:ce,d(n){n&&c(e),t.d()}}}function Ke(s,e,a){let r,t;ge(s,$e,f=>a(4,t=f));let{href:n}=e,{label:o}=e,{amount:l=null}=e;return s.$$set=f=>{"href"in f&&a(0,n=f.href),"label"in f&&a(1,o=f.label),"amount"in f&&a(2,l=f.amount)},s.$$.update=()=>{s.$$.dirty&17&&a(3,r=t.path.includes(n))},[n,o,l,r,t]}class ae extends z{constructor(e){super();U(this,e,Ke,Ge,X,{href:0,label:1,amount:2})}}function ze(s){let e,a,r,t,n,o,l,f,i;return a=new ae({props:{label:"History",href:Y("workflow.events",{namespace:s[0],workflowId:s[1],runId:s[2]}),amount:s[3]}}),t=new ae({props:{label:"Workers",href:Y("workers",{namespace:s[0],workflowId:s[1],runId:s[2]})}}),o=new ae({props:{label:"Stack Trace",href:Y("workflow.stack-trace",{namespace:s[0],workflowId:s[1],runId:s[2]})}}),f=new ae({props:{label:"Query",href:Y("workflow.query",{namespace:s[0],workflowId:s[1],runId:s[2]})}}),{c(){e=_("nav"),A(a.$$.fragment),r=v(),A(t.$$.fragment),n=v(),A(o.$$.fragment),l=v(),A(f.$$.fragment),this.h()},l(w){e=d(w,"NAV",{class:!0});var g=k(e);j(a.$$.fragment,g),r=I(g),j(t.$$.fragment,g),n=I(g),j(o.$$.fragment,g),l=I(g),j(f.$$.fragment,g),g.forEach(c),this.h()},h(){h(e,"class","flex gap-6")},m(w,g){N(w,e,g),S(a,e,null),u(e,r),S(t,e,null),u(e,n),S(o,e,null),u(e,l),S(f,e,null),i=!0},p:ce,i(w){i||($(a.$$.fragment,w),$(t.$$.fragment,w),$(o.$$.fragment,w),$(f.$$.fragment,w),i=!0)},o(w){b(a.$$.fragment,w),b(t.$$.fragment,w),b(o.$$.fragment,w),b(f.$$.fragment,w),i=!1},d(w){w&&c(e),y(a),y(t),y(o),y(f)}}}function Ue(s,e,a){let r;ge(s,$e,i=>a(5,r=i));let{workflow:t}=e;const{namespace:n,workflow:o,run:l}=r.params,f=t==null?void 0:t.historyEvents;return s.$$set=i=>{"workflow"in i&&a(4,t=i.workflow)},[n,o,l,f,t]}class Xe extends z{constructor(e){super();U(this,e,Ue,ze,X,{workflow:4})}}function Ye(s){var me;let e,a,r,t,n,o,l,f,i=s[1].name+"",w,g,W,ne,D,se,R,Q,re,oe,C,V=s[1].id+"",Z,le,F,G,fe,ue,J,K=s[1].runId+"",x,ie,H,q;return t=new Ee({props:{icon:Ae}}),W=new Pe({props:{status:(me=s[1])==null?void 0:me.status}}),D=new Oe({props:{workflow:s[1],namespace:s[0]}}),H=new Xe({props:{workflow:s[1]}}),{c(){e=_("header"),a=_("main"),r=_("a"),A(t.$$.fragment),o=v(),l=_("div"),f=_("h1"),w=T(i),g=v(),A(W.$$.fragment),ne=v(),A(D.$$.fragment),se=v(),R=_("p"),Q=_("span"),re=T("Workflow ID"),oe=v(),C=_("span"),Z=T(V),le=v(),F=_("p"),G=_("span"),fe=T("Run ID"),ue=v(),J=_("span"),x=T(K),ie=v(),A(H.$$.fragment),this.h()},l(m){e=d(m,"HEADER",{class:!0});var p=k(e);a=d(p,"MAIN",{class:!0});var E=k(a);r=d(E,"A",{href:!0,class:!0,style:!0});var L=k(r);j(t.$$.fragment,L),L.forEach(c),o=I(E),l=d(E,"DIV",{class:!0});var M=k(l);f=d(M,"H1",{class:!0});var B=k(f);w=P(B,i),g=I(B),j(W.$$.fragment,B),B.forEach(c),ne=I(M),j(D.$$.fragment,M),M.forEach(c),se=I(E),R=d(E,"P",{class:!0});var ee=k(R);Q=d(ee,"SPAN",{});var we=k(Q);re=P(we,"Workflow ID"),we.forEach(c),oe=I(ee),C=d(ee,"SPAN",{class:!0});var he=k(C);Z=P(he,V),he.forEach(c),ee.forEach(c),le=I(E),F=d(E,"P",{class:!0});var te=k(F);G=d(te,"SPAN",{});var pe=k(G);fe=P(pe,"Run ID"),pe.forEach(c),ue=I(te),J=d(te,"SPAN",{class:!0});var _e=k(J);x=P(_e,K),_e.forEach(c),te.forEach(c),E.forEach(c),ie=I(p),j(H.$$.fragment,p),p.forEach(c),this.h()},h(){h(r,"href",n="/namespaces/"+s[0]+"/workflows"),h(r,"class","absolute top-2 back-to-workflows"),je(r,"left","-1.5rem"),h(f,"class","text-2xl"),h(l,"class","flex justify-between items-center"),h(C,"class","font-medium"),h(R,"class","text-md"),h(J,"class","font-medium"),h(F,"class","text-md"),h(a,"class","flex flex-col gap-1 relative"),h(e,"class","flex flex-col gap-4")},m(m,p){N(m,e,p),u(e,a),u(a,r),S(t,r,null),u(a,o),u(a,l),u(l,f),u(f,w),u(f,g),S(W,f,null),u(l,ne),S(D,l,null),u(a,se),u(a,R),u(R,Q),u(Q,re),u(R,oe),u(R,C),u(C,Z),u(a,le),u(a,F),u(F,G),u(G,fe),u(F,ue),u(F,J),u(J,x),u(e,ie),S(H,e,null),q=!0},p(m,[p]){var B;(!q||p&1&&n!==(n="/namespaces/"+m[0]+"/workflows"))&&h(r,"href",n),(!q||p&2)&&i!==(i=m[1].name+"")&&O(w,i);const E={};p&2&&(E.status=(B=m[1])==null?void 0:B.status),W.$set(E);const L={};p&2&&(L.workflow=m[1]),p&1&&(L.namespace=m[0]),D.$set(L),(!q||p&2)&&V!==(V=m[1].id+"")&&O(Z,V),(!q||p&2)&&K!==(K=m[1].runId+"")&&O(x,K);const M={};p&2&&(M.workflow=m[1]),H.$set(M)},i(m){q||($(t.$$.fragment,m),$(W.$$.fragment,m),$(D.$$.fragment,m),$(H.$$.fragment,m),q=!0)},o(m){b(t.$$.fragment,m),b(W.$$.fragment,m),b(D.$$.fragment,m),b(H.$$.fragment,m),q=!1},d(m){m&&c(e),y(t),y(W),y(D),y(H)}}}function Ze(s,e,a){let{namespace:r}=e,{workflow:t}=e;return s.$$set=n=>{"namespace"in n&&a(0,r=n.namespace),"workflow"in n&&a(1,t=n.workflow)},[r,t]}class xe extends z{constructor(e){super();U(this,e,Ze,Ye,X,{namespace:0,workflow:1})}}function et(s){let e,a,r,t;a=new xe({props:{namespace:s[1],workflow:s[0]}});const n=s[3].default,o=Se(n,s,s[2],null);return{c(){e=_("main"),A(a.$$.fragment),r=v(),o&&o.c(),this.h()},l(l){e=d(l,"MAIN",{class:!0});var f=k(e);j(a.$$.fragment,f),r=I(f),o&&o.l(f),f.forEach(c),this.h()},h(){h(e,"class","flex flex-col gap-6 h-full")},m(l,f){N(l,e,f),S(a,e,null),u(e,r),o&&o.m(e,null),t=!0},p(l,[f]){const i={};f&2&&(i.namespace=l[1]),f&1&&(i.workflow=l[0]),a.$set(i),o&&o.p&&(!t||f&4)&&ye(o,n,l,l[2],t?Te(n,l[2],f,null):Ne(l[2]),null)},i(l){t||($(a.$$.fragment,l),$(o,l),t=!0)},o(l){b(a.$$.fragment,l),b(o,l),t=!1},d(l){l&&c(e),y(a),o&&o.d(l)}}}async function mt({page:s}){const{workflow:e,run:a,namespace:r}=s.params,n=await We({namespace:r,executionId:e,runId:a},fetch);return{props:{workflow:n,namespace:r},stuff:{workflow:n}}}function tt(s,e,a){let{$$slots:r={},$$scope:t}=e,{workflow:n}=e,{namespace:o}=e;return s.$$set=l=>{"workflow"in l&&a(0,n=l.workflow),"namespace"in l&&a(1,o=l.namespace),"$$scope"in l&&a(2,t=l.$$scope)},[n,o,t,r]}class wt extends z{constructor(e){super();U(this,e,tt,et,X,{workflow:0,namespace:1})}}export{wt as default,mt as load};
