import{S as M,b as N,a as T,C as q,D as A,E as B,j as w,g as k,F as E,m as Y,p as Z,q as x,k as p,u as $,f as y,z as G,aa as tt,ab as et,h as O,K as I,a6 as nt,a5 as v,e as h,n as F,G as ot,H as st,I as rt,J as lt,w as at,x as ut,y as ct}from"./index.9b814669.js";import{p as ft}from"./stores.6b0cc99e.js";import{S as it}from"./index.73889952.js";import{r as _t,a as C,f as V}from"./workflows.06f0e84e.js";import{a as mt}from"./decode-payload.d4a0161d.js";import{W as dt}from"./workflow-status.27af3610.js";import{t as wt}from"./translate.c28e5b4f.js";const S=["Running","TimedOut","Completed","Failed","ContinuedAsNew","Canceled","Terminated"];function Et(o){return S.includes(o)}const Gt=["All",...S],j=(o,t,e)=>{const s=Math.pow(3600/o,1/e),l=o*Math.pow(s,t);return Math.min(3600,Math.round(l))};function kt(o){let t,e;return t=new dt({props:{count:o[1],newCount:o[2],status:o[0],"test-id":"workflow-status-"+o[0]}}),{c(){q(t.$$.fragment)},l(n){A(t.$$.fragment,n)},m(n,s){B(t,n,s),e=!0},p(n,[s]){const l={};s&2&&(l.count=n[1]),s&4&&(l.newCount=n[2]),s&1&&(l.status=n[0]),s&1&&(l["test-id"]="workflow-status-"+n[0]),t.$set(l)},i(n){e||(w(t.$$.fragment,n),e=!0)},o(n){k(t.$$.fragment,n),e=!1},d(n){E(t,n)}}}function ht(o,t,e){let{status:n}=t,{count:s=0}=t,{newCount:l=0}=t;return o.$$set=a=>{"status"in a&&e(0,n=a.status),"count"in a&&e(1,s=a.count),"newCount"in a&&e(2,l=a.newCount)},[n,s,l]}class pt extends M{constructor(t){super(),N(this,t,ht,kt,T,{status:0,count:1,newCount:2})}}function z(o,t,e){const n=o.slice();return n[18]=t[e].count,n[19]=t[e].status,n}function gt(o){let t,e;return t=new it({props:{class:"h-6 w-24 rounded"}}),{c(){q(t.$$.fragment)},l(n){A(t.$$.fragment,n)},m(n,s){B(t,n,s),e=!0},p:F,i(n){e||(w(t.$$.fragment,n),e=!0)},o(n){k(t.$$.fragment,n),e=!1},d(n){E(t,n)}}}function yt(o){let t,e;function n(...l){return o[8](o[19],...l)}function s(...l){return o[9](o[19],...l)}return t=new pt({props:{status:o[19],count:o[18],newCount:o[1].find(n)?o[1].find(s).count-o[18]:0}}),{c(){q(t.$$.fragment)},l(l){A(t.$$.fragment,l)},m(l,a){B(t,l,a),e=!0},p(l,a){o=l;const u={};a&1&&(u.status=o[19]),a&1&&(u.count=o[18]),a&3&&(u.newCount=o[1].find(n)?o[1].find(s).count-o[18]:0),t.$set(u)},i(l){e||(w(t.$$.fragment,l),e=!0)},o(l){k(t.$$.fragment,l),e=!1},d(l){E(t,l)}}}function H(o,t){let e,n,s,l,a;const u=[yt,gt],r=[];function c(i,m){return i[2]?1:0}return n=c(t),s=r[n]=u[n](t),{key:o,first:null,c(){e=h(),s.c(),l=h(),this.h()},l(i){e=h(),s.l(i),l=h(),this.h()},h(){this.first=e},m(i,m){y(i,e,m),r[n].m(i,m),y(i,l,m),a=!0},p(i,m){t=i;let d=n;n=c(t),n===d?r[n].p(t,m):(G(),k(r[d],1,1,()=>{r[d]=null}),O(),s=r[n],s?s.p(t,m):(s=r[n]=u[n](t),s.c()),w(s,1),s.m(l.parentNode,l))},i(i){a||(w(s),a=!0)},o(i){k(s),a=!1},d(i){i&&p(e),r[n].d(i),i&&p(l)}}}function bt(o){let t,e=[],n=new Map,s,l=o[0];const a=u=>u[19];for(let u=0;u<l.length;u+=1){let r=z(o,l,u),c=a(r);n.set(c,e[u]=H(c,r))}return{c(){t=Y("div");for(let u=0;u<e.length;u+=1)e[u].c();this.h()},l(u){t=Z(u,"DIV",{class:!0});var r=x(t);for(let c=0;c<e.length;c+=1)e[c].l(r);r.forEach(p),this.h()},h(){$(t,"class","flex min-h-[24px] flex-wrap items-center gap-2")},m(u,r){y(u,t,r);for(let c=0;c<e.length;c+=1)e[c].m(t,null);s=!0},p(u,[r]){r&7&&(l=u[0],G(),e=tt(e,r,a,1,u,l,n,t,et,H,null,z),O())},i(u){if(!s){for(let r=0;r<l.length;r+=1)w(e[r]);s=!0}},o(u){for(let r=0;r<e.length;r+=1)k(e[r]);s=!1},d(u){u&&p(t);for(let r=0;r<e.length;r+=1)e[r].d()}}}const J=5,W=100;function Ct(o,t,e){let n,s,l,a,u;I(o,_t,f=>e(6,l=f)),I(o,C,f=>e(12,a=f)),I(o,ft,f=>e(7,u=f));let{staticQuery:r=""}=t,c=[],i=[],m,d=1,b=!1;nt(()=>{Q()});const K=()=>{if(d+=1,clearInterval(m),d<=W){const f=j(J,d,W)*1e3;m=setInterval(()=>P(),f)}},Q=()=>{clearInterval(m),e(1,i=[]),v(C,a.newCount=0,a),d=1,e(2,b=!0)},D=(f=[])=>f.map(_=>{const g=mt(_==null?void 0:_.groupValues[0]),X=parseInt(_.count);return{status:g,count:X}}).sort((_,g)=>S.indexOf(_.status)-S.indexOf(g.status)),P=async()=>{K();try{const{count:f,groups:_}=await V({namespace:n,query:s});v(C,a.newCount=parseInt(f)-a.count,a),e(1,i=D(_))}catch(f){console.error("Fetching workflow counts failed: ",f==null?void 0:f.message)}finally{e(2,b=!1)}},R=async()=>{Q();const f=j(J,d,W)*1e3;m=setInterval(()=>P(),f);try{const{count:_,groups:g}=await V({namespace:n,query:s});v(C,a.count=parseInt(_),a),e(0,c=D(g))}catch(_){console.error("Fetching workflow counts failed: ",_==null?void 0:_.message)}finally{e(2,b=!1)}},L=(f,_)=>_.status===f,U=(f,_)=>_.status===f;return o.$$set=f=>{"staticQuery"in f&&e(3,r=f.staticQuery)},o.$$.update=()=>{o.$$.dirty&128&&e(4,n=u.params.namespace),o.$$.dirty&136&&e(5,s=r||u.url.searchParams.get("query")),o.$$.dirty&112&&R()},[c,i,b,r,n,s,l,u,L,U]}class Ot extends M{constructor(t){super(),N(this,t,Ct,bt,T,{staticQuery:3})}}function St(o){let t;const e=o[5].default,n=ot(e,o,o[4],null);return{c(){n&&n.c()},l(s){n&&n.l(s)},m(s,l){n&&n.m(s,l),t=!0},p(s,l){n&&n.p&&(!t||l&16)&&st(n,e,s,s[4],t?lt(e,s[4],l,null):rt(s[4]),null)},i(s){t||(w(n,s),t=!0)},o(s){k(n,s),t=!1},d(s){n&&n.d(s)}}}function It(o){let t;return{c(){t=at(o[1])},l(e){t=ut(e,o[1])},m(e,n){y(e,t,n)},p(e,n){n&2&&ct(t,e[1])},i:F,o:F,d(e){e&&p(t)}}}function vt(o){let t,e,n,s;const l=[It,St],a=[];function u(r,c){return r[1]!==r[0]?0:1}return t=u(o),e=a[t]=l[t](o),{c(){e.c(),n=h()},l(r){e.l(r),n=h()},m(r,c){a[t].m(r,c),y(r,n,c),s=!0},p(r,[c]){let i=t;t=u(r),t===i?a[t].p(r,c):(G(),k(a[i],1,1,()=>{a[i]=null}),O(),e=a[t],e?e.p(r,c):(e=a[t]=l[t](r),e.c()),w(e,1),e.m(n.parentNode,n))},i(r){s||(w(e),s=!0)},o(r){k(e),s=!1},d(r){a[t].d(r),r&&p(n)}}}function Wt(o,t,e){let n,{$$slots:s={},$$scope:l}=t,{key:a}=t,{count:u=void 0}=t,{replace:r=void 0}=t;return o.$$set=c=>{"key"in c&&e(0,a=c.key),"count"in c&&e(2,u=c.count),"replace"in c&&e(3,r=c.replace),"$$scope"in c&&e(4,l=c.$$scope)},o.$$.update=()=>{o.$$.dirty&13&&e(1,n=wt(a,{count:u,...r}))},[a,n,u,r,l,s]}class Qt extends M{constructor(t){super(),N(this,t,Wt,vt,T,{key:0,count:2,replace:3})}}export{Qt as T,Ot as W,Et as i,Gt as w};
