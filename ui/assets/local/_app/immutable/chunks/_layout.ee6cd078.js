import{r as f}from"./index.b1f5b21f.js";import{r as a,a as m}from"./route-for-api.f70c0cd5.js";import{f as p}from"./namespaces-service.a5a4f3f5.js";import{f as d}from"./settings-service.9b265625.js";import{s as h,g as k}from"./auth-user.6f15fe0f.js";import{B as l,f as g}from"./route-for.33e21fab.js";import{a as y}from"./atob.47ffdf57.js";import{p as w}from"./parse-with-big-int.0036a80a.js";/* empty css            */const A=async(n,t=fetch)=>{if(n.runtimeEnvironment.isCloud)return;const o=a("cluster");return await m(o,{request:t}).then(s=>s)},T=async(n,t=fetch)=>{if(n.runtimeEnvironment.isCloud)return;const o=a("systemInfo");return await m(o,{request:t}).then(s=>s)},c="user",_=(n=l)=>{if(!n)return{};const t=document.cookie.split(";");let o=0,s=t.find(r=>r.includes(c+o)),i="";for(;s;){const[r,e]=s.split("=");i+=e,o++,s=t.find(u=>u.includes(c+o))}if(i)try{const r=y(i),e=w(r);return{accessToken:e==null?void 0:e.AccessToken,idToken:e==null?void 0:e.IDToken,name:e==null?void 0:e.Name,picture:e==null?void 0:e.Picture,email:e==null?void 0:e.Email}}catch(r){console.error(r)}return{}},I=(n=l)=>{if(!n)return;const t=document.cookie.split(";");let o=0,s=t.find(i=>i.includes(c+o));for(;s;){const[i]=s.split("=");document.cookie=`${i}=; max-age=-1; path=/`,o++,s=t.find(r=>r.includes(c+o))}},S=(n,t)=>!n.auth.enabled||Boolean(t==null?void 0:t.accessToken),b=async function({fetch:n}){const t=await d(n),o=_();o!=null&&o.accessToken&&(h(o),I());const s=k();if(!S(t,s))throw f(302,g());p(t,n);const i=await A(t,n),r=await T(t,n);return{user:s,settings:t,cluster:i,systemInfo:r}},U=Object.freeze(Object.defineProperty({__proto__:null,load:b},Symbol.toStringTag,{value:"Module"}));export{U as _,b as l};
