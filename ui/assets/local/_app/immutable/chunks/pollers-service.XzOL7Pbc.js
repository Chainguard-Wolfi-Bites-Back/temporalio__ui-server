import{s as H,e as v,b as V,d as S,g as p,j as k,k as T,t as R,f as L,l as b,n as j,p as Q,a as C,h as A,u as E,q as F,r as P}from"./scheduler.CFZRjJlR.js";import{S as M,i as z,g as G,b as _,e as J,t as g,c as D,a as N,m as q,d as K}from"./index.S8Ql5up0.js";import{I as U}from"./icon.zVlHozX4.js";import{t as W}from"./tw-merge.NbP7EmZe.js";import{t as I}from"./translate.HrioCK44.js";import{r as y,a as h}from"./route-for-api.QrnDw3jv.js";const X=e=>({}),B=e=>({}),Z=e=>({}),O=e=>({});function $(e){let t,s,n,r;return s=new U({props:{name:"merge"}}),{c(){t=v("span"),D(s.$$.fragment),n=R(e[2]),this.h()},l(l){t=V(l,"SPAN",{class:!0});var i=S(t);N(s.$$.fragment,i),n=L(i,e[2]),i.forEach(p),this.h()},h(){k(t,"class","flex items-center gap-1 rounded border px-1 text-sm")},m(l,i){T(l,t,i),q(s,t,null),b(t,n),r=!0},p(l,i){(!r||i&4)&&j(n,l[2])},i(l){r||(g(s.$$.fragment,l),r=!0)},o(l){_(s.$$.fragment,l),r=!1},d(l){l&&p(t),K(s)}}}function w(e){let t,s,n,r,l,i,c;s=new U({props:{name:"merge"}});const a=e[4]["overall-default-worker"],o=Q(a,e,e[3],O),m=e[4]["default-worker"],f=Q(m,e,e[3],B);return{c(){t=v("span"),D(s.$$.fragment),n=R(e[2]),r=C(),o&&o.c(),l=C(),f&&f.c(),this.h()},l(u){t=V(u,"SPAN",{class:!0});var d=S(t);N(s.$$.fragment,d),n=L(d,e[2]),r=A(d),o&&o.l(d),l=A(d),f&&f.l(d),d.forEach(p),this.h()},h(){k(t,"class",i=W("flex items-center gap-1 rounded border px-1 text-sm",e[1]&&"border-green-100 bg-green-100 text-green-800"))},m(u,d){T(u,t,d),q(s,t,null),b(t,n),b(t,r),o&&o.m(t,null),b(t,l),f&&f.m(t,null),c=!0},p(u,d){(!c||d&4)&&j(n,u[2]),o&&o.p&&(!c||d&8)&&E(o,a,u,u[3],c?P(a,u[3],d,Z):F(u[3]),O),f&&f.p&&(!c||d&8)&&E(f,m,u,u[3],c?P(m,u[3],d,X):F(u[3]),B),(!c||d&2&&i!==(i=W("flex items-center gap-1 rounded border px-1 text-sm",u[1]&&"border-green-100 bg-green-100 text-green-800")))&&k(t,"class",i)},i(u){c||(g(s.$$.fragment,u),g(o,u),g(f,u),c=!0)},o(u){_(s.$$.fragment,u),_(o,u),_(f,u),c=!1},d(u){u&&p(t),K(s),o&&o.d(u),f&&f.d(u)}}}function x(e){let t,s,n,r;const l=[w,$],i=[];function c(a,o){return a[0]&&a[2]?0:a[2]?1:-1}return~(s=c(e))&&(n=i[s]=l[s](e)),{c(){t=v("p"),n&&n.c(),this.h()},l(a){t=V(a,"P",{class:!0});var o=S(t);n&&n.l(o),o.forEach(p),this.h()},h(){k(t,"class","flex select-all gap-2 font-mono")},m(a,o){T(a,t,o),~s&&i[s].m(t,null),r=!0},p(a,[o]){let m=s;s=c(a),s===m?~s&&i[s].p(a,o):(n&&(G(),_(i[m],1,1,()=>{i[m]=null}),J()),~s?(n=i[s],n?n.p(a,o):(n=i[s]=l[s](a),n.c()),g(n,1),n.m(t,null)):n=null)},i(a){r||(g(n),r=!0)},o(a){_(n),r=!1},d(a){a&&p(t),~s&&i[s].d()}}}function ee(e,t,s){let{$$slots:n={},$$scope:r}=t,{defaultVersion:l=!1}=t,{active:i=!1}=t,{buildId:c}=t;return e.$$set=a=>{"defaultVersion"in a&&s(0,l=a.defaultVersion),"active"in a&&s(1,i=a.active),"buildId"in a&&s(2,c=a.buildId),"$$scope"in a&&s(3,r=a.$$scope)},[l,i,c,r,n]}class de extends M{constructor(t){super(),z(this,t,ee,x,H,{defaultVersion:0,active:1,buildId:2})}}const Y=e=>(e!=null&&e.majorVersionSets?[...e.majorVersionSets]:[]).reverse(),te=e=>{if(!(!e||!e.length))return e[e.length-1]},me=e=>e?e.slice(0,e.length-1).reverse():[],_e=e=>{var n;const t=Y(e);if(!t.length)return;const s=(n=t[0])==null?void 0:n.buildIds;if(s!=null&&s.length)return te(t[0].buildIds)},ge=e=>{var t,s;if(e!=null&&e.assignedBuildId)return e.assignedBuildId;if((t=e==null?void 0:e.mostRecentWorkerVersionStamp)!=null&&t.useVersioning)return((s=e.mostRecentWorkerVersionStamp)==null?void 0:s.buildId)||void 0},se=e=>{var t,s;if((t=e==null?void 0:e.workerVersionCapabilities)!=null&&t.useVersioning)return((s=e.workerVersionCapabilities)==null?void 0:s.buildId)||void 0},pe=e=>[...new Set(e==null?void 0:e.map(se).filter(Boolean))],he=e=>e==null?void 0:e.some(t=>{var s;return(s=t==null?void 0:t.workerVersionCapabilities)==null?void 0:s.useVersioning});async function be(e,t=fetch){var a;const s=y("task-queue",e),n=await h(s,{request:t,params:{taskQueueType:"1"}}),r=await h(s,{request:t,params:{taskQueueType:"2"}});n!=null&&n.pollers||(n.pollers=[]),r!=null&&r.pollers||(r.pollers=[]),r.pollers.forEach(o=>{o.taskQueueTypes=["ACTIVITY"]}),n.pollers.forEach(o=>{o.taskQueueTypes=["WORKFLOW"]});const l=o=>(m,f)=>{const u=m[f.identity]||{lastAccessTime:void 0,taskQueueTypes:[]};return m[f.identity]={lastAccessTime:!u.lastAccessTime||u.lastAccessTime<f.lastAccessTime?f.lastAccessTime:u.lastAccessTime,taskQueueTypes:u.taskQueueTypes.concat([o])},m};r.pollers.filter(o=>n.pollers.some(m=>{if(o.identity===m.identity)return o.taskQueueTypes=[...m.taskQueueTypes,...o.taskQueueTypes],o})),(a=r.pollers)==null||a.reduce(l("ACTIVITY"),n.pollers.reduce(l("WORKFLOW"),{}));const i=r.pollers.length?r.pollers:n.pollers,c=r.pollers.length?r.taskQueueStatus:n.taskQueueStatus;return{pollers:i,taskQueueStatus:c}}async function ke(e,t=fetch){const s=await ne(e,t),n=await re(e,t),r=Y(n);return{rules:s,compatibility:n,versionSets:r}}async function ne(e,t=fetch){const s=y("task-queue.rules",e);return h(s,{request:t,handleError:n=>{}})}async function re(e,t=fetch){const s=y("task-queue.compatibility",e);return h(s,{request:t,handleError:n=>{}})}async function ye(e,t=fetch){const{namespace:s,buildIds:n,queue:r}=e,l=y("worker-task-reachability",{namespace:s}),i=new URLSearchParams;if(n.length)for(const c of n)i.append("buildIds",c);else i.append("buildIds",""),i.append("taskQueues",r);return await h(l,{request:t,params:i,handleError:c=>({buildIdReachability:[]})})}function ae(e){return!e||!e.length?I("workers.ready-to-be-retired"):e.length===1&&e.includes("CLOSED")?I("common.maybe"):I("common.no")}function Ie(e,t,s){var i,c;const n=(i=e==null?void 0:e.buildIdReachability)==null?void 0:i.find(a=>a.buildId===s);if(!n)return"";const r=(c=n==null?void 0:n.taskQueueReachability)==null?void 0:c.find(a=>(a==null?void 0:a.taskQueue)===t);if(!r)return"";const l=r==null?void 0:r.reachability;return ae(l)}export{de as C,_e as a,se as b,Ie as c,te as d,me as e,ke as f,Y as g,pe as h,ye as i,be as j,ge as k,he as p};
