import{S as j,b as z,a as G,m as y,p as v,q as I,k as p,u as Q,f as T,z as H,g as m,h as J,j as d,C as P,w as W,D as R,x as B,E as D,L as g,y as K,F as N,G as A,c as E,d as S,Q as h,H as C,I as F,J as L}from"./index.0942deb7.js";import{I as Y}from"./icon.33308831.js";import{t as b}from"./translate.135d909a.js";import{r as w,a as k}from"./route-for-api.17f1daf7.js";const U=r=>({}),V=r=>({}),q=r=>({}),O=r=>({});function M(r){let e,a,t,o;return a=new Y({props:{name:"merge"}}),{c(){e=y("span"),P(a.$$.fragment),t=W(r[2]),this.h()},l(i){e=v(i,"SPAN",{class:!0});var n=I(e);R(a.$$.fragment,n),t=B(n,r[2]),n.forEach(p),this.h()},h(){Q(e,"class","version svelte-1b9fh62")},m(i,n){T(i,e,n),D(a,e,null),g(e,t),o=!0},p(i,n){(!o||n&4)&&K(t,i[2])},i(i){o||(d(a.$$.fragment,i),o=!0)},o(i){m(a.$$.fragment,i),o=!1},d(i){i&&p(e),N(a)}}}function X(r){let e,a,t,o,i,n;a=new Y({props:{name:"merge"}});const _=r[4]["overall-default-worker"],s=A(_,r,r[3],O),c=r[4]["default-worker"],u=A(c,r,r[3],V);return{c(){e=y("span"),P(a.$$.fragment),t=W(r[2]),o=E(),s&&s.c(),i=E(),u&&u.c(),this.h()},l(l){e=v(l,"SPAN",{class:!0});var f=I(e);R(a.$$.fragment,f),t=B(f,r[2]),o=S(f),s&&s.l(f),i=S(f),u&&u.l(f),f.forEach(p),this.h()},h(){Q(e,"class","svelte-1b9fh62"),h(e,"active-version",r[1]),h(e,"version",!r[1])},m(l,f){T(l,e,f),D(a,e,null),g(e,t),g(e,o),s&&s.m(e,null),g(e,i),u&&u.m(e,null),n=!0},p(l,f){(!n||f&4)&&K(t,l[2]),s&&s.p&&(!n||f&8)&&C(s,_,l,l[3],n?L(_,l[3],f,q):F(l[3]),O),u&&u.p&&(!n||f&8)&&C(u,c,l,l[3],n?L(c,l[3],f,U):F(l[3]),V),(!n||f&2)&&h(e,"active-version",l[1]),(!n||f&2)&&h(e,"version",!l[1])},i(l){n||(d(a.$$.fragment,l),d(s,l),d(u,l),n=!0)},o(l){m(a.$$.fragment,l),m(s,l),m(u,l),n=!1},d(l){l&&p(e),N(a),s&&s.d(l),u&&u.d(l)}}}function Z(r){let e,a,t,o;const i=[X,M],n=[];function _(s,c){return s[0]&&s[2]?0:s[2]?1:-1}return~(a=_(r))&&(t=n[a]=i[a](r)),{c(){e=y("p"),t&&t.c(),this.h()},l(s){e=v(s,"P",{class:!0});var c=I(e);t&&t.l(c),c.forEach(p),this.h()},h(){Q(e,"class","flex select-all gap-2 font-mono")},m(s,c){T(s,e,c),~a&&n[a].m(e,null),o=!0},p(s,[c]){let u=a;a=_(s),a===u?~a&&n[a].p(s,c):(t&&(H(),m(n[u],1,1,()=>{n[u]=null}),J()),~a?(t=n[a],t?t.p(s,c):(t=n[a]=i[a](s),t.c()),d(t,1),t.m(e,null)):t=null)},i(s){o||(d(t),o=!0)},o(s){m(t),o=!1},d(s){s&&p(e),~a&&n[a].d()}}}function $(r,e,a){let{$$slots:t={},$$scope:o}=e,{defaultVersion:i=!1}=e,{active:n=!1}=e,{buildId:_=""}=e;return r.$$set=s=>{"defaultVersion"in s&&a(0,i=s.defaultVersion),"active"in s&&a(1,n=s.active),"buildId"in s&&a(2,_=s.buildId),"$$scope"in s&&a(3,o=s.$$scope)},[i,n,_,o,t]}class ne extends j{constructor(e){super(),z(this,e,$,Z,G,{defaultVersion:0,active:1,buildId:2})}}async function re(r,e=fetch){var s;const a=w("task-queue",r),t=await k(a,{request:e,params:{taskQueueType:"1"}}),o=await k(a,{request:e,params:{taskQueueType:"2"}});t!=null&&t.pollers||(t.pollers=[]),o!=null&&o.pollers||(o.pollers=[]),o.pollers.forEach(c=>{c.taskQueueTypes=["ACTIVITY"]}),t.pollers.forEach(c=>{c.taskQueueTypes=["WORKFLOW"]});const i=c=>(u,l)=>{const f=u[l.identity]||{lastAccessTime:void 0,taskQueueTypes:[]};return u[l.identity]={lastAccessTime:!f.lastAccessTime||f.lastAccessTime<l.lastAccessTime?l.lastAccessTime:f.lastAccessTime,taskQueueTypes:f.taskQueueTypes.concat([c])},u};o.pollers.filter(c=>t.pollers.some(u=>{if(c.identity===u.identity)return c.taskQueueTypes=[...u.taskQueueTypes,...c.taskQueueTypes],c})),(s=o.pollers)==null||s.reduce(i("ACTIVITY"),t.pollers.reduce(i("WORKFLOW"),{}));const n=o.pollers.length?o.pollers:t.pollers,_=o.pollers.length?o.taskQueueStatus:t.taskQueueStatus;return{pollers:n,taskQueueStatus:_}}async function oe(r,e=fetch){const a=w("task-queue.compatibility",r);return k(a,{request:e,onError:t=>console.error(t)})}async function le(r,e=fetch){const{namespace:a,buildIds:t,taskQueue:o}=r,i=w("worker-task-reachability",{namespace:a}),n=new URLSearchParams;if(t.length)for(const _ of t)n.append("buildIds",_);else n.append("buildIds",""),n.append("taskQueues",o);return await k(i,{request:e,params:n,onError:_=>(console.error(_),{buildIdReachability:[]})})}function x(r){return!r||!r.length?b("workers.ready-to-be-retired"):r.length===1&&r.includes("CLOSED")?b("common.maybe"):b("common.no")}function ie(r,e,a){var n,_;const t=(n=r==null?void 0:r.buildIdReachability)==null?void 0:n.find(s=>s.buildId===a);if(!t)return"";const o=(_=t==null?void 0:t.taskQueueReachability)==null?void 0:_.find(s=>(s==null?void 0:s.taskQueue)===e);if(!o)return"";const i=o==null?void 0:o.reachability;return x(i)}export{ne as C,oe as a,le as b,ie as c,re as g};
