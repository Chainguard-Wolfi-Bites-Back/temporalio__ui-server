import{d as c,r as d,w as n}from"./entry.87OW82fz.js";import{p as u}from"./stores.4CDhhIIH.js";import{t as y}from"./translate.HrioCK44.js";import{v as f,z as k}from"./scheduler.LRpOgQOC.js";import{r as w,a as p}from"./route-for-api.aN9DM8Tq.js";import{s as h,b}from"./workflow-service.o1WU4nio.js";import{m as E}from"./version-check.HLZIw2tw.js";import{t as g}from"./versions.3gOjGWhG.js";const C=async(o,r,s=fetch)=>{let t=0;try{const e=w("workflows.count",{namespace:o}),a=await p(e,{params:r?{query:r}:{},onError:f,handleError:f,request:s});t=parseInt((a==null?void 0:a.count)||"0")}catch{}return{count:t}},Y=async({namespace:o,query:r})=>{const s="GROUP BY ExecutionStatus",t=w("workflows.count",{namespace:o}),{count:e,groups:a}=await p(t,{params:{query:r?`${r} ${s}`:`${s}`},notifyOnError:!1});return{count:e??"0",groups:a}},W=300,v=async(o,r,s)=>{r.set(!0);try{await s()}catch(t){console.error(t)}o.set(!1),setTimeout(()=>{r.set(!1)},W)},B=c([u],([o])=>{var r,s,t;return!!((t=(s=(r=o.data)==null?void 0:r.systemInfo)==null?void 0:s.capabilities)!=null&&t.countGroupByExecutionStatus)}),j=c([u,g],([o,r])=>{var e,a,i;const s=E("1.23.0",r),t=!!((i=(a=(e=o.data)==null?void 0:e.systemInfo)==null?void 0:a.capabilities)!=null&&i.prefixSearch);return s||t}),q=n(0),x=c([u],([o])=>{var r,s;return(s=(r=o.data)==null?void 0:r.settings)==null?void 0:s.hideWorkflowQueryErrors}),A=c([u],([o])=>o.params.namespace),S=c([u],([o])=>o.url.searchParams.get("query")),V=c([A,S,q,h,x],([o,r,s,t,e])=>({namespace:o,query:r,refresh:s,supportsAdvancedVisibility:t,hideWorkflowQueryErrors:e})),Q=o=>{$.set({...o,newCount:0})},I=o=>V.subscribe(({namespace:r,query:s,supportsAdvancedVisibility:t,hideWorkflowQueryErrors:e})=>{v(R,P,async()=>{const{workflows:a,error:i}=await b(r,{query:s});if(o(a),t&&!k(B)){const m=await C(r,s);Q(m)}i?e?l.set(y("workflows.workflows-error-querying")):l.set(i):l.set("")})}),D=n(""),P=n(!0),R=n(!0),$=n({count:0,newCount:0}),l=n(""),H=d([],I),J=n("");export{D as a,J as b,l as c,H as d,Y as f,B as g,R as l,j as p,q as r,P as u,$ as w};
