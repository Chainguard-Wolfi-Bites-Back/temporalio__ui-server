import{s as K,S as D,T as M,e as W,t as q,b as H,d as A,f as B,g as w,j as z,k as N,l as v,v as P,a3 as L,w as F,c as Y,a as G,h as J,x as Z,y as ie}from"./scheduler.LRpOgQOC.js";import{S as O,i as Q,f as C,c as y,a as E,m as R,t as k,b as T,d as I,g as fe,e as ce}from"./index.dE1eZLcR.js";import{M as U}from"./modal.xqNn_aOY.js";import{t as h}from"./translate.HrioCK44.js";import{c as me,r as ue,t as pe}from"./workflow-service.WwirNtUT.js";import{t as oe}from"./toaster.uV-sJ0Ub.js";import{i as X}from"./is-network-error.m1ZFLdb3.js";import{e as $}from"./each._Tp_Nd1G.js";import{w as de}from"./entry.TZPdPAQh.js";import{C as _e}from"./checkbox.ODjA0fL5.js";import{I as ne}from"./input.i2DGY5n_.js";import{R as he,a as ge}from"./radio-input.c0M5SyUs.js";import{R as j}from"./workflow-actions.-K4W_iAA.js";import{r as we}from"./events.LudOLAAq.js";import{p as be}from"./persist-store.MYHe9whO.js";function ke(r){let e,n=h("workflows.cancel-modal-title")+"",s;return{c(){e=W("h3"),s=q(n),this.h()},l(t){e=H(t,"H3",{slot:!0});var i=A(e);s=B(i,n),i.forEach(w),this.h()},h(){z(e,"slot","title")},m(t,i){N(t,e,i),v(e,s)},p:P,d(t){t&&w(e)}}}function Te(r){let e,n=h("workflows.cancel-modal-confirmation")+"",s;return{c(){e=W("p"),s=q(n)},l(t){e=H(t,"P",{});var i=A(e);s=B(i,n),i.forEach(w)},m(t,i){N(t,e,i),v(e,s)},p:P,d(t){t&&w(e)}}}function ve(r){let e,n,s,t;function i(o){r[7](o)}function a(o){r[8](o)}let f={id:"cancel-confirmation-modal","data-testid":"cancel-confirmation-modal",confirmText:h("common.confirm"),cancelText:h("common.cancel"),loading:r[2],confirmType:"destructive",$$slots:{content:[Te],title:[ke]},$$scope:{ctx:r}};return r[3]!==void 0&&(f.error=r[3]),r[0]!==void 0&&(f.open=r[0]),e=new U({props:f}),D.push(()=>C(e,"error",i)),D.push(()=>C(e,"open",a)),e.$on("confirmModal",r[4]),{c(){y(e.$$.fragment)},l(o){E(e.$$.fragment,o)},m(o,c){R(e,o,c),t=!0},p(o,[c]){const m={};c&4&&(m.loading=o[2]),c&1024&&(m.$$scope={dirty:c,ctx:o}),!n&&c&8&&(n=!0,m.error=o[3],M(()=>n=!1)),!s&&c&1&&(s=!0,m.open=o[0],M(()=>s=!1)),e.$set(m)},i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){T(e.$$.fragment,o),t=!1},d(o){I(e,o)}}}function ye(r,e,n){let s,t=P,i=()=>(t(),t=L(c,d=>n(9,s=d)),c);r.$$.on_destroy.push(()=>t());let{open:a}=e,{workflow:f}=e,{namespace:o}=e,{refresh:c}=e;i();let m,l="";const u=async()=>{n(3,l=""),n(2,m=!0);try{await me({namespace:o,workflow:f}),n(0,a=!1),F(c,s=Date.now(),s),oe.push({id:"workflow-cancelation-success-toast",message:h("workflows.cancel-success")})}catch(d){n(3,l=X(d)?d.message:h("common.unknown-error"))}finally{n(2,m=!1)}};function g(d){l=d,n(3,l)}function b(d){a=d,n(0,a)}return r.$$set=d=>{"open"in d&&n(0,a=d.open),"workflow"in d&&n(5,f=d.workflow),"namespace"in d&&n(6,o=d.namespace),"refresh"in d&&i(n(1,c=d.refresh))},[a,c,m,l,u,f,o,g,b]}class Xe extends O{constructor(e){super(),Q(this,e,ye,ve,K,{open:0,workflow:5,namespace:6,refresh:1})}}const Ee=be("resetWorkflows",{});function x(r,e,n){const s=r.slice();return s[18]=e[n],s}function Re(r){let e,n=h("workflows.reset-modal-title")+"",s;return{c(){e=W("h3"),s=q(n),this.h()},l(t){e=H(t,"H3",{slot:!0});var i=A(e);s=B(i,n),i.forEach(w),this.h()},h(){z(e,"slot","title")},m(t,i){N(t,e,i),v(e,s)},p:P,d(t){t&&w(e)}}}function ee(r){let e,n;return e=new ge({props:{id:"reset-event-"+r[18].id,value:r[18].id,label:r[18].id+" - "+r[18].eventType}}),{c(){y(e.$$.fragment)},l(s){E(e.$$.fragment,s)},m(s,t){R(e,s,t),n=!0},p(s,t){const i={};t&64&&(i.id="reset-event-"+s[18].id),t&64&&(i.value=s[18].id),t&64&&(i.label=s[18].id+" - "+s[18].eventType),e.$set(i)},i(s){n||(k(e.$$.fragment,s),n=!0)},o(s){T(e.$$.fragment,s),n=!1},d(s){I(e,s)}}}function Ie(r){let e,n,s=$(r[6]),t=[];for(let a=0;a<s.length;a+=1)t[a]=ee(x(r,s,a));const i=a=>T(t[a],1,1,()=>{t[a]=null});return{c(){for(let a=0;a<t.length;a+=1)t[a].c();e=Z()},l(a){for(let f=0;f<t.length;f+=1)t[f].l(a);e=Z()},m(a,f){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(a,f);N(a,e,f),n=!0},p(a,f){if(f&64){s=$(a[6]);let o;for(o=0;o<s.length;o+=1){const c=x(a,s,o);t[o]?(t[o].p(c,f),k(t[o],1)):(t[o]=ee(c),t[o].c(),k(t[o],1),t[o].m(e.parentNode,e))}for(fe(),o=s.length;o<t.length;o+=1)i(o);ce()}},i(a){if(!n){for(let f=0;f<s.length;f+=1)k(t[f]);n=!0}},o(a){t=t.filter(Boolean);for(let f=0;f<t.length;f+=1)T(t[f]);n=!1},d(a){a&&w(e),ie(t,a)}}}function De(r){let e,n,s,t,i,a,f,o;n=new he({props:{name:"reset-event-id",group:r[7],class:"max-h-40 overflow-auto",description:h("workflows.reset-event-radio-group-description"),$$slots:{default:[Ie]},$$scope:{ctx:r}}}),t=new _e({props:{id:"reset-reapply-type-checkbox",checked:r[4]===j.Signal,label:h("workflows.reset-reapply-type-label")}}),t.$on("change",r[9]);function c(l){r[13](l)}let m={id:"reset-reason",label:h("common.reason")};return r[5]!==void 0&&(m.value=r[5]),a=new ne({props:m}),D.push(()=>C(a,"value",c)),{c(){e=W("div"),y(n.$$.fragment),s=G(),y(t.$$.fragment),i=G(),y(a.$$.fragment),this.h()},l(l){e=H(l,"DIV",{class:!0});var u=A(e);E(n.$$.fragment,u),s=J(u),E(t.$$.fragment,u),i=J(u),E(a.$$.fragment,u),u.forEach(w),this.h()},h(){z(e,"class","flex w-full flex-col gap-4")},m(l,u){N(l,e,u),R(n,e,null),v(e,s),R(t,e,null),v(e,i),R(a,e,null),o=!0},p(l,u){const g={};u&2097216&&(g.$$scope={dirty:u,ctx:l}),n.$set(g);const b={};u&16&&(b.checked=l[4]===j.Signal),t.$set(b);const d={};!f&&u&32&&(f=!0,d.value=l[5],M(()=>f=!1)),a.$set(d)},i(l){o||(k(n.$$.fragment,l),k(t.$$.fragment,l),k(a.$$.fragment,l),o=!0)},o(l){T(n.$$.fragment,l),T(t.$$.fragment,l),T(a.$$.fragment,l),o=!1},d(l){l&&w(e),I(n),I(t),I(a)}}}function Me(r){let e,n,s,t;function i(o){r[14](o)}function a(o){r[15](o)}let f={id:"reset-confirmation-modal","data-testid":"reset-confirmation-modal",confirmText:h("common.confirm"),cancelText:h("common.cancel"),loading:r[3],confirmDisabled:!r[7],$$slots:{content:[De],title:[Re]},$$scope:{ctx:r}};return r[2]!==void 0&&(f.error=r[2]),r[0]!==void 0&&(f.open=r[0]),e=new U({props:f}),D.push(()=>C(e,"error",i)),D.push(()=>C(e,"open",a)),e.$on("confirmModal",r[10]),e.$on("cancelModal",r[8]),{c(){y(e.$$.fragment)},l(o){E(e.$$.fragment,o)},m(o,c){R(e,o,c),t=!0},p(o,[c]){const m={};c&8&&(m.loading=o[3]),c&2097264&&(m.$$scope={dirty:c,ctx:o}),!n&&c&4&&(n=!0,m.error=o[2],M(()=>n=!1)),!s&&c&1&&(s=!0,m.open=o[0],M(()=>s=!1)),e.$set(m)},i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){T(e.$$.fragment,o),t=!1},d(o){I(e,o)}}}function Ce(r,e,n){let s,t=P,i=()=>(t(),t=L(l,p=>n(16,s=p)),l),a,f;Y(r,we,p=>n(6,f=p)),r.$$.on_destroy.push(()=>t());let{open:o}=e,{workflow:c}=e,{namespace:m}=e,{refresh:l}=e;i();let u="",g=!1,b,d=de("");Y(r,d,p=>n(17,a=p));let S;const V=()=>{n(0,o=!1),n(4,b=j.Signal),F(d,a="",a),n(5,S="")},_=p=>{n(4,b=p.detail.checked?j.Signal:j.None)},te=async()=>{n(2,u=""),n(3,g=!0);try{const p=await ue({namespace:m,workflow:c,eventId:a,reason:S,reapplyType:b});p&&p.runId&&Ee.update(le=>({...le,[c.runId]:p.runId})),F(l,s=Date.now(),s),V()}catch(p){n(2,u=X(p)?p.message:h("common.unknown-error"))}finally{n(3,g=!1)}V()};function re(p){S=p,n(5,S)}function se(p){u=p,n(2,u)}function ae(p){o=p,n(0,o)}return r.$$set=p=>{"open"in p&&n(0,o=p.open),"workflow"in p&&n(11,c=p.workflow),"namespace"in p&&n(12,m=p.namespace),"refresh"in p&&i(n(1,l=p.refresh))},[o,l,u,g,b,S,f,d,V,_,te,c,m,re,se,ae]}class Ye extends O{constructor(e){super(),Q(this,e,Ce,Me,K,{open:0,workflow:11,namespace:12,refresh:1})}}function Se(r){let e,n=h("workflows.terminate-modal-title")+"",s;return{c(){e=W("h3"),s=q(n),this.h()},l(t){e=H(t,"H3",{slot:!0});var i=A(e);s=B(i,n),i.forEach(w),this.h()},h(){z(e,"slot","title")},m(t,i){N(t,e,i),v(e,s)},p:P,d(t){t&&w(e)}}}function We(r){let e,n,s=h("workflows.terminate-modal-confirmation")+"",t,i,a,f,o;function c(l){r[9](l)}let m={id:"workflow-termination-reason",class:"mt-4",placeholder:h("common.reason-placeholder"),label:h("common.reason-placeholder"),labelHidden:!0};return r[2]!==void 0&&(m.value=r[2]),a=new ne({props:m}),D.push(()=>C(a,"value",c)),{c(){e=W("div"),n=W("p"),t=q(s),i=G(),y(a.$$.fragment),this.h()},l(l){e=H(l,"DIV",{slot:!0});var u=A(e);n=H(u,"P",{});var g=A(n);t=B(g,s),g.forEach(w),i=J(u),E(a.$$.fragment,u),u.forEach(w),this.h()},h(){z(e,"slot","content")},m(l,u){N(l,e,u),v(e,n),v(n,t),v(e,i),R(a,e,null),o=!0},p(l,u){const g={};!f&&u&4&&(f=!0,g.value=l[2],M(()=>f=!1)),a.$set(g)},i(l){o||(k(a.$$.fragment,l),o=!0)},o(l){T(a.$$.fragment,l),o=!1},d(l){l&&w(e),I(a)}}}function He(r){let e,n,s,t;function i(o){r[10](o)}function a(o){r[11](o)}let f={id:"terminate-confirmation-modal","data-testid":"terminate-confirmation-modal",loading:r[4],confirmText:h("workflows.terminate"),cancelText:h("common.cancel"),confirmType:"destructive",$$slots:{content:[We],title:[Se]},$$scope:{ctx:r}};return r[3]!==void 0&&(f.error=r[3]),r[0]!==void 0&&(f.open=r[0]),e=new U({props:f}),D.push(()=>C(e,"error",i)),D.push(()=>C(e,"open",a)),e.$on("cancelModal",r[5]),e.$on("confirmModal",r[6]),{c(){y(e.$$.fragment)},l(o){E(e.$$.fragment,o)},m(o,c){R(e,o,c),t=!0},p(o,[c]){const m={};c&16&&(m.loading=o[4]),c&8196&&(m.$$scope={dirty:c,ctx:o}),!n&&c&8&&(n=!0,m.error=o[3],M(()=>n=!1)),!s&&c&1&&(s=!0,m.open=o[0],M(()=>s=!1)),e.$set(m)},i(o){t||(k(e.$$.fragment,o),t=!0)},o(o){T(e.$$.fragment,o),t=!1},d(o){I(e,o)}}}function Ae(r,e,n){let s,t=P,i=()=>(t(),t=L(c,_=>n(12,s=_)),c);r.$$.on_destroy.push(()=>t());let{open:a}=e,{workflow:f}=e,{namespace:o}=e,{refresh:c}=e;i();let m="",l="",u=!1;const g=()=>{n(0,a=!1),n(2,m="")},b=async()=>{n(3,l=""),n(4,u=!0);try{await pe({workflow:f,namespace:o,reason:m}),n(0,a=!1),n(2,m=""),F(c,s=Date.now(),s),oe.push({id:"workflow-termination-success-toast",message:h("workflows.terminate-success")})}catch(_){n(3,l=X(_)?_.message:h("common.unknown-error"))}finally{n(4,u=!1)}};function d(_){m=_,n(2,m)}function S(_){l=_,n(3,l)}function V(_){a=_,n(0,a)}return r.$$set=_=>{"open"in _&&n(0,a=_.open),"workflow"in _&&n(7,f=_.workflow),"namespace"in _&&n(8,o=_.namespace),"refresh"in _&&i(n(1,c=_.refresh))},[a,c,m,l,u,g,b,f,o,d,S,V]}class Ze extends O{constructor(e){super(),Q(this,e,Ae,He,K,{open:0,workflow:7,namespace:8,refresh:1})}}const $e=r=>!r.disableWriteActions&&!r.workflowCancelDisabled,xe=r=>!r.disableWriteActions&&!r.workflowResetDisabled,eo=r=>!r.disableWriteActions&&!r.workflowTerminateDisabled;export{Xe as C,Ye as R,Ze as T,eo as a,xe as b,Ee as r,$e as w};
