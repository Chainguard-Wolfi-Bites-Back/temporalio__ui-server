import{S as j,b as z,a as G,m as y,p as v,q as I,k as p,u as T,f as w,z as H,g as d,h as J,j as m,C as O,w as R,D as W,x as B,E as D,L as g,y as K,F as N,G as A,c as E,d as P,R as h,H as S,I as C,J as F}from"./index.e1c99c2b.js";import{I as Y}from"./icon.cca480df.js";import{t as b}from"./translate.4ba462db.js";import{r as Q,a as k}from"./route-for-api.f810c42e.js";const U=r=>({}),L=r=>({}),q=r=>({}),V=r=>({});function M(r){let t,s,a,l;return s=new Y({props:{name:"merge"}}),{c(){t=y("span"),O(s.$$.fragment),a=R(r[2]),this.h()},l(i){t=v(i,"SPAN",{class:!0});var n=I(t);W(s.$$.fragment,n),a=B(n,r[2]),n.forEach(p),this.h()},h(){T(t,"class","version svelte-1b9fh62")},m(i,n){w(i,t,n),D(s,t,null),g(t,a),l=!0},p(i,n){(!l||n&4)&&K(a,i[2])},i(i){l||(m(s.$$.fragment,i),l=!0)},o(i){d(s.$$.fragment,i),l=!1},d(i){i&&p(t),N(s)}}}function X(r){let t,s,a,l,i,n;s=new Y({props:{name:"merge"}});const f=r[4]["overall-default-worker"],e=A(f,r,r[3],V),c=r[4]["default-worker"],u=A(c,r,r[3],L);return{c(){t=y("span"),O(s.$$.fragment),a=R(r[2]),l=E(),e&&e.c(),i=E(),u&&u.c(),this.h()},l(o){t=v(o,"SPAN",{class:!0});var _=I(t);W(s.$$.fragment,_),a=B(_,r[2]),l=P(_),e&&e.l(_),i=P(_),u&&u.l(_),_.forEach(p),this.h()},h(){T(t,"class","svelte-1b9fh62"),h(t,"active-version",r[1]),h(t,"version",!r[1])},m(o,_){w(o,t,_),D(s,t,null),g(t,a),g(t,l),e&&e.m(t,null),g(t,i),u&&u.m(t,null),n=!0},p(o,_){(!n||_&4)&&K(a,o[2]),e&&e.p&&(!n||_&8)&&S(e,f,o,o[3],n?F(f,o[3],_,q):C(o[3]),V),u&&u.p&&(!n||_&8)&&S(u,c,o,o[3],n?F(c,o[3],_,U):C(o[3]),L),(!n||_&2)&&h(t,"active-version",o[1]),(!n||_&2)&&h(t,"version",!o[1])},i(o){n||(m(s.$$.fragment,o),m(e,o),m(u,o),n=!0)},o(o){d(s.$$.fragment,o),d(e,o),d(u,o),n=!1},d(o){o&&p(t),N(s),e&&e.d(o),u&&u.d(o)}}}function Z(r){let t,s,a,l;const i=[X,M],n=[];function f(e,c){return e[0]&&e[2]?0:e[2]?1:-1}return~(s=f(r))&&(a=n[s]=i[s](r)),{c(){t=y("p"),a&&a.c(),this.h()},l(e){t=v(e,"P",{class:!0});var c=I(t);a&&a.l(c),c.forEach(p),this.h()},h(){T(t,"class","select-all flex gap-2 noto")},m(e,c){w(e,t,c),~s&&n[s].m(t,null),l=!0},p(e,[c]){let u=s;s=f(e),s===u?~s&&n[s].p(e,c):(a&&(H(),d(n[u],1,1,()=>{n[u]=null}),J()),~s?(a=n[s],a?a.p(e,c):(a=n[s]=i[s](e),a.c()),m(a,1),a.m(t,null)):a=null)},i(e){l||(m(a),l=!0)},o(e){d(a),l=!1},d(e){e&&p(t),~s&&n[s].d()}}}function $(r,t,s){let{$$slots:a={},$$scope:l}=t,{defaultVersion:i=!1}=t,{active:n=!1}=t,{buildId:f=""}=t;return r.$$set=e=>{"defaultVersion"in e&&s(0,i=e.defaultVersion),"active"in e&&s(1,n=e.active),"buildId"in e&&s(2,f=e.buildId),"$$scope"in e&&s(3,l=e.$$scope)},[i,n,f,l,a]}class ne extends j{constructor(t){super(),z(this,t,$,Z,G,{defaultVersion:0,active:1,buildId:2})}}async function re(r,t=fetch){const s=Q("task-queue",r),a=await k(s,{request:t,params:{taskQueueType:"1"}}),l=await k(s,{request:t,params:{taskQueueType:"2"}});l.pollers.forEach(e=>{e.taskQueueTypes=["ACTIVITY"]}),a.pollers.forEach(e=>{e.taskQueueTypes=["WORKFLOW"]});const i=e=>(c,u)=>{const o=c[u.identity]||{lastAccessTime:void 0,taskQueueTypes:[]};return c[u.identity]={lastAccessTime:!o.lastAccessTime||o.lastAccessTime<u.lastAccessTime?u.lastAccessTime:o.lastAccessTime,taskQueueTypes:o.taskQueueTypes.concat([e])},c};l.pollers.filter(e=>a.pollers.some(c=>{if(e.identity===c.identity)return e.taskQueueTypes=[...c.taskQueueTypes,...e.taskQueueTypes],e})),l.pollers.reduce(i("ACTIVITY"),a.pollers.reduce(i("WORKFLOW"),{}));const n=l.pollers.length?l.pollers:a.pollers,f=l.pollers.length?l.taskQueueStatus:a.taskQueueStatus;return{pollers:n,taskQueueStatus:f}}async function le(r,t=fetch){const s=Q("task-queue.compatibility",r);return k(s,{request:t,onError:a=>console.error(a)})}async function oe(r,t=fetch){const{namespace:s,buildIds:a,taskQueue:l}=r,i=Q("worker-task-reachability",{namespace:s}),n=new URLSearchParams;if(a.length)for(const f of a)n.append("buildIds",f);else n.append("buildIds",""),n.append("taskQueues",l);return await k(i,{request:t,params:n,onError:f=>(console.error(f),{buildIdReachability:[]})})}function x(r){return!r||!r.length?b("workers","ready-to-be-retired"):r.length===1&&r.includes("CLOSED")?b("maybe"):b("no")}function ie(r,t,s){var n,f;const a=(n=r==null?void 0:r.buildIdReachability)==null?void 0:n.find(e=>e.buildId===s);if(!a)return"";const l=(f=a==null?void 0:a.taskQueueReachability)==null?void 0:f.find(e=>(e==null?void 0:e.taskQueue)===t);if(!l)return"";const i=l==null?void 0:l.reachability;return x(i)}export{ne as C,le as a,oe as b,ie as c,re as g};
