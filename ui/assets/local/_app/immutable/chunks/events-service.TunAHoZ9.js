import{t as h}from"./index.iSpbLhvj.js";import{f as w}from"./events.MMjTOHvd.js";import{r as q}from"./workflow-run.gZBKcJW9.js";import{i as A}from"./has.88qJpRyK.js";import{p as E}from"./paginated.Ne0vFLdh.js";import{r as g,a as l}from"./route-for-api.kvEBE_oM.js";const I=t=>!A(t)||t==="descending"?"events.descending":t==="ascending"?"events.ascending":"events.descending",b=async({namespace:t,workflowId:r,runId:o,sort:a,onStart:e,onUpdate:s,onComplete:i})=>{const c=I(a),f=g(c,{namespace:t,workflowId:r});return(await E(async n=>l(f,{token:n,request:fetch,params:{"execution.runId":o}}),{onStart:e,onUpdate:s,onComplete:i})).history.events},j=async({namespace:t,workflowId:r,runId:o,sort:a="ascending",signal:e,historySize:s})=>{const i=()=>{e&&w.set([])},c=(p,d)=>{var m,y;if(!e)return;w.set([...h((m=p.history)==null?void 0:m.events)]);const u=(y=d==null?void 0:d.history)==null?void 0:y.events;s&&(u==null?void 0:u.every(H=>parseInt(H.eventId)>parseInt(s)))&&q.set(Date.now())},f=I(a),v=g(f,{namespace:t,workflowId:r}),n=await E(async p=>l(v,{token:p,request:fetch,params:{"execution.runId":o,waitNewEvent:e?"true":"false"},options:{signal:e}}),{onStart:i,onUpdate:c});return n!=null&&n.history?await h(n.history.events):[]};export{b as a,j as f};
