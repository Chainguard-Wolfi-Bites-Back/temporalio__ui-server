import{s as U,T as b,U as k,e as T,t as D,b as E,d as M,f as W,g as w,j as v,k as H,l as g,v as C,a4 as V,w as z,a as Q,h as R}from"./scheduler.pu1Jb5n4.js";import{S as B,i as F,h as y,c as A,a as P,m as S,t as j,b as q,d as N}from"./index.ApG6QRGr.js";import{M as G}from"./modal.nKVjDIk9.js";import{t as h}from"./translate.5hbiS85r.js";import{c as X,t as Y}from"./workflow-service.sKiF21--.js";import{t as J}from"./toaster.sL2B1Tf1.js";import{i as K}from"./is-network-error.W7PQmK4j.js";import{I as Z}from"./input.Ftfh-Syu.js";function x(t){let e,o=h("workflows.cancel-modal-title")+"",a;return{c(){e=T("h3"),a=D(o),this.h()},l(r){e=E(r,"H3",{slot:!0});var l=M(e);a=W(l,o),l.forEach(w),this.h()},h(){v(e,"slot","title")},m(r,l){H(r,e,l),g(e,a)},p:C,d(r){r&&w(e)}}}function $(t){let e,o=h("workflows.cancel-modal-confirmation")+"",a;return{c(){e=T("p"),a=D(o)},l(r){e=E(r,"P",{});var l=M(e);a=W(l,o),l.forEach(w)},m(r,l){H(r,e,l),g(e,a)},p:C,d(r){r&&w(e)}}}function ee(t){let e,o,a,r;function l(n){t[7](n)}function i(n){t[8](n)}let m={id:"cancel-confirmation-modal","data-testid":"cancel-confirmation-modal",confirmText:h("common.confirm"),cancelText:h("common.cancel"),loading:t[2],confirmType:"destructive",$$slots:{content:[$],title:[x]},$$scope:{ctx:t}};return t[3]!==void 0&&(m.error=t[3]),t[0]!==void 0&&(m.open=t[0]),e=new G({props:m}),b.push(()=>y(e,"error",l)),b.push(()=>y(e,"open",i)),e.$on("confirmModal",t[4]),{c(){A(e.$$.fragment)},l(n){P(e.$$.fragment,n)},m(n,s){S(e,n,s),r=!0},p(n,[s]){const c={};s&4&&(c.loading=n[2]),s&1024&&(c.$$scope={dirty:s,ctx:n}),!o&&s&8&&(o=!0,c.error=n[3],k(()=>o=!1)),!a&&s&1&&(a=!0,c.open=n[0],k(()=>a=!1)),e.$set(c)},i(n){r||(j(e.$$.fragment,n),r=!0)},o(n){q(e.$$.fragment,n),r=!1},d(n){N(e,n)}}}function oe(t,e,o){let a,r=C,l=()=>(r(),r=V(s,u=>o(9,a=u)),s);t.$$.on_destroy.push(()=>r());let{open:i}=e,{workflow:m}=e,{namespace:n}=e,{refresh:s}=e;l();let c,f="";const d=async()=>{o(3,f=""),o(2,c=!0);try{await X({namespace:n,workflow:m}),o(0,i=!1),z(s,a=Date.now(),a),J.push({id:"workflow-cancelation-success-toast",message:h("workflows.cancel-success")})}catch(u){o(3,f=K(u)?u.message:h("common.unknown-error"))}finally{o(2,c=!1)}};function p(u){f=u,o(3,f)}function I(u){i=u,o(0,i)}return t.$$set=u=>{"open"in u&&o(0,i=u.open),"workflow"in u&&o(5,m=u.workflow),"namespace"in u&&o(6,n=u.namespace),"refresh"in u&&l(o(1,s=u.refresh))},[i,s,c,f,d,m,n,p,I]}class de extends B{constructor(e){super(),F(this,e,oe,ee,U,{open:0,workflow:5,namespace:6,refresh:1})}}function ne(t){let e,o=h("workflows.terminate-modal-title")+"",a;return{c(){e=T("h3"),a=D(o),this.h()},l(r){e=E(r,"H3",{slot:!0});var l=M(e);a=W(l,o),l.forEach(w),this.h()},h(){v(e,"slot","title")},m(r,l){H(r,e,l),g(e,a)},p:C,d(r){r&&w(e)}}}function te(t){let e,o,a=h("workflows.terminate-modal-confirmation")+"",r,l,i,m,n;function s(f){t[9](f)}let c={id:"workflow-termination-reason",class:"mt-4",placeholder:h("common.reason-placeholder"),label:h("common.reason-placeholder"),labelHidden:!0};return t[2]!==void 0&&(c.value=t[2]),i=new Z({props:c}),b.push(()=>y(i,"value",s)),{c(){e=T("div"),o=T("p"),r=D(a),l=Q(),A(i.$$.fragment),this.h()},l(f){e=E(f,"DIV",{slot:!0});var d=M(e);o=E(d,"P",{});var p=M(o);r=W(p,a),p.forEach(w),l=R(d),P(i.$$.fragment,d),d.forEach(w),this.h()},h(){v(e,"slot","content")},m(f,d){H(f,e,d),g(e,o),g(o,r),g(e,l),S(i,e,null),n=!0},p(f,d){const p={};!m&&d&4&&(m=!0,p.value=f[2],k(()=>m=!1)),i.$set(p)},i(f){n||(j(i.$$.fragment,f),n=!0)},o(f){q(i.$$.fragment,f),n=!1},d(f){f&&w(e),N(i)}}}function re(t){let e,o,a,r;function l(n){t[10](n)}function i(n){t[11](n)}let m={id:"terminate-confirmation-modal","data-testid":"terminate-confirmation-modal",loading:t[4],confirmText:h("workflows.terminate"),cancelText:h("common.cancel"),confirmType:"destructive",$$slots:{content:[te],title:[ne]},$$scope:{ctx:t}};return t[3]!==void 0&&(m.error=t[3]),t[0]!==void 0&&(m.open=t[0]),e=new G({props:m}),b.push(()=>y(e,"error",l)),b.push(()=>y(e,"open",i)),e.$on("cancelModal",t[5]),e.$on("confirmModal",t[6]),{c(){A(e.$$.fragment)},l(n){P(e.$$.fragment,n)},m(n,s){S(e,n,s),r=!0},p(n,[s]){const c={};s&16&&(c.loading=n[4]),s&8196&&(c.$$scope={dirty:s,ctx:n}),!o&&s&8&&(o=!0,c.error=n[3],k(()=>o=!1)),!a&&s&1&&(a=!0,c.open=n[0],k(()=>a=!1)),e.$set(c)},i(n){r||(j(e.$$.fragment,n),r=!0)},o(n){q(e.$$.fragment,n),r=!1},d(n){N(e,n)}}}function ae(t,e,o){let a,r=C,l=()=>(r(),r=V(s,_=>o(12,a=_)),s);t.$$.on_destroy.push(()=>r());let{open:i}=e,{workflow:m}=e,{namespace:n}=e,{refresh:s}=e;l();let c="",f="",d=!1;const p=()=>{o(0,i=!1),o(2,c="")},I=async()=>{o(3,f=""),o(4,d=!0);try{await Y({workflow:m,namespace:n,reason:c}),o(0,i=!1),o(2,c=""),z(s,a=Date.now(),a),J.push({id:"workflow-termination-success-toast",message:h("workflows.terminate-success")})}catch(_){o(3,f=K(_)?_.message:h("common.unknown-error"))}finally{o(4,d=!1)}};function u(_){c=_,o(2,c)}function L(_){f=_,o(3,f)}function O(_){i=_,o(0,i)}return t.$$set=_=>{"open"in _&&o(0,i=_.open),"workflow"in _&&o(7,m=_.workflow),"namespace"in _&&o(8,n=_.namespace),"refresh"in _&&l(o(1,s=_.refresh))},[i,s,c,f,d,p,I,m,n,u,L,O]}class he extends B{constructor(e){super(),F(this,e,ae,re,U,{open:0,workflow:7,namespace:8,refresh:1})}}const pe=t=>!t.disableWriteActions&&!t.workflowCancelDisabled,we=t=>!t.disableWriteActions&&!t.workflowTerminateDisabled;export{de as C,he as T,we as a,pe as w};
