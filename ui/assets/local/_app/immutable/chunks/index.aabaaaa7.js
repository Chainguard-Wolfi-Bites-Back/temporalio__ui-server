import{h as L}from"./has.f5323580.js";import{i as T,a as p,b as $,c as q,d as R,e as U,f as N,g as j,h as B,j as M,k as w,l as A,m as D,n as z,o as K,p as x,q as _,r as H,s as J,t as P,u as Q,v as V,w as X,x as h,y as S,z as b,A as C,B as I,C as v,D as W,E as f}from"./is-event-type.4dbe973b.js";import{j as Y}from"./format-time.8258873a.js";const y=t=>T(t)||p(t)||$(t)||q(t)||R(t)||U(t)||N(t)||j(t)||B(t)||M(t),at=t=>m(t)?t.isFailureOrTimedOut:y(t),O=t=>w(t)||A(t)||D(t)||z(t),ot=t=>m(t)?t.isCanceled:O(t),F=t=>K(t)||x(t),dt=t=>m(t)?t.isTerminated:F(t),G=t=>_(t)?String(t.activityTaskStartedEventAttributes.scheduledEventId):w(t)?String(t.activityTaskCanceledEventAttributes.scheduledEventId):H(t)?String(t.activityTaskCancelRequestedEventAttributes.scheduledEventId):p(t)?String(t.activityTaskFailedEventAttributes.scheduledEventId):T(t)?String(t.activityTaskTimedOutEventAttributes.scheduledEventId):J(t)?String(t.activityTaskCompletedEventAttributes.scheduledEventId):P(t)?String(t.childWorkflowExecutionStartedEventAttributes.initiatedEventId):x(t)?String(t.childWorkflowExecutionTerminatedEventAttributes.initiatedEventId):Q(t)?String(t.childWorkflowExecutionCompletedEventAttributes.initiatedEventId):V(t)?String(t.timerFiredEventAttributes.startedEventId):A(t)?String(t.timerCanceledEventAttributes.startedEventId):X(t)?String(t.workflowExecutionUpdateCompletedEventAttributes.acceptedEventId):t.id,Z=t=>{var i,r,e,s,a,l,o,u,c,n,E,k;if(t){if(h(t))return(r=(i=t.activityTaskScheduledEventAttributes)==null?void 0:i.activityType)==null?void 0:r.name;if(S(t))return`Timer ${(e=t.timerStartedEventAttributes)==null?void 0:e.timerId} (${Y((s=t.timerStartedEventAttributes)==null?void 0:s.startToFireTimeout)})`;if(b(t))return`Signal: ${(a=t.signalExternalWorkflowExecutionInitiatedEventAttributes)==null?void 0:a.signalName}`;if(C(t))return`Signal received: ${(l=t.workflowExecutionSignaledEventAttributes)==null?void 0:l.signalName}`;if(I(t))return v(t)?"Local Activity":`Marker: ${(o=t.markerRecordedEventAttributes)==null?void 0:o.markerName}`;if(W(t))return`Child Workflow: ${(c=(u=t.startChildWorkflowExecutionInitiatedEventAttributes)==null?void 0:u.workflowType)==null?void 0:c.name}`;if(f(t))return`${(k=(E=(n=t.workflowExecutionUpdateAcceptedEventAttributes)==null?void 0:n.acceptedRequest)==null?void 0:E.input)==null?void 0:k.name}`}},g=({events:t})=>{let i=0,r;for(const e of t.values()){const s=Number(e.id);s>=i&&(i=s,r=e)}return r},tt=(t,i)=>i!=null&&i.length&&f(t)?i.find(r=>{var e;return r.id===((e=t.workflowExecutionUpdateAcceptedEventAttributes)==null?void 0:e.acceptedRequestSequencingEventId.toString())}):t,d=(t,i)=>{const r=G(t),e=Z(t),{timestamp:s,category:a,classification:l}=t,o=tt(t,i),u=new Map,c=new Set;return o&&f(t)?(u.set(o.id,o),u.set(t.id,t),c.add(o.id),c.add(t.id)):(u.set(t.id,t),c.add(t.id)),{id:r,name:e,events:u,eventIds:c,initialEvent:o,timestamp:s,category:a,classification:l,get eventTime(){var n;return(n=this.lastEvent)==null?void 0:n.eventTime},get attributes(){var n;return(n=g(this))==null?void 0:n.attributes},get eventList(){return Array.from(this.events,([n,E])=>E)},get lastEvent(){return g(this)},get isFailureOrTimedOut(){return Boolean(this.eventList.find(y))},get isCanceled(){return Boolean(this.eventList.find(O))},get isTerminated(){return Boolean(this.eventList.find(F))}}},it=(t,i)=>{if(h(t)||W(t)||S(t)||b(t)||C(t))return d(t);if(I(t))return v(t),d(t);if(f(t))return d(t,i)},rt=(t,i)=>{t&&(t.events.set(i.id,i),t.eventIds.add(i.id),t.timestamp=i.timestamp)},ut=(t,i="ascending")=>{const r={};for(const e of t){const s=G(e),a=it(e,t);a?r[a.id]=a:rt(r[s],e)}return i==="descending"?Object.values(r).reverse():Object.values(r)},m=t=>t==null?!1:L(t,"events");export{ot as a,dt as b,at as e,ut as g,m as i};
