import{r as m}from"./index.b1f5b21f.js";import{c as u}from"./cluster.728f7d8f.js";import{r as f,a as p}from"./route-for-api.30e023d8.js";import{f as d}from"./namespaces-service.be3c6bff.js";import{f as h}from"./settings-service.87ef63ab.js";import{s as k,g}from"./auth-user.58d364c3.js";import{B as a,e as A}from"./route-for.d19e1f1a.js";import{a as T}from"./atob.8d2e5aa0.js";import{p as _}from"./parse-with-big-int.0036a80a.js";/* empty css            */const w=async(s,e=fetch)=>{if(s.runtimeEnvironment.isCloud)return;const o=f("cluster");return await p(o,{request:e}).then(n=>(u.set(n),n))},c="user",y=(s=a)=>{if(!s)return{};const e=document.cookie.split(";");let o=0,n=e.find(r=>r.includes(c+o)),i="";for(;n;){const[r,t]=n.split("=");i+=t,o++,n=e.find(l=>l.includes(c+o))}if(i)try{const r=T(i),t=_(r);return{accessToken:t==null?void 0:t.AccessToken,idToken:t==null?void 0:t.IDToken,name:t==null?void 0:t.Name,picture:t==null?void 0:t.Picture,email:t==null?void 0:t.Email}}catch(r){console.error(r)}return{}},b=(s=a)=>{if(!s)return;const e=document.cookie.split(";");let o=0,n=e.find(i=>i.includes(c+o));for(;n;){const[i]=n.split("=");document.cookie=`${i}=; max-age=-1; path=/`,o++,n=e.find(r=>r.includes(c+o))}},B=(s,e)=>!s.auth.enabled||Boolean(e==null?void 0:e.accessToken),S=async function({fetch:s}){const e=await h(s),o=y();o!=null&&o.accessToken&&(k(o),b());const n=g();if(!B(e,n))throw m(302,A());d(e,s);const i=await w(e,s);return{user:n,settings:e,cluster:i}},z=Object.freeze(Object.defineProperty({__proto__:null,load:S},Symbol.toStringTag,{value:"Module"}));export{z as _,S as l};
