import{S as z,b as G,a as H,m as b,p as y,q as I,k as g,u as V,f as S,z as J,g as _,h as U,j as m,C as D,w as L,D as O,x as R,E as j,L as h,y as B,F as N,G as Q,c as C,d as A,R as p,H as w,I as F,J as P}from"./index.c37b9eda.js";import{I as K}from"./icon.c0bc9732.js";import{t as v}from"./translate.ba10d640.js";import{r as T,a as k}from"./route-for-api.98668935.js";const q=e=>(e!=null&&e.majorVersionSets?[...e.majorVersionSets]:[]).reverse(),Y=e=>{if(!(!e||!e.length))return e[e.length-1]},oe=(e,t)=>{var r;const s=(r=e==null?void 0:e.majorVersionSets)==null?void 0:r.find(o=>{var l;return(l=o.buildIds)==null?void 0:l.includes(t)});return Y(s==null?void 0:s.buildIds)},ie=e=>e?e.slice(0,e.length-1).reverse():[],le=e=>{var r;const t=q(e);if(!t.length)return;const s=(r=t[0])==null?void 0:r.buildIds;if(s!=null&&s.length)return Y(t[0].buildIds)},ue=e=>{var t,s;if((t=e==null?void 0:e.mostRecentWorkerVersionStamp)!=null&&t.useVersioning)return((s=e.mostRecentWorkerVersionStamp)==null?void 0:s.buildId)||void 0},ce=e=>{var t,s;if((t=e==null?void 0:e.workerVersionCapabilities)!=null&&t.useVersioning)return((s=e.workerVersionCapabilities)==null?void 0:s.buildId)||void 0};const M=e=>({}),E=e=>({}),X=e=>({}),W=e=>({});function Z(e){let t,s,r,o;return s=new K({props:{name:"merge"}}),{c(){t=b("span"),D(s.$$.fragment),r=L(e[2]),this.h()},l(l){t=y(l,"SPAN",{class:!0});var a=I(t);O(s.$$.fragment,a),r=R(a,e[2]),a.forEach(g),this.h()},h(){V(t,"class","version svelte-1b9fh62")},m(l,a){S(l,t,a),j(s,t,null),h(t,r),o=!0},p(l,a){(!o||a&4)&&B(r,l[2])},i(l){o||(m(s.$$.fragment,l),o=!0)},o(l){_(s.$$.fragment,l),o=!1},d(l){l&&g(t),N(s)}}}function $(e){let t,s,r,o,l,a;s=new K({props:{name:"merge"}});const f=e[4]["overall-default-worker"],n=Q(f,e,e[3],W),c=e[4]["default-worker"],u=Q(c,e,e[3],E);return{c(){t=b("span"),D(s.$$.fragment),r=L(e[2]),o=C(),n&&n.c(),l=C(),u&&u.c(),this.h()},l(i){t=y(i,"SPAN",{class:!0});var d=I(t);O(s.$$.fragment,d),r=R(d,e[2]),o=A(d),n&&n.l(d),l=A(d),u&&u.l(d),d.forEach(g),this.h()},h(){V(t,"class","svelte-1b9fh62"),p(t,"active-version",e[1]),p(t,"version",!e[1])},m(i,d){S(i,t,d),j(s,t,null),h(t,r),h(t,o),n&&n.m(t,null),h(t,l),u&&u.m(t,null),a=!0},p(i,d){(!a||d&4)&&B(r,i[2]),n&&n.p&&(!a||d&8)&&w(n,f,i,i[3],a?P(f,i[3],d,X):F(i[3]),W),u&&u.p&&(!a||d&8)&&w(u,c,i,i[3],a?P(c,i[3],d,M):F(i[3]),E),(!a||d&2)&&p(t,"active-version",i[1]),(!a||d&2)&&p(t,"version",!i[1])},i(i){a||(m(s.$$.fragment,i),m(n,i),m(u,i),a=!0)},o(i){_(s.$$.fragment,i),_(n,i),_(u,i),a=!1},d(i){i&&g(t),N(s),n&&n.d(i),u&&u.d(i)}}}function x(e){let t,s,r,o;const l=[$,Z],a=[];function f(n,c){return n[0]&&n[2]?0:n[2]?1:-1}return~(s=f(e))&&(r=a[s]=l[s](e)),{c(){t=b("p"),r&&r.c(),this.h()},l(n){t=y(n,"P",{class:!0});var c=I(t);r&&r.l(c),c.forEach(g),this.h()},h(){V(t,"class","select-all flex gap-2 noto")},m(n,c){S(n,t,c),~s&&a[s].m(t,null),o=!0},p(n,[c]){let u=s;s=f(n),s===u?~s&&a[s].p(n,c):(r&&(J(),_(a[u],1,1,()=>{a[u]=null}),U()),~s?(r=a[s],r?r.p(n,c):(r=a[s]=l[s](n),r.c()),m(r,1),r.m(t,null)):r=null)},i(n){o||(m(r),o=!0)},o(n){_(r),o=!1},d(n){n&&g(t),~s&&a[s].d()}}}function ee(e,t,s){let{$$slots:r={},$$scope:o}=t,{defaultVersion:l=!1}=t,{active:a=!1}=t,{buildId:f=""}=t;return e.$$set=n=>{"defaultVersion"in n&&s(0,l=n.defaultVersion),"active"in n&&s(1,a=n.active),"buildId"in n&&s(2,f=n.buildId),"$$scope"in n&&s(3,o=n.$$scope)},[l,a,f,o,r]}class fe extends z{constructor(t){super(),G(this,t,ee,x,H,{defaultVersion:0,active:1,buildId:2})}}async function de(e,t=fetch){const s=T("task-queue",e),r=await k(s,{request:t,params:{taskQueueType:"1"}}),o=await k(s,{request:t,params:{taskQueueType:"2"}});o.pollers.forEach(n=>{n.taskQueueTypes=["ACTIVITY"]}),r.pollers.forEach(n=>{n.taskQueueTypes=["WORKFLOW"]});const l=n=>(c,u)=>{const i=c[u.identity]||{lastAccessTime:void 0,taskQueueTypes:[]};return c[u.identity]={lastAccessTime:!i.lastAccessTime||i.lastAccessTime<u.lastAccessTime?u.lastAccessTime:i.lastAccessTime,taskQueueTypes:i.taskQueueTypes.concat([n])},c};o.pollers.filter(n=>r.pollers.some(c=>{if(n.identity===c.identity)return n.taskQueueTypes=[...c.taskQueueTypes,...n.taskQueueTypes],n})),o.pollers.reduce(l("ACTIVITY"),r.pollers.reduce(l("WORKFLOW"),{}));const a=o.pollers.length?o.pollers:r.pollers,f=o.pollers.length?o.taskQueueStatus:r.taskQueueStatus;return{pollers:a,taskQueueStatus:f}}async function _e(e,t=fetch){const s=T("task-queue.compatibility",e);return k(s,{request:t,onError:r=>console.error(r)})}async function me(e,t=fetch){const{namespace:s,buildIds:r,taskQueue:o}=e,l=T("worker-task-reachability",{namespace:s}),a=new URLSearchParams;if(r.length)for(const f of r)a.append("buildIds",f);else a.append("buildIds",""),a.append("taskQueues",o);return await k(l,{request:t,params:a,onError:f=>(console.error(f),{buildIdReachability:[]})})}function te(e){return!e||!e.length?v("workers","ready-to-be-retired"):e.length===1&&e.includes("CLOSED")?v("maybe"):v("no")}function ge(e,t,s){var a,f;const r=(a=e==null?void 0:e.buildIdReachability)==null?void 0:a.find(n=>n.buildId===s);if(!r)return"";const o=(f=r==null?void 0:r.taskQueueReachability)==null?void 0:f.find(n=>(n==null?void 0:n.taskQueue)===t);if(!o)return"";const l=o==null?void 0:o.reachability;return te(l)}export{fe as C,le as a,oe as b,de as c,_e as d,q as e,ce as f,ue as g,me as h,ge as i,Y as j,ie as k};
