import{D as o}from"./scheduler.IHo1m08M.js";import{p as m}from"./stores.mqqo91HX.js";import{t as C}from"./translate.HrioCK44.js";import{a as k}from"./auth-user.mHHm8i-j.js";import{c as l,o as f,p as y,i as x,v,s as p,a as O}from"./data-encoder-config.l1OGLu3P.js";import{h as A}from"./has.Hk4nWl3x.js";import{s as h}from"./parse-with-big-int.e3oI4SEy.js";const E=(e,t=l,a=f)=>{var n;return o(a)&&o(t)||((n=e==null?void 0:e.codec)==null?void 0:n.endpoint)||o(t)||""},b=(e,t=y,a=l,i=f)=>{var r,d;const n=o(i)&&o(a),u=(r=e==null?void 0:e.codec)!=null&&r.endpoint?!!((d=e==null?void 0:e.codec)!=null&&d.passAccessToken):!!o(t);return n?!!o(t):u},P=(e,t=x,a=l,i=f)=>{var r,d;const n=o(i)&&o(a),u=(r=e==null?void 0:e.codec)!=null&&r.endpoint?!!((d=e==null?void 0:e.codec)!=null&&d.includeCredentials):!!o(t);return n?!!o(t):u};async function q({payloads:e,namespace:t=o(m).params.namespace,settings:a=o(m).data.settings}){const i=E(a),n=b(a),u=P(a),r={"Content-Type":"application/json","X-Namespace":t};if(n)if(v(i)){let c=o(k).accessToken;globalThis!=null&&globalThis.AccessToken&&(c=await(globalThis==null?void 0:globalThis.AccessToken())),r.Authorization=`Bearer ${c}`}else return p(),e;const d=u?{headers:r,credentials:"include",method:"POST",body:h(e)}:{headers:r,method:"POST",body:h(e)};return fetch(i+"/decode",d).then(c=>{if(A(c,"ok")&&!c.ok)throw{statusCode:c.status,statusText:c.statusText,response:c,message:C("common.decode-failed")};return c.json()}).then(c=>(O(),c)).catch(c=>(p(c),e))}async function z({payloads:e,namespace:t=o(m).params.namespace,settings:a=o(m).data.settings,accessToken:i=o(k).accessToken}){const n=E(a),u=b(a),r=P(a),d={"Content-Type":"application/json","X-Namespace":t};if(u)if(v(n))d.Authorization=`Bearer ${i}`;else return p(),e;const T=r?{headers:d,credentials:"include",method:"POST",body:h(e)}:{headers:d,method:"POST",body:h(e)};return fetch(n+"/encode",T).then(s=>{if(A(s,"ok")&&!s.ok)throw{statusCode:s.status,statusText:s.statusText,response:s,message:C("common.encode-failed")};return s.json()}).then(s=>(O(),s)).catch(s=>{throw p(s),s})}export{b as a,P as b,q as d,z as e,E as g};
