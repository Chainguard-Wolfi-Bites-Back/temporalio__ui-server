import{r as Ne,m as He,n as Ve}from"./format-time.9mIRALNp.js";import{s as ee,e as I,b as C,d as E,g,j as y,k as B,c as fe,a2 as We,w as de,x as J,v as W,a as O,h as F,l as b,y as je,o as Be,t as Y,f as P,F as Z,m as $,ad as Oe,n as K,Z as Ue,H as qe,p as Ye,u as Pe,q as Qe,r as Ge}from"./scheduler.fjKs9yxd.js";import{S as te,i as ne,c as Q,a as G,m as R,t as S,b as T,d as z,g as ue,e as ce}from"./index.ZY3lhhrE.js";import{e as X,u as Fe,o as Re,d as ze}from"./each.alF3Xjfy.js";import{p as Ze}from"./stores.Wn7H-Cuc.js";import{S as Je}from"./index.O-8BINr9.js";import{r as Ke,w as oe,f as ke}from"./workflows.CK2kb31s.js";import{h as Xe}from"./decode-payload.T9d-DkvE.js";import{W as xe}from"./workflow-status.X-K_EKoT.js";import{d as $e}from"./menu.PPl8qnXQ.js";import{w as pe,g as et,a as ve}from"./time-picker.vlwkk72h.js";import{I as ye}from"./icon.xQlvD1Wx.js";import{I as tt}from"./input.Zkr4N_ri.js";import{t as nt}from"./translate.Itygs_Qz.js";function lt(l,e){Ne(2,arguments);var t=He(l).getTime(),n=Ve(e);return new Date(t+n)}var st=36e5;function Ot(l,e){Ne(2,arguments);var t=Ve(e);return lt(l,t*st)}const re=["Running","TimedOut","Completed","Failed","ContinuedAsNew","Canceled","Terminated"];function Ft(l){return re.includes(l)}const Ht=["All",...re],De=(l,e,t)=>{const o=Math.pow(3600/l,1/t),a=l*Math.pow(o,e);return Math.min(3600,Math.round(a))};function at(l){let e,t;return e=new xe({props:{count:l[1],newCount:l[2],status:l[0],"test-id":"workflow-status-"+l[0]}}),{c(){Q(e.$$.fragment)},l(n){G(e.$$.fragment,n)},m(n,o){R(e,n,o),t=!0},p(n,[o]){const a={};o&2&&(a.count=n[1]),o&4&&(a.newCount=n[2]),o&1&&(a.status=n[0]),o&1&&(a["test-id"]="workflow-status-"+n[0]),e.$set(a)},i(n){t||(S(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function ot(l,e,t){let{status:n}=e,{count:o=0}=e,{newCount:a=0}=e;return l.$$set=c=>{"status"in c&&t(0,n=c.status),"count"in c&&t(1,o=c.count),"newCount"in c&&t(2,a=c.newCount)},[n,o,a]}class rt extends te{constructor(e){super(),ne(this,e,ot,at,ee,{status:0,count:1,newCount:2})}}function Ie(l,e,t){const n=l.slice();return n[18]=e[t].count,n[19]=e[t].status,n}function ut(l){let e,t;return e=new Je({props:{class:"h-6 w-24 rounded"}}),{c(){Q(e.$$.fragment)},l(n){G(e.$$.fragment,n)},m(n,o){R(e,n,o),t=!0},p:W,i(n){t||(S(e.$$.fragment,n),t=!0)},o(n){T(e.$$.fragment,n),t=!1},d(n){z(e,n)}}}function ct(l){let e,t;function n(...a){return l[8](l[19],...a)}function o(...a){return l[9](l[19],...a)}return e=new rt({props:{status:l[19],count:l[18],newCount:l[1].find(n)?l[1].find(o).count-l[18]:0}}),{c(){Q(e.$$.fragment)},l(a){G(e.$$.fragment,a)},m(a,c){R(e,a,c),t=!0},p(a,c){l=a;const u={};c&1&&(u.status=l[19]),c&1&&(u.count=l[18]),c&3&&(u.newCount=l[1].find(n)?l[1].find(o).count-l[18]:0),e.$set(u)},i(a){t||(S(e.$$.fragment,a),t=!0)},o(a){T(e.$$.fragment,a),t=!1},d(a){z(e,a)}}}function Ce(l,e){let t,n,o,a,c;const u=[ct,ut],s=[];function r(i,d){return i[2]?1:0}return n=r(e),o=s[n]=u[n](e),{key:l,first:null,c(){t=J(),o.c(),a=J(),this.h()},l(i){t=J(),o.l(i),a=J(),this.h()},h(){this.first=t},m(i,d){B(i,t,d),s[n].m(i,d),B(i,a,d),c=!0},p(i,d){e=i;let f=n;n=r(e),n===f?s[n].p(e,d):(ue(),T(s[f],1,1,()=>{s[f]=null}),ce(),o=s[n],o?o.p(e,d):(o=s[n]=u[n](e),o.c()),S(o,1),o.m(a.parentNode,a))},i(i){c||(S(o),c=!0)},o(i){T(o),c=!1},d(i){i&&(g(t),g(a)),s[n].d(i)}}}function it(l){let e,t=[],n=new Map,o,a=X(l[0]);const c=u=>u[19];for(let u=0;u<a.length;u+=1){let s=Ie(l,a,u),r=c(s);n.set(r,t[u]=Ce(r,s))}return{c(){e=I("div");for(let u=0;u<t.length;u+=1)t[u].c();this.h()},l(u){e=C(u,"DIV",{class:!0});var s=E(e);for(let r=0;r<t.length;r+=1)t[r].l(s);s.forEach(g),this.h()},h(){y(e,"class","flex min-h-[24px] flex-wrap items-center gap-2")},m(u,s){B(u,e,s);for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(e,null);o=!0},p(u,[s]){s&7&&(a=X(u[0]),ue(),t=Fe(t,s,c,1,u,a,n,e,Re,Ce,null,Ie),ce())},i(u){if(!o){for(let s=0;s<a.length;s+=1)S(t[s]);o=!0}},o(u){for(let s=0;s<t.length;s+=1)T(t[s]);o=!1},d(u){u&&g(e);for(let s=0;s<t.length;s+=1)t[s].d()}}}const Ee=5,he=100;function ft(l,e,t){let n,o,a,c,u;fe(l,Ke,m=>t(6,a=m)),fe(l,oe,m=>t(12,c=m)),fe(l,Ze,m=>t(7,u=m));let{staticQuery:s=""}=e,r=[],i=[],d,f=1,h=!1;We(()=>{v()});const w=()=>{if(f+=1,clearInterval(d),f<=he){const m=De(Ee,f,he)*1e3;d=setInterval(()=>L(),m)}},v=()=>{clearInterval(d),t(1,i=[]),de(oe,c.newCount=0,c),f=1,t(2,h=!0)},H=(m=[])=>m.map(k=>{const _=Xe(k==null?void 0:k.groupValues[0]),U=parseInt(k.count);return{status:_,count:U}}).sort((k,_)=>re.indexOf(k.status)-re.indexOf(_.status)),L=async()=>{w();try{const{count:m,groups:k}=await ke({namespace:n,query:o});de(oe,c.newCount=parseInt(m)-c.count,c),t(1,i=H(k))}catch(m){console.error("Fetching workflow counts failed: ",m==null?void 0:m.message)}finally{t(2,h=!1)}},j=async()=>{v();const m=De(Ee,f,he)*1e3;d=setInterval(()=>L(),m);try{const{count:k,groups:_}=await ke({namespace:n,query:o});de(oe,c.count=parseInt(k),c),t(0,r=H(_))}catch(k){console.error("Fetching workflow counts failed: ",k==null?void 0:k.message)}finally{t(2,h=!1)}},N=(m,k)=>k.status===m,V=(m,k)=>k.status===m;return l.$$set=m=>{"staticQuery"in m&&t(3,s=m.staticQuery)},l.$$.update=()=>{l.$$.dirty&128&&t(4,n=u.params.namespace),l.$$.dirty&136&&t(5,o=s||u.url.searchParams.get("query")),l.$$.dirty&112&&j()},[r,i,h,s,n,o,a,u,N,V]}class Wt extends te{constructor(e){super(),ne(this,e,ft,it,ee,{staticQuery:3})}}function Se(l,e,t){const n=l.slice();return n[9]=e[t].allowed,n[10]=e[t].value,n[12]=t,n}function Te(l,e,t){const n=l.slice();return n[13]=e[t],n}function Le(l){let e,t=l[13].label.slice(0,2)+"",n;return{c(){e=I("p"),n=Y(t),this.h()},l(o){e=C(o,"P",{class:!0});var a=E(e);n=P(a,t),a.forEach(g),this.h()},h(){y(e,"class","cell svelte-blbleb")},m(o,a){B(o,e,a),b(e,n)},p:W,d(o){o&&g(e)}}}function Ae(l,e){let t,n=(e[10]||"")+"",o,a,c,u;function s(){return e[6](e[10])}return{key:l,first:null,c(){t=I("button"),o=Y(n),a=O(),this.h()},l(r){t=C(r,"BUTTON",{type:!0,class:!0});var i=E(t);o=P(i,n),a=F(i),i.forEach(g),this.h()},h(){y(t,"type","button"),y(t,"class","cell svelte-blbleb"),Z(t,"highlight",e[9]&&e[10]),Z(t,"disabled",!e[9]),Z(t,"selected",new Date(e[0].getFullYear(),e[0].getMonth(),e[0].getDate()).getTime()===new Date(e[2],e[1],e[10]).getTime()),this.first=t},m(r,i){B(r,t,i),b(t,o),b(t,a),c||(u=$(t,"click",function(){Oe(e[9]&&e[10]?s:W)&&(e[9]&&e[10]?s:W).apply(this,arguments)}),c=!0)},p(r,i){e=r,i&8&&n!==(n=(e[10]||"")+"")&&K(o,n),i&8&&Z(t,"highlight",e[9]&&e[10]),i&8&&Z(t,"disabled",!e[9]),i&15&&Z(t,"selected",new Date(e[0].getFullYear(),e[0].getMonth(),e[0].getDate()).getTime()===new Date(e[2],e[1],e[10]).getTime())},d(r){r&&g(t),c=!1,u()}}}function dt(l){let e,t,n,o,a=[],c=new Map,u=X(pe),s=[];for(let d=0;d<u.length;d+=1)s[d]=Le(Te(l,u,d));let r=X(l[3]);const i=d=>d[12];for(let d=0;d<r.length;d+=1){let f=Se(l,r,d),h=i(f);c.set(h,a[d]=Ae(h,f))}return{c(){e=I("div"),t=I("div");for(let d=0;d<s.length;d+=1)s[d].c();n=O(),o=I("div");for(let d=0;d<a.length;d+=1)a[d].c();this.h()},l(d){e=C(d,"DIV",{class:!0});var f=E(e);t=C(f,"DIV",{class:!0});var h=E(t);for(let v=0;v<s.length;v+=1)s[v].l(h);h.forEach(g),n=F(f),o=C(f,"DIV",{class:!0});var w=E(o);for(let v=0;v<a.length;v+=1)a[v].l(w);w.forEach(g),f.forEach(g),this.h()},h(){y(t,"class","row svelte-blbleb"),y(o,"class","row svelte-blbleb"),y(e,"class","container svelte-blbleb")},m(d,f){B(d,e,f),b(e,t);for(let h=0;h<s.length;h+=1)s[h]&&s[h].m(t,null);b(e,n),b(e,o);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(o,null)},p(d,[f]){if(f&0){u=X(pe);let h;for(h=0;h<u.length;h+=1){const w=Te(d,u,h);s[h]?s[h].p(w,f):(s[h]=Le(w),s[h].c(),s[h].m(t,null))}for(;h<s.length;h+=1)s[h].d(1);s.length=u.length}f&31&&(r=X(d[3]),a=Fe(a,f,i,1,d,r,c,o,ze,Ae,null,Se))},i:W,o:W,d(d){d&&g(e),je(s,d);for(let f=0;f<a.length;f+=1)a[f].d()}}}function ht(l,e,t){const n=Be();let{date:o}=e,{month:a}=e,{year:c}=e,{isAllowed:u=f=>!0}=e,s=[];const r=f=>{n("datechange",new Date(c,a,f))},i=(f,h,w)=>w?u(new Date(f,h,w)):!0,d=f=>r(f);return l.$$set=f=>{"date"in f&&t(0,o=f.date),"month"in f&&t(1,a=f.month),"year"in f&&t(2,c=f.year),"isAllowed"in f&&t(5,u=f.isAllowed)},l.$$.update=()=>{l.$$.dirty&6&&t(3,s=et(a,c).map(f=>({value:f,allowed:i(c,a,f)})))},[o,a,c,s,r,u,d]}class _t extends te{constructor(e){super(),ne(this,e,ht,dt,ee,{date:0,month:1,year:2,isAllowed:5})}}function Me(l){var le;let e,t,n,o,a,c,u,s=(((le=ve(l[8]))==null?void 0:le.label)??"")+"",r,i,d,f,h,w,v,H,L,j,N,V,m,k,_,U,M,q,ie;return a=new ye({props:{name:"chevron-left"}}),v=new ye({props:{name:"chevron-right"}}),L=new _t({props:{month:l[8],year:l[9],date:l[0],isAllowed:l[1]}}),L.$on("datechange",l[15]),{c(){e=I("div"),t=I("div"),n=I("div"),o=I("button"),Q(a.$$.fragment),c=O(),u=I("div"),r=Y(s),i=O(),d=Y(l[9]),f=O(),h=I("div"),w=I("button"),Q(v.$$.fragment),H=O(),Q(L.$$.fragment),j=O(),N=I("div"),V=I("button"),m=Y(l[4]),k=O(),_=I("button"),U=Y(l[5]),this.h()},l(p){e=C(p,"DIV",{class:!0});var D=E(e);t=C(D,"DIV",{class:!0});var A=E(t);n=C(A,"DIV",{class:!0});var x=E(n);o=C(x,"BUTTON",{type:!0});var _e=E(o);G(a.$$.fragment,_e),_e.forEach(g),x.forEach(g),c=F(A),u=C(A,"DIV",{class:!0});var se=E(u);r=P(se,s),i=F(se),d=P(se,l[9]),se.forEach(g),f=F(A),h=C(A,"DIV",{class:!0});var me=E(h);w=C(me,"BUTTON",{type:!0});var ge=E(w);G(v.$$.fragment,ge),ge.forEach(g),me.forEach(g),A.forEach(g),H=F(D),G(L.$$.fragment,D),j=F(D),N=C(D,"DIV",{class:!0});var ae=E(N);V=C(ae,"BUTTON",{type:!0,class:!0});var be=E(V);m=P(be,l[4]),be.forEach(g),k=F(ae),_=C(ae,"BUTTON",{type:!0,class:!0});var we=E(_);U=P(we,l[5]),we.forEach(g),ae.forEach(g),D.forEach(g),this.h()},h(){y(o,"type","button"),y(n,"class","flex items-center justify-center"),y(u,"class","flex items-center justify-center"),y(w,"type","button"),y(h,"class","flex items-center justify-center"),y(t,"class","mx-3 my-2 flex items-center justify-around"),y(V,"type","button"),y(V,"class","cursor-pointer text-[12px]"),y(_,"type","button"),y(_,"class","cursor-pointer text-[12px]"),y(N,"class","my-1 flex justify-between px-2"),y(e,"class","surface-primary absolute z-30 inline-block rounded border border-subtle shadow dark:bg-secondary")},m(p,D){B(p,e,D),b(e,t),b(t,n),b(n,o),R(a,o,null),b(t,c),b(t,u),b(u,r),b(u,i),b(u,d),b(t,f),b(t,h),b(h,w),R(v,w,null),b(e,H),R(L,e,null),b(e,j),b(e,N),b(N,V),b(V,m),b(N,k),b(N,_),b(_,U),M=!0,q||(ie=[$(o,"click",l[14]),$(w,"click",l[13]),$(V,"click",l[16]),$(_,"click",l[17])],q=!0)},p(p,D){var x;(!M||D&256)&&s!==(s=(((x=ve(p[8]))==null?void 0:x.label)??"")+"")&&K(r,s),(!M||D&512)&&K(d,p[9]);const A={};D&256&&(A.month=p[8]),D&512&&(A.year=p[9]),D&1&&(A.date=p[0]),D&2&&(A.isAllowed=p[1]),L.$set(A),(!M||D&16)&&K(m,p[4]),(!M||D&32)&&K(U,p[5])},i(p){M||(S(a.$$.fragment,p),S(v.$$.fragment,p),S(L.$$.fragment,p),M=!0)},o(p){T(a.$$.fragment,p),T(v.$$.fragment,p),T(L.$$.fragment,p),M=!1},d(p){p&&g(e),z(a),z(v),z(L),q=!1,qe(ie)}}}function mt(l){let e,t,n,o,a,c,u;t=new tt({props:{id:"datepicker",label:l[2],labelHidden:l[3],icon:"calendar-plus",type:"text",placeholder:"MM/DD/YY",value:l[0].toDateString(),clearable:!0,clearButtonLabel:l[6],disabled:l[7]}}),t.$on("focus",l[11]),t.$on("input",l[12]);let s=l[10]&&Me(l);return{c(){e=I("div"),Q(t.$$.fragment),n=O(),s&&s.c(),this.h()},l(r){e=C(r,"DIV",{class:!0});var i=E(e);G(t.$$.fragment,i),n=F(i),s&&s.l(i),i.forEach(g),this.h()},h(){y(e,"class","relative")},m(r,i){B(r,e,i),R(t,e,null),b(e,n),s&&s.m(e,null),a=!0,c||(u=Ue(o=$e.call(null,e,l[18])),c=!0)},p(r,[i]){const d={};i&4&&(d.label=r[2]),i&8&&(d.labelHidden=r[3]),i&1&&(d.value=r[0].toDateString()),i&64&&(d.clearButtonLabel=r[6]),i&128&&(d.disabled=r[7]),t.$set(d),r[10]?s?(s.p(r,i),i&1024&&S(s,1)):(s=Me(r),s.c(),S(s,1),s.m(e,null)):s&&(ue(),T(s,1,1,()=>{s=null}),ce()),o&&Oe(o.update)&&i&1024&&o.update.call(null,r[18])},i(r){a||(S(t.$$.fragment,r),S(s),a=!0)},o(r){T(t.$$.fragment,r),T(s),a=!1},d(r){r&&g(e),z(t),s&&s.d(),c=!1,u()}}}function gt(l,e,t){const n=Be();let{isAllowed:o=()=>!0}=e,{selected:a=new Date}=e,{label:c}=e,{labelHidden:u=!1}=e,{todayLabel:s}=e,{closeLabel:r}=e,{clearLabel:i}=e,{disabled:d=!1}=e,f,h,w=!1;const v=()=>{t(10,w=!0)},H=_=>{const M=_.target.value;if(M.length===8){const q=M==null?void 0:M.split("/"),le=2e3+parseInt(q[2]),p=parseInt(q[0])-1,D=parseInt(q[1]),A=new Date(le,p,D);n("datechange",A)}},L=()=>{if(f===11){t(8,f=0),t(9,h=h+1);return}t(8,f=f+1)},j=()=>{if(f===0){t(8,f=11),t(9,h-=1);return}t(8,f-=1)},N=_=>{t(10,w=!1),n("datechange",_.detail)},V=()=>t(0,a=new Date),m=()=>t(10,w=!1),k=()=>t(10,w=!1);return l.$$set=_=>{"isAllowed"in _&&t(1,o=_.isAllowed),"selected"in _&&t(0,a=_.selected),"label"in _&&t(2,c=_.label),"labelHidden"in _&&t(3,u=_.labelHidden),"todayLabel"in _&&t(4,s=_.todayLabel),"closeLabel"in _&&t(5,r=_.closeLabel),"clearLabel"in _&&t(6,i=_.clearLabel),"disabled"in _&&t(7,d=_.disabled)},l.$$.update=()=>{l.$$.dirty&1&&(t(8,f=a.getMonth()),t(9,h=a.getFullYear()))},[a,o,c,u,s,r,i,d,f,h,w,v,H,L,j,N,V,m,k]}class jt extends te{constructor(e){super(),ne(this,e,gt,mt,ee,{isAllowed:1,selected:0,label:2,labelHidden:3,todayLabel:4,closeLabel:5,clearLabel:6,disabled:7})}}function bt(l){let e;const t=l[5].default,n=Ye(t,l,l[4],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,a){n&&n.m(o,a),e=!0},p(o,a){n&&n.p&&(!e||a&16)&&Pe(n,t,o,o[4],e?Ge(t,o[4],a,null):Qe(o[4]),null)},i(o){e||(S(n,o),e=!0)},o(o){T(n,o),e=!1},d(o){n&&n.d(o)}}}function wt(l){let e;return{c(){e=Y(l[1])},l(t){e=P(t,l[1])},m(t,n){B(t,e,n)},p(t,n){n&2&&K(e,t[1])},i:W,o:W,d(t){t&&g(e)}}}function kt(l){let e,t,n,o;const a=[wt,bt],c=[];function u(s,r){return s[1]!==s[0]?0:1}return e=u(l),t=c[e]=a[e](l),{c(){t.c(),n=J()},l(s){t.l(s),n=J()},m(s,r){c[e].m(s,r),B(s,n,r),o=!0},p(s,[r]){let i=e;e=u(s),e===i?c[e].p(s,r):(ue(),T(c[i],1,1,()=>{c[i]=null}),ce(),t=c[e],t?t.p(s,r):(t=c[e]=a[e](s),t.c()),S(t,1),t.m(n.parentNode,n))},i(s){o||(S(t),o=!0)},o(s){T(t),o=!1},d(s){s&&g(n),c[e].d(s)}}}function pt(l,e,t){let n,{$$slots:o={},$$scope:a}=e,{key:c}=e,{count:u=void 0}=e,{replace:s=void 0}=e;return l.$$set=r=>{"key"in r&&t(0,c=r.key),"count"in r&&t(2,u=r.count),"replace"in r&&t(3,s=r.replace),"$$scope"in r&&t(4,a=r.$$scope)},l.$$.update=()=>{l.$$.dirty&13&&t(1,n=nt(c,{count:u,...s}))},[c,n,u,s,a,o]}class Ut extends te{constructor(e){super(),ne(this,e,pt,kt,ee,{key:0,count:2,replace:3})}}export{jt as D,Ut as T,Wt as W,Ot as a,lt as b,Ft as i,Ht as w};
