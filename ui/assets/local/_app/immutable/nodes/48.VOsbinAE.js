import{s as le,a1 as ae,M as ie,e as w,a as q,t as J,b as k,d as I,g,h as B,f as z,j as E,k as S,l as _,n as re,T as fe,c as x,v as Q}from"../chunks/scheduler.IHo1m08M.js";import{S as me,i as ue,f as de,c as C,a as M,m as V,t as T,b as U,d as P}from"../chunks/index.uEw0cz3N.js";import{g as se}from"../chunks/entry.ZPUnEpKF.js";import{p as ce}from"../chunks/stores.AqAscN--.js";import{P as ge}from"../chunks/page-title.waH5MUD4.js";import{t as v}from"../chunks/translate.HrioCK44.js";import{B as y}from"../chunks/button.7H165SC0.js";import{I as _e}from"../chunks/input.DhdSzWyu.js";import{L as he}from"../chunks/link.o859nyB0.js";import{M as $e}from"../chunks/modal.__mgfAJm.js";import{N as ve,e as be}from"../chunks/nexus-form.Kd-Mts2t.js";import{j as ee,h as Ne}from"../chunks/route-for.0ysHXC6r.js";import{u as Ee,d as De}from"../chunks/nexus-service.wJAX2SsA.js";import{n as Le}from"../chunks/namespaces.OzMcqq8W.js";import{e as we}from"../chunks/encode-payload.ZYkrsUp7.js";function ke(e){let n=v("nexus.back-to-endpoint")+"",t;return{c(){t=J(n)},l(a){t=z(a,n)},m(a,i){S(a,t,i)},p:Q,d(a){a&&g(t)}}}function Ie(e){let n=v("nexus.delete-endpoint")+"",t;return{c(){t=J(n)},l(a){t=z(a,n)},m(a,i){S(a,t,i)},p:Q,d(a){a&&g(t)}}}function Ce(e){let n=v("common.save")+"",t;return{c(){t=J(n)},l(a){t=z(a,n)},m(a,i){S(a,t,i)},p:Q,d(a){a&&g(t)}}}function Me(e){let n=v("common.save")+"",t;return{c(){t=J(n)},l(a){t=z(a,n)},m(a,i){S(a,t,i)},p:Q,d(a){a&&g(t)}}}function Ve(e){let n=v("common.cancel")+"",t;return{c(){t=J(n)},l(a){t=z(a,n)},m(a,i){S(a,t,i)},p:Q,d(a){a&&g(t)}}}function Te(e){let n,t=v("nexus.delete-modal-title")+"",a;return{c(){n=w("h3"),a=J(t),this.h()},l(i){n=k(i,"H3",{slot:!0});var s=I(n);a=z(s,t),s.forEach(g),this.h()},h(){E(n,"slot","title")},m(i,s){S(i,n,s),_(n,a)},p:Q,d(i){i&&g(n)}}}function Ue(e){let n,t,a=v("nexus.delete-modal-confirmation",{endpoint:e[0].id})+"",i,s,r,p,c;function h(u){e[13](u)}let $={id:"delete-endpoint",required:!0,label:v("nexus.delete-modal-confirmation-label",{endpoint:e[0].id})};return e[9]!==void 0&&($.value=e[9]),r=new _e({props:$}),ie.push(()=>de(r,"value",h)),{c(){n=w("div"),t=w("p"),i=J(a),s=q(),C(r.$$.fragment),this.h()},l(u){n=k(u,"DIV",{slot:!0,class:!0});var d=I(n);t=k(d,"P",{});var o=I(t);i=z(o,a),o.forEach(g),s=B(d),M(r.$$.fragment,d),d.forEach(g),this.h()},h(){E(n,"slot","content"),E(n,"class","flex flex-col gap-4")},m(u,d){S(u,n,d),_(n,t),_(t,i),_(n,s),V(r,n,null),c=!0},p(u,d){(!c||d&1)&&a!==(a=v("nexus.delete-modal-confirmation",{endpoint:u[0].id})+"")&&re(i,a);const o={};d&1&&(o.label=v("nexus.delete-modal-confirmation-label",{endpoint:u[0].id})),!p&&d&512&&(p=!0,o.value=u[9],fe(()=>p=!1)),r.$set(o)},i(u){c||(T(r.$$.fragment,u),c=!0)},o(u){U(r.$$.fragment,u),c=!1},d(u){u&&g(n),P(r)}}}function Pe(e){let n,t,a,i,s,r,p,c=e[0].spec.name+"",h,$,u,d,o,b,H,D,R,L,f,te,F,Y,N,ne,W;a=new he({props:{href:ee(e[10].params.id),icon:"chevron-left",$$slots:{default:[ke]},$$scope:{ctx:e}}}),d=new y({props:{variant:"destructive",$$slots:{default:[Ie]},$$scope:{ctx:e}}}),d.$on("click",e[11]),b=new y({props:{loading:e[6],$$slots:{default:[Ce]},$$scope:{ctx:e}}}),b.$on("click",function(){ae(e[3])&&e[3].apply(this,arguments)}),D=new ve({props:{endpoint:e[0],targetNamespaceList:e[1],callerNamespaceList:e[2],error:e[5],isCloud:e[7],nameDisabled:!0}}),f=new y({props:{loading:e[6],$$slots:{default:[Me]},$$scope:{ctx:e}}}),f.$on("click",function(){ae(e[3])&&e[3].apply(this,arguments)}),F=new y({props:{variant:"ghost",$$slots:{default:[Ve]},$$scope:{ctx:e}}}),F.$on("click",e[12]);function pe(m){e[14](m)}let oe={id:"delete-endpoint-modal",confirmType:"destructive",confirmText:v("common.delete"),cancelText:v("common.cancel"),confirmDisabled:e[9]!==`DELETE ${e[0].id}`,$$slots:{content:[Ue],title:[Te]},$$scope:{ctx:e}};return e[8]!==void 0&&(oe.open=e[8]),N=new $e({props:oe}),ie.push(()=>de(N,"open",pe)),N.$on("confirmModal",function(){ae(e[4])&&e[4].apply(this,arguments)}),N.$on("cancelModal",e[15]),{c(){n=w("div"),t=w("div"),C(a.$$.fragment),i=q(),s=w("div"),r=w("div"),p=w("h1"),h=J(c),$=q(),u=w("div"),C(d.$$.fragment),o=q(),C(b.$$.fragment),H=q(),C(D.$$.fragment),R=q(),L=w("div"),C(f.$$.fragment),te=q(),C(F.$$.fragment),Y=q(),C(N.$$.fragment),this.h()},l(m){n=k(m,"DIV",{class:!0});var l=I(n);t=k(l,"DIV",{class:!0});var K=I(t);M(a.$$.fragment,K),K.forEach(g),i=B(l),s=k(l,"DIV",{class:!0});var X=I(s);r=k(X,"DIV",{class:!0});var O=I(r);p=k(O,"H1",{"data-testid":!0,class:!0});var j=I(p);h=z(j,c),j.forEach(g),$=B(O),u=k(O,"DIV",{class:!0});var A=I(u);M(d.$$.fragment,A),o=B(A),M(b.$$.fragment,A),A.forEach(g),O.forEach(g),X.forEach(g),H=B(l),M(D.$$.fragment,l),R=B(l),L=k(l,"DIV",{class:!0});var G=I(L);M(f.$$.fragment,G),te=B(G),M(F.$$.fragment,G),G.forEach(g),l.forEach(g),Y=B(m),M(N.$$.fragment,m),this.h()},h(){E(t,"class","relative flex flex-col gap-4 text-sm"),E(p,"data-testid","namespace-selector-title"),E(p,"class","text-2xl"),E(u,"class","flex items-center gap-2"),E(r,"class","flex items-center justify-between"),E(s,"class","flex flex-col gap-1"),E(L,"class","flex items-center gap-4"),E(n,"class","flex flex-col gap-8")},m(m,l){S(m,n,l),_(n,t),V(a,t,null),_(n,i),_(n,s),_(s,r),_(r,p),_(p,h),_(r,$),_(r,u),V(d,u,null),_(u,o),V(b,u,null),_(n,H),V(D,n,null),_(n,R),_(n,L),V(f,L,null),_(L,te),V(F,L,null),S(m,Y,l),V(N,m,l),W=!0},p(m,[l]){e=m;const K={};l&1024&&(K.href=ee(e[10].params.id)),l&65536&&(K.$$scope={dirty:l,ctx:e}),a.$set(K),(!W||l&1)&&c!==(c=e[0].spec.name+"")&&re(h,c);const X={};l&65536&&(X.$$scope={dirty:l,ctx:e}),d.$set(X);const O={};l&64&&(O.loading=e[6]),l&65536&&(O.$$scope={dirty:l,ctx:e}),b.$set(O);const j={};l&1&&(j.endpoint=e[0]),l&2&&(j.targetNamespaceList=e[1]),l&4&&(j.callerNamespaceList=e[2]),l&32&&(j.error=e[5]),l&128&&(j.isCloud=e[7]),D.$set(j);const A={};l&64&&(A.loading=e[6]),l&65536&&(A.$$scope={dirty:l,ctx:e}),f.$set(A);const G={};l&65536&&(G.$$scope={dirty:l,ctx:e}),F.$set(G);const Z={};l&513&&(Z.confirmDisabled=e[9]!==`DELETE ${e[0].id}`),l&66049&&(Z.$$scope={dirty:l,ctx:e}),!ne&&l&256&&(ne=!0,Z.open=e[8],fe(()=>ne=!1)),N.$set(Z)},i(m){W||(T(a.$$.fragment,m),T(d.$$.fragment,m),T(b.$$.fragment,m),T(D.$$.fragment,m),T(f.$$.fragment,m),T(F.$$.fragment,m),T(N.$$.fragment,m),W=!0)},o(m){U(a.$$.fragment,m),U(d.$$.fragment,m),U(b.$$.fragment,m),U(D.$$.fragment,m),U(f.$$.fragment,m),U(F.$$.fragment,m),U(N.$$.fragment,m),W=!1},d(m){m&&(g(n),g(Y)),P(a),P(d),P(b),P(D),P(f),P(F),P(N,m)}}}function Se(e,n,t){let a;x(e,ce,f=>t(10,a=f));let{endpoint:i}=n,{targetNamespaceList:s=[]}=n,{callerNamespaceList:r=[]}=n,{onUpdate:p}=n,{onDelete:c}=n,{error:h=void 0}=n,{loading:$=!1}=n,{isCloud:u=!1}=n,d=!1,o="";const b=()=>t(8,d=!0),H=()=>se(ee(a.params.id));function D(f){o=f,t(9,o)}function R(f){d=f,t(8,d)}const L=()=>t(8,d=!1);return e.$$set=f=>{"endpoint"in f&&t(0,i=f.endpoint),"targetNamespaceList"in f&&t(1,s=f.targetNamespaceList),"callerNamespaceList"in f&&t(2,r=f.callerNamespaceList),"onUpdate"in f&&t(3,p=f.onUpdate),"onDelete"in f&&t(4,c=f.onDelete),"error"in f&&t(5,h=f.error),"loading"in f&&t(6,$=f.loading),"isCloud"in f&&t(7,u=f.isCloud)},[i,s,r,p,c,h,$,u,d,o,a,b,H,D,R,L]}class Fe extends me{constructor(n){super(),ue(this,n,Se,Pe,le,{endpoint:0,targetNamespaceList:1,callerNamespaceList:2,onUpdate:3,onDelete:4,error:5,loading:6,isCloud:7})}}function je(e){let n,t,a,i;return n=new ge({props:{title:`Edit ${v("nexus.nexus-endpoint",{id:e[4].params.id})}`,url:e[4].url.href}}),a=new Fe({props:{endpoint:e[3],loading:e[1],targetNamespaceList:e[2],onUpdate:e[5],onDelete:e[6],error:e[0]}}),{c(){C(n.$$.fragment),t=q(),C(a.$$.fragment)},l(s){M(n.$$.fragment,s),t=B(s),M(a.$$.fragment,s)},m(s,r){V(n,s,r),S(s,t,r),V(a,s,r),i=!0},p(s,[r]){const p={};r&16&&(p.title=`Edit ${v("nexus.nexus-endpoint",{id:s[4].params.id})}`),r&16&&(p.url=s[4].url.href),n.$set(p);const c={};r&8&&(c.endpoint=s[3]),r&2&&(c.loading=s[1]),r&4&&(c.targetNamespaceList=s[2]),r&1&&(c.error=s[0]),a.$set(c)},i(s){i||(T(n.$$.fragment,s),T(a.$$.fragment,s),i=!0)},o(s){U(n.$$.fragment,s),U(a.$$.fragment,s),i=!1},d(s){s&&g(t),P(n,s),P(a,s)}}}function qe(e,n,t){let a,i,s,r,p;x(e,Le,o=>t(8,s=o)),x(e,be,o=>t(9,r=o)),x(e,ce,o=>t(4,p=o));let{data:c}=n,h,$=!1;const u=async()=>{t(0,h=void 0),t(1,$=!0);const o={...r};o.id=a.id,o.version=a.version;const b=await we(JSON.stringify(o.spec.descriptionString));o.spec.description=b[0],delete o.spec.allowedCallerNamespaces,delete o.spec.descriptionString;try{await Ee(a.id,o),se(ee(a.id),{invalidateAll:!0})}catch(H){t(0,h=H),console.error("Error updating endpoint",H)}finally{t(1,$=!1)}},d=async()=>{t(0,h=void 0),t(1,$=!0);try{await De(a.id,a.version),se(Ne())}catch(o){t(0,h=o),console.error("Error deleting endpoint",o)}finally{t(1,$=!1)}};return e.$$set=o=>{"data"in o&&t(7,c=o.data)},e.$$.update=()=>{e.$$.dirty&128&&t(3,{endpoint:a}=c,a),e.$$.dirty&256&&t(2,i=s.map(o=>({namespace:o.namespaceInfo.name})))},[h,$,i,a,p,u,d,c,s]}class xe extends me{constructor(n){super(),ue(this,n,qe,je,le,{data:7})}}export{xe as component};
