import{S as K,b as O,a as G,m as L,p as C,q as D,k as p,f as h,z as H,g as w,h as J,j as k,K as A,C as v,D as y,E,F as T,ar as j,e as B,as as Z,w as P,x as R,L as b,y as M,n as U,c as q,d as Q,u as W}from"../chunks/index.4e2fcbc7.js";import{p as X}from"../chunks/stores.56b0cea3.js";import{P as x}from"../chunks/page-title.f9a44b80.js";import{t as g}from"../chunks/translate.d23a91ae.js";import{A as ee}from"../chunks/alert.9612e524.js";import{B as te}from"../chunks/button.a45b0e55.js";import{C as re}from"../chunks/code-block.42919072.js";import{E as Y}from"../chunks/empty-state.721f6c59.js";import{L as le}from"../chunks/link.6803bb00.js";import{L as oe}from"../chunks/loading.95801385.js";import{g as z}from"../chunks/query-service.30773ec1.js";import{a as ne}from"../chunks/auth-user.27970a44.js";import{w as ae}from"../chunks/workflow-run.ed9ee76a.js";function se(a){let t,r;return t=new Y({props:{title:g("workflows.call-stack-empty-state"),testId:"query-call-stack-empty",$$slots:{default:[ie]},$$scope:{ctx:a}}}),{c(){v(t.$$.fragment)},l(e){y(t.$$.fragment,e)},m(e,l){E(t,e,l),r=!0},p(e,l){const o={};l&4105&&(o.$$scope={dirty:l,ctx:e}),t.$set(o)},i(e){r||(k(t.$$.fragment,e),r=!0)},o(e){w(t.$$.fragment,e),r=!1},d(e){T(t,e)}}}function ce(a){let t,r,e,l={ctx:a,current:null,token:null,hasCatch:!0,pending:$e,then:me,catch:ue,value:10,error:11,blocks:[,,,]};return j(r=a[2],l),{c(){t=B(),l.block.c()},l(o){t=B(),l.block.l(o)},m(o,n){h(o,t,n),l.block.m(o,l.anchor=n),l.mount=()=>t.parentNode,l.anchor=t,e=!0},p(o,n){a=o,l.ctx=a,n&4&&r!==(r=a[2])&&j(r,l)||Z(l,a,n)},i(o){e||(k(l.block),e=!0)},o(o){for(let n=0;n<3;n+=1){const s=l.blocks[n];w(s)}e=!1},d(o){o&&p(t),l.block.d(o),l.token=null,l=null}}}function F(a){var c;let t,r=g("workflows.call-stack-link-preface")+"",e,l,o=g("workflows.call-stack-link-postface",{taskQueue:(c=a[0])==null?void 0:c.taskQueue})+"",n,s;return l=new le({props:{href:"https://docs.temporal.io/workflows#stack-trace-query",$$slots:{default:[fe]},$$scope:{ctx:a}}}),{c(){t=L("p"),e=P(r),v(l.$$.fragment),n=P(o)},l(f){t=C(f,"P",{});var i=D(t);e=R(i,r),y(l.$$.fragment,i),n=R(i,o),i.forEach(p)},m(f,i){h(f,t,i),b(t,e),E(l,t,null),b(t,n),s=!0},p(f,i){var d;const $={};i&4096&&($.$$scope={dirty:i,ctx:f}),l.$set($),(!s||i&1)&&o!==(o=g("workflows.call-stack-link-postface",{taskQueue:(d=f[0])==null?void 0:d.taskQueue})+"")&&M(n,o)},i(f){s||(k(l.$$.fragment,f),s=!0)},o(f){w(l.$$.fragment,f),s=!1},d(f){f&&p(t),T(l)}}}function fe(a){let t=g("workflows.call-stack-link")+"",r;return{c(){r=P(t)},l(e){r=R(e,t)},m(e,l){h(e,r,l)},p:U,d(e){e&&p(r)}}}function ie(a){var l,o,n;let t,r,e=((l=a[0])==null?void 0:l.isRunning)&&((n=(o=a[3])==null?void 0:o.pollers)==null?void 0:n.length)===0&&F(a);return{c(){e&&e.c(),t=B()},l(s){e&&e.l(s),t=B()},m(s,c){e&&e.m(s,c),h(s,t,c),r=!0},p(s,c){var f,i,$;(f=s[0])!=null&&f.isRunning&&(($=(i=s[3])==null?void 0:i.pollers)==null?void 0:$.length)===0?e?(e.p(s,c),c&9&&k(e,1)):(e=F(s),e.c(),k(e,1),e.m(t.parentNode,t)):e&&(H(),w(e,1,1,()=>{e=null}),J())},i(s){r||(k(e),r=!0)},o(s){w(e),r=!1},d(s){e&&e.d(s),s&&p(t)}}}function ue(a){let t,r;return t=new Y({props:{title:g("common.error-occurred"),content:g("workflows.no-workers-running-message")}}),{c(){v(t.$$.fragment)},l(e){y(t.$$.fragment,e)},m(e,l){E(t,e,l),r=!0},p:U,i(e){r||(k(t.$$.fragment,e),r=!0)},o(e){w(t.$$.fragment,e),r=!1},d(e){T(t,e)}}}function me(a){let t,r,e,l,o,n,s=g("workflows.call-stack-at")+"",c,f,i=a[1].toLocaleTimeString()+"",$,d,m,I,N;return t=new ee({props:{intent:"info",icon:"info",title:g("workflows.call-stack-alert"),class:"mb-4 w-fit"}}),l=new te({props:{leadingIcon:"retry",loading:ke,$$slots:{default:[pe]},$$scope:{ctx:a}}}),l.$on("click",a[4]),I=new re({props:{content:a[10],language:"text",testId:"query-call-stack",copyIconTitle:g("common.copy-icon-title"),copySuccessIconTitle:g("common.copy-success-icon-title")}}),{c(){v(t.$$.fragment),r=q(),e=L("div"),v(l.$$.fragment),o=q(),n=L("p"),c=P(s),f=q(),$=P(i),d=q(),m=L("div"),v(I.$$.fragment),this.h()},l(u){y(t.$$.fragment,u),r=Q(u),e=C(u,"DIV",{class:!0});var _=D(e);y(l.$$.fragment,_),o=Q(_),n=C(_,"P",{});var S=D(n);c=R(S,s),f=Q(S),$=R(S,i),S.forEach(p),_.forEach(p),d=Q(u),m=C(u,"DIV",{class:!0});var V=D(m);y(I.$$.fragment,V),V.forEach(p),this.h()},h(){W(e,"class","flex items-center gap-4"),W(m,"class","my-2 flex h-full items-start")},m(u,_){E(t,u,_),h(u,r,_),h(u,e,_),E(l,e,null),b(e,o),b(e,n),b(n,c),b(n,f),b(n,$),h(u,d,_),h(u,m,_),E(I,m,null),N=!0},p(u,_){const S={};_&4096&&(S.$$scope={dirty:_,ctx:u}),l.$set(S),(!N||_&2)&&i!==(i=u[1].toLocaleTimeString()+"")&&M($,i);const V={};_&4&&(V.content=u[10]),I.$set(V)},i(u){N||(k(t.$$.fragment,u),k(l.$$.fragment,u),k(I.$$.fragment,u),N=!0)},o(u){w(t.$$.fragment,u),w(l.$$.fragment,u),w(I.$$.fragment,u),N=!1},d(u){T(t,u),u&&p(r),u&&p(e),T(l),u&&p(d),u&&p(m),T(I)}}}function pe(a){let t=g("common.refresh")+"",r;return{c(){r=P(t)},l(e){r=R(e,t)},m(e,l){h(e,r,l)},p:U,d(e){e&&p(r)}}}function $e(a){let t,r,e,l,o=g("workflows.no-workers-failure-message")+"",n,s;return r=new oe({}),{c(){t=L("div"),v(r.$$.fragment),e=q(),l=L("p"),n=P(o),this.h()},l(c){t=C(c,"DIV",{class:!0});var f=D(t);y(r.$$.fragment,f),e=Q(f),l=C(f,"P",{});var i=D(l);n=R(i,o),i.forEach(p),f.forEach(p),this.h()},h(){W(t,"class","text-center")},m(c,f){h(c,t,f),E(r,t,null),b(t,e),b(t,l),b(l,n),s=!0},p:U,i(c){s||(k(r.$$.fragment,c),s=!0)},o(c){w(r.$$.fragment,c),s=!1},d(c){c&&p(t),T(r)}}}function _e(a){let t,r,e,l;const o=[ce,se],n=[];function s(c,f){var i,$,d;return(i=c[0])!=null&&i.isRunning&&((d=($=c[3])==null?void 0:$.pollers)==null?void 0:d.length)>0?0:1}return r=s(a),e=n[r]=o[r](a),{c(){t=L("section"),e.c()},l(c){t=C(c,"SECTION",{});var f=D(t);e.l(f),f.forEach(p)},m(c,f){h(c,t,f),n[r].m(t,null),l=!0},p(c,[f]){let i=r;r=s(c),r===i?n[r].p(c,f):(H(),w(n[i],1,1,()=>{n[i]=null}),J(),e=n[r],e?e.p(c,f):(e=n[r]=o[r](c),e.c()),k(e,1),e.m(t,null))},i(c){l||(k(e),l=!0)},o(c){w(e),l=!1},d(c){c&&p(t),n[r].d()}}}let ke=!1;function ge(a,t,r){let e,l,o,n,s;A(a,ne,m=>r(6,o=m)),A(a,X,m=>r(7,n=m)),A(a,ae,m=>r(5,s=m));const{namespace:c}=n.params;let f=new Date;const i=()=>{var m;return z({workflow:e,namespace:c},(m=n.data)===null||m===void 0?void 0:m.settings,o==null?void 0:o.accessToken)};let $;const d=()=>{var m;r(2,$=z({workflow:e,namespace:c},(m=n.data)===null||m===void 0?void 0:m.settings,o==null?void 0:o.accessToken)),$.then(()=>{r(1,f=new Date)})};return a.$$.update=()=>{a.$$.dirty&32&&r(0,{workflow:e,workers:l}=s,e,(r(3,l),r(5,s))),a.$$.dirty&1&&e!=null&&e.isRunning&&r(2,$=i())},[e,f,$,l,d,s]}class we extends K{constructor(t){super(),O(this,t,ge,_e,G,{})}}function de(a){let t,r,e,l;return t=new x({props:{title:`${g("workflows.call-stack-tab")} | ${a[1]}`,url:a[0].url.href}}),e=new we({}),{c(){v(t.$$.fragment),r=q(),v(e.$$.fragment)},l(o){y(t.$$.fragment,o),r=Q(o),y(e.$$.fragment,o)},m(o,n){E(t,o,n),h(o,r,n),E(e,o,n),l=!0},p(o,[n]){const s={};n&1&&(s.url=o[0].url.href),t.$set(s)},i(o){l||(k(t.$$.fragment,o),k(e.$$.fragment,o),l=!0)},o(o){w(t.$$.fragment,o),w(e.$$.fragment,o),l=!1},d(o){T(t,o),o&&p(r),T(e,o)}}}function he(a,t,r){let e;A(a,X,o=>r(0,e=o));const l=e.params.workflow;return[e,l]}class Qe extends K{constructor(t){super(),O(this,t,he,de,G,{})}}export{Qe as component};
