import{s as F,e as L,b as P,d as R,g as p,k as h,c as A,x as B,t as C,f as D,l as b,n as G,v as W,a as q,h as Q,j as U}from"../chunks/scheduler.yuwC4fMQ.js";import{S as H,i as J,g as K,b as d,e as M,t as k,c as v,a as y,m as T,d as E}from"../chunks/index.m6evPz-M.js";import{p as X}from"../chunks/stores.4bJuupxX.js";import{P as Z}from"../chunks/page-title.okfP2p91.js";import{t as g}from"../chunks/translate.eu_ZgPaL.js";import{h as j,u as x}from"../chunks/await_block.RzOPDskp.js";import{A as ee}from"../chunks/alert.AplxncRT.js";import{B as te}from"../chunks/button.-XR8wPrN.js";import{C as re}from"../chunks/code-block.rMrlq7a-.js";import{E as Y}from"../chunks/empty-state.d2_3vbJ9.js";import{L as le}from"../chunks/link.rn3VH7rf.js";import{L as oe}from"../chunks/loading.zgfbl5xF.js";import{g as O}from"../chunks/query-service.e_BMW_bp.js";import{a as ne}from"../chunks/auth-user.LiFDI41x.js";import{w as ae}from"../chunks/workflow-run.QJKZhX-1.js";function se(s){let t,l;return t=new Y({props:{title:g("workflows.call-stack-empty-state"),testId:"query-call-stack-empty",$$slots:{default:[ie]},$$scope:{ctx:s}}}),{c(){v(t.$$.fragment)},l(e){y(t.$$.fragment,e)},m(e,r){T(t,e,r),l=!0},p(e,r){const o={};r&4105&&(o.$$scope={dirty:r,ctx:e}),t.$set(o)},i(e){l||(k(t.$$.fragment,e),l=!0)},o(e){d(t.$$.fragment,e),l=!1},d(e){E(t,e)}}}function ce(s){let t,l,e,r={ctx:s,current:null,token:null,hasCatch:!0,pending:$e,then:me,catch:ue,value:10,error:11,blocks:[,,,]};return j(l=s[2],r),{c(){t=B(),r.block.c()},l(o){t=B(),r.block.l(o)},m(o,n){h(o,t,n),r.block.m(o,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,e=!0},p(o,n){s=o,r.ctx=s,n&4&&l!==(l=s[2])&&j(l,r)||x(r,s,n)},i(o){e||(k(r.block),e=!0)},o(o){for(let n=0;n<3;n+=1){const a=r.blocks[n];d(a)}e=!1},d(o){o&&p(t),r.block.d(o),r.token=null,r=null}}}function z(s){var c;let t,l=g("workflows.call-stack-link-preface")+"",e,r,o=g("workflows.call-stack-link-postface",{taskQueue:(c=s[0])==null?void 0:c.taskQueue})+"",n,a;return r=new le({props:{newTab:!0,href:"https://docs.temporal.io/workflows#stack-trace-query",$$slots:{default:[fe]},$$scope:{ctx:s}}}),{c(){t=L("p"),e=C(l),v(r.$$.fragment),n=C(o)},l(f){t=P(f,"P",{});var i=R(t);e=D(i,l),y(r.$$.fragment,i),n=D(i,o),i.forEach(p)},m(f,i){h(f,t,i),b(t,e),T(r,t,null),b(t,n),a=!0},p(f,i){var w;const $={};i&4096&&($.$$scope={dirty:i,ctx:f}),r.$set($),(!a||i&1)&&o!==(o=g("workflows.call-stack-link-postface",{taskQueue:(w=f[0])==null?void 0:w.taskQueue})+"")&&G(n,o)},i(f){a||(k(r.$$.fragment,f),a=!0)},o(f){d(r.$$.fragment,f),a=!1},d(f){f&&p(t),E(r)}}}function fe(s){let t=g("workflows.call-stack-link")+"",l;return{c(){l=C(t)},l(e){l=D(e,t)},m(e,r){h(e,l,r)},p:W,d(e){e&&p(l)}}}function ie(s){var r,o,n;let t,l,e=((r=s[0])==null?void 0:r.isRunning)&&((n=(o=s[3])==null?void 0:o.pollers)==null?void 0:n.length)===0&&z(s);return{c(){e&&e.c(),t=B()},l(a){e&&e.l(a),t=B()},m(a,c){e&&e.m(a,c),h(a,t,c),l=!0},p(a,c){var f,i,$;(f=a[0])!=null&&f.isRunning&&(($=(i=a[3])==null?void 0:i.pollers)==null?void 0:$.length)===0?e?(e.p(a,c),c&9&&k(e,1)):(e=z(a),e.c(),k(e,1),e.m(t.parentNode,t)):e&&(K(),d(e,1,1,()=>{e=null}),M())},i(a){l||(k(e),l=!0)},o(a){d(e),l=!1},d(a){a&&p(t),e&&e.d(a)}}}function ue(s){var e;let t,l;return t=new Y({props:{title:g("common.error-occurred"),content:g("workflows.no-workers-running-message"),error:(e=s[11])==null?void 0:e.message}}),{c(){v(t.$$.fragment)},l(r){y(t.$$.fragment,r)},m(r,o){T(t,r,o),l=!0},p(r,o){var a;const n={};o&4&&(n.error=(a=r[11])==null?void 0:a.message),t.$set(n)},i(r){l||(k(t.$$.fragment,r),l=!0)},o(r){d(t.$$.fragment,r),l=!1},d(r){E(t,r)}}}function me(s){let t,l,e,r,o,n,a=g("workflows.call-stack-at")+"",c,f,i=s[1].toLocaleTimeString()+"",$,w,m,I,N;return t=new ee({props:{intent:"info",icon:"info",title:g("workflows.call-stack-alert"),class:"mb-4 w-fit"}}),r=new te({props:{leadingIcon:"retry",loading:ke,$$slots:{default:[pe]},$$scope:{ctx:s}}}),r.$on("click",s[4]),I=new re({props:{content:s[10],language:"text",testId:"query-call-stack",copyIconTitle:g("common.copy-icon-title"),copySuccessIconTitle:g("common.copy-success-icon-title")}}),{c(){v(t.$$.fragment),l=q(),e=L("div"),v(r.$$.fragment),o=q(),n=L("p"),c=C(a),f=q(),$=C(i),w=q(),m=L("div"),v(I.$$.fragment),this.h()},l(u){y(t.$$.fragment,u),l=Q(u),e=P(u,"DIV",{class:!0});var _=R(e);y(r.$$.fragment,_),o=Q(_),n=P(_,"P",{});var S=R(n);c=D(S,a),f=Q(S),$=D(S,i),S.forEach(p),_.forEach(p),w=Q(u),m=P(u,"DIV",{class:!0});var V=R(m);y(I.$$.fragment,V),V.forEach(p),this.h()},h(){U(e,"class","flex items-center gap-4"),U(m,"class","my-2 flex h-full items-start")},m(u,_){T(t,u,_),h(u,l,_),h(u,e,_),T(r,e,null),b(e,o),b(e,n),b(n,c),b(n,f),b(n,$),h(u,w,_),h(u,m,_),T(I,m,null),N=!0},p(u,_){const S={};_&4096&&(S.$$scope={dirty:_,ctx:u}),r.$set(S),(!N||_&2)&&i!==(i=u[1].toLocaleTimeString()+"")&&G($,i);const V={};_&4&&(V.content=u[10]),I.$set(V)},i(u){N||(k(t.$$.fragment,u),k(r.$$.fragment,u),k(I.$$.fragment,u),N=!0)},o(u){d(t.$$.fragment,u),d(r.$$.fragment,u),d(I.$$.fragment,u),N=!1},d(u){u&&(p(l),p(e),p(w),p(m)),E(t,u),E(r),E(I)}}}function pe(s){let t=g("common.refresh")+"",l;return{c(){l=C(t)},l(e){l=D(e,t)},m(e,r){h(e,l,r)},p:W,d(e){e&&p(l)}}}function $e(s){let t,l,e,r,o=g("workflows.no-workers-failure-message")+"",n,a;return l=new oe({}),{c(){t=L("div"),v(l.$$.fragment),e=q(),r=L("p"),n=C(o),this.h()},l(c){t=P(c,"DIV",{class:!0});var f=R(t);y(l.$$.fragment,f),e=Q(f),r=P(f,"P",{});var i=R(r);n=D(i,o),i.forEach(p),f.forEach(p),this.h()},h(){U(t,"class","text-center")},m(c,f){h(c,t,f),T(l,t,null),b(t,e),b(t,r),b(r,n),a=!0},p:W,i(c){a||(k(l.$$.fragment,c),a=!0)},o(c){d(l.$$.fragment,c),a=!1},d(c){c&&p(t),E(l)}}}function _e(s){let t,l,e,r;const o=[ce,se],n=[];function a(c,f){var i,$,w;return(i=c[0])!=null&&i.isRunning&&((w=($=c[3])==null?void 0:$.pollers)==null?void 0:w.length)>0?0:1}return l=a(s),e=n[l]=o[l](s),{c(){t=L("section"),e.c()},l(c){t=P(c,"SECTION",{});var f=R(t);e.l(f),f.forEach(p)},m(c,f){h(c,t,f),n[l].m(t,null),r=!0},p(c,[f]){let i=l;l=a(c),l===i?n[l].p(c,f):(K(),d(n[i],1,1,()=>{n[i]=null}),M(),e=n[l],e?e.p(c,f):(e=n[l]=o[l](c),e.c()),k(e,1),e.m(t,null))},i(c){r||(k(e),r=!0)},o(c){d(e),r=!1},d(c){c&&p(t),n[l].d()}}}let ke=!1;function ge(s,t,l){let e,r,o,n,a;A(s,ne,m=>l(6,o=m)),A(s,X,m=>l(7,n=m)),A(s,ae,m=>l(5,a=m));const{namespace:c}=n.params;let f=new Date;const i=()=>{var m;return O({workflow:e,namespace:c},(m=n.data)===null||m===void 0?void 0:m.settings,o==null?void 0:o.accessToken)};let $;const w=()=>{var m;l(2,$=O({workflow:e,namespace:c},(m=n.data)===null||m===void 0?void 0:m.settings,o==null?void 0:o.accessToken)),$.then(()=>{l(1,f=new Date)})};return s.$$.update=()=>{s.$$.dirty&32&&l(0,{workflow:e,workers:r}=a,e,(l(3,r),l(5,a))),s.$$.dirty&1&&e!=null&&e.isRunning&&l(2,$=i())},[e,f,$,r,w,a]}class de extends H{constructor(t){super(),J(this,t,ge,_e,F,{})}}function we(s){let t,l,e,r;return t=new Z({props:{title:`${g("workflows.call-stack-tab")} | ${s[1]}`,url:s[0].url.href}}),e=new de({}),{c(){v(t.$$.fragment),l=q(),v(e.$$.fragment)},l(o){y(t.$$.fragment,o),l=Q(o),y(e.$$.fragment,o)},m(o,n){T(t,o,n),h(o,l,n),T(e,o,n),r=!0},p(o,[n]){const a={};n&1&&(a.url=o[0].url.href),t.$set(a)},i(o){r||(k(t.$$.fragment,o),k(e.$$.fragment,o),r=!0)},o(o){d(t.$$.fragment,o),d(e.$$.fragment,o),r=!1},d(o){o&&p(l),E(t,o),E(e,o)}}}function he(s,t,l){let e;A(s,X,o=>l(0,e=o));const r=e.params.workflow;return[e,r]}class Ve extends H{constructor(t){super(),J(this,t,he,we,F,{})}}export{Ve as component};
