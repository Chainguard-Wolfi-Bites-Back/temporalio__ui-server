import{d as p,w as D}from"./index.fd755237.js";import{p as S}from"./stores.23937386.js";import{e as W}from"./event-view.d573b7d5.js";import{k as F}from"./route-for.46ae5cf0.js";import{r as z}from"./workflow-run.fac22db6.js";import{a as X}from"./auth-user.87e40bc9.js";import{D as Y}from"./is-event-type.066c834c.js";import{S as Z,b as U,a as x,O as R,m as b,c as C,w as $,p as k,q as y,d as j,x as ee,k as h,u as q,R as G,T as w,f as H,M as E,j as v,z as J,g,h as M,y as te,V as se,a5 as N,ag as ne,P as ae,C as re,D as oe,E as le,F as ie,G as ce,H as fe,I as ue,J as me}from"./index.48f48b0a.js";import{I as de}from"./icon.8990cec9.js";import{p as L}from"./paginated.5ed794a4.js";import{r as P,a as T}from"./route-for-api.70777da1.js";import{t as A}from"./index.b2da6f25.js";import{b as _e}from"./has.8da86d13.js";const ve=p([S],([t])=>t.params.namespace?F(t.params.namespace):""),he=p([S],([t])=>t.params.workflow?F(t.params.workflow):""),pe=p([S],([t])=>t.params.run?F(t.params.run):""),ge=p([S],([t])=>{var e;return(e=t.data)==null?void 0:e.settings}),Ee=p([X],([t])=>t==null?void 0:t.accessToken),be=p([ve,he,pe,W],([t,e,n,o])=>({namespace:t,workflowId:e,runId:n,sort:o}));p([be,ge,Ee,z],([t,e,n,o])=>({...t,settings:e,accessToken:n,refresh:z,$refresh:o}));const ke={start:[],end:[]},Ge=D(ke),Je=D(null),ye=D([]),Me=p(ye,t=>t.filter(Y));function O(t){let e,n,o;return n=new de({props:{name:t[2]}}),{c(){e=b("div"),re(n.$$.fragment)},l(s){e=k(s,"DIV",{});var r=y(e);oe(n.$$.fragment,r),r.forEach(h)},m(s,r){H(s,e,r),le(n,e,null),o=!0},p(s,r){const c={};r&4&&(c.name=s[2]),n.$set(c)},i(s){o||(v(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&h(e),ie(n)}}}function B(t){let e,n;const o=t[8].default,s=ce(o,t,t[7],null);return{c(){e=b("div"),s&&s.c(),this.h()},l(r){e=k(r,"DIV",{class:!0});var c=y(e);s&&s.l(c),c.forEach(h),this.h()},h(){q(e,"class","content svelte-1u0e3fc")},m(r,c){H(r,e,c),s&&s.m(e,null),n=!0},p(r,c){s&&s.p&&(!n||c&128)&&fe(s,o,r,r[7],n?me(o,r[7],c,null):ue(r[7]),null)},i(r){n||(v(s,r),n=!0)},o(r){g(s,r),n=!1},d(r){r&&h(e),s&&s.d(r)}}}function Ie(t){let e,n,o,s,r,c,m,u,i=t[2]&&O(t),l=t[6].default&&B(t),d=[{class:m="alert "+t[0]+" "+t[4]},{role:"alert"},t[5]],_={};for(let a=0;a<d.length;a+=1)_=R(_,d[a]);return{c(){e=b("div"),i&&i.c(),n=C(),o=b("div"),s=b("h5"),r=$(t[1]),c=C(),l&&l.c(),this.h()},l(a){e=k(a,"DIV",{class:!0,role:!0});var f=y(e);i&&i.l(f),n=j(f),o=k(f,"DIV",{class:!0});var I=y(o);s=k(I,"H5",{class:!0});var V=y(s);r=ee(V,t[1]),V.forEach(h),c=j(I),l&&l.l(I),I.forEach(h),f.forEach(h),this.h()},h(){q(s,"class","font-semibold leading-6"),q(o,"class","ml-1"),G(e,_),w(e,"bold",t[3]),w(e,"svelte-1u0e3fc",!0)},m(a,f){H(a,e,f),i&&i.m(e,null),E(e,n),E(e,o),E(o,s),E(s,r),E(o,c),l&&l.m(o,null),u=!0},p(a,[f]){a[2]?i?(i.p(a,f),f&4&&v(i,1)):(i=O(a),i.c(),v(i,1),i.m(e,n)):i&&(J(),g(i,1,1,()=>{i=null}),M()),(!u||f&2)&&te(r,a[1]),a[6].default?l?(l.p(a,f),f&64&&v(l,1)):(l=B(a),l.c(),v(l,1),l.m(o,null)):l&&(J(),g(l,1,1,()=>{l=null}),M()),G(e,_=se(d,[(!u||f&17&&m!==(m="alert "+a[0]+" "+a[4]))&&{class:m},{role:"alert"},f&32&&a[5]])),w(e,"bold",a[3]),w(e,"svelte-1u0e3fc",!0)},i(a){u||(v(i),v(l),u=!0)},o(a){g(i),g(l),u=!1},d(a){a&&h(e),i&&i.d(),l&&l.d()}}}function we(t,e,n){const o=["intent","title","icon","bold","class"];let s=N(e,o),{$$slots:r={},$$scope:c}=e;const m=ne(r);let{intent:u}=e,{title:i}=e,{icon:l=null}=e,{bold:d=!1}=e,{class:_=""}=e;return t.$$set=a=>{e=R(R({},e),ae(a)),n(5,s=N(e,o)),"intent"in a&&n(0,u=a.intent),"title"in a&&n(1,i=a.title),"icon"in a&&n(2,l=a.icon),"bold"in a&&n(3,d=a.bold),"class"in a&&n(4,_=a.class),"$$scope"in a&&n(7,c=a.$$scope)},[u,i,l,d,_,s,m,c,r]}class Ne extends Z{constructor(e){super(),U(this,e,we,Ie,x,{intent:0,title:1,icon:2,bold:3,class:4})}}const Q=t=>!_e(t)||t==="descending"?"events.descending":t==="ascending"?"events.ascending":"events.descending",Oe=async({namespace:t,workflowId:e,runId:n,sort:o,onStart:s,onUpdate:r,onComplete:c})=>{const m=Q(o),u=P(m,{namespace:t,workflowId:e,runId:n});return(await L(async l=>T(u,{token:l,request:fetch}),{onStart:s,onUpdate:r,onComplete:c})).history.events},Be=async({namespace:t,workflowId:e,runId:n,sort:o,settings:s,accessToken:r,onStart:c,onUpdate:m,onComplete:u})=>{const i=Q(o),l=P(i,{namespace:t,workflowId:e,runId:n}),d=await L(async a=>T(l,{token:a,request:fetch}),{onStart:c,onUpdate:m,onComplete:u});return await A({response:d.history.events,namespace:t,settings:s,accessToken:r})},K=async({namespace:t,workflowId:e,runId:n,sort:o})=>{const s=P(`events.${o}`,{namespace:t,workflowId:e,runId:n});try{return(await T(s,{request:fetch,params:{maximumPageSize:"20"}})).history.events}catch{return[]}},Ke=async t=>{const{settings:e,namespace:n,accessToken:o}=t,s=await K({...t,sort:"ascending"}),r=await K({...t,sort:"descending"}),[c,m]=await Promise.all([A({response:s,namespace:n,settings:e,accessToken:o}),A({response:r,namespace:n,settings:e,accessToken:o})]);return{start:c,end:m}};export{Ne as A,Be as a,Oe as b,ye as c,Ge as e,Ke as f,ke as i,Me as r,Je as t};
